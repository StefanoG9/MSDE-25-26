<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">

<title>Analisi Econometrica di Serie Storiche Macroeconomiche USA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="progetto_msde_files/libs/clipboard/clipboard.min.js"></script>
<script src="progetto_msde_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="progetto_msde_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="progetto_msde_files/libs/quarto-html/popper.min.js"></script>
<script src="progetto_msde_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="progetto_msde_files/libs/quarto-html/anchor.min.js"></script>
<link href="progetto_msde_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="progetto_msde_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="progetto_msde_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="progetto_msde_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="progetto_msde_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice</h2>
   
  <ul>
  <li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">1</span> Introduzione</a>
  <ul class="collapse">
  <li><a href="#obiettivo-del-progetto" id="toc-obiettivo-del-progetto" class="nav-link" data-scroll-target="#obiettivo-del-progetto"><span class="header-section-number">1.1</span> Obiettivo del progetto</a></li>
  <li><a href="#il-dataset" id="toc-il-dataset" class="nav-link" data-scroll-target="#il-dataset"><span class="header-section-number">1.2</span> Il dataset</a></li>
  <li><a href="#caricamento-librerie-e-dati" id="toc-caricamento-librerie-e-dati" class="nav-link" data-scroll-target="#caricamento-librerie-e-dati"><span class="header-section-number">1.3</span> Caricamento librerie e dati</a></li>
  </ul></li>
  <li><a href="#analisi-univariata-msde_01" id="toc-analisi-univariata-msde_01" class="nav-link" data-scroll-target="#analisi-univariata-msde_01"><span class="header-section-number">2</span> Analisi Univariata (MSDE_01)</a>
  <ul class="collapse">
  <li><a href="#fondamenti-teorici" id="toc-fondamenti-teorici" class="nav-link" data-scroll-target="#fondamenti-teorici"><span class="header-section-number">2.1</span> Fondamenti teorici</a>
  <ul class="collapse">
  <li><a href="#decomposizione-classica" id="toc-decomposizione-classica" class="nav-link" data-scroll-target="#decomposizione-classica"><span class="header-section-number">2.1.1</span> Decomposizione classica</a></li>
  <li><a href="#approccio-moderno-box-jenkins" id="toc-approccio-moderno-box-jenkins" class="nav-link" data-scroll-target="#approccio-moderno-box-jenkins"><span class="header-section-number">2.1.2</span> Approccio moderno: Box-Jenkins</a></li>
  </ul></li>
  <li><a href="#stazionarietà-e-acfpacf" id="toc-stazionarietà-e-acfpacf" class="nav-link" data-scroll-target="#stazionarietà-e-acfpacf"><span class="header-section-number">2.2</span> Stazionarietà e ACF/PACF</a></li>
  <li><a href="#identificazione-e-stima-del-modello-arima" id="toc-identificazione-e-stima-del-modello-arima" class="nav-link" data-scroll-target="#identificazione-e-stima-del-modello-arima"><span class="header-section-number">2.3</span> Identificazione e stima del modello ARIMA</a></li>
  <li><a href="#diagnostica-dei-residui" id="toc-diagnostica-dei-residui" class="nav-link" data-scroll-target="#diagnostica-dei-residui"><span class="header-section-number">2.4</span> Diagnostica dei residui</a></li>
  <li><a href="#previsione-univariata" id="toc-previsione-univariata" class="nav-link" data-scroll-target="#previsione-univariata"><span class="header-section-number">2.5</span> Previsione univariata</a></li>
  </ul></li>
  <li><a href="#analisi-bivariata-e-cross-correlazione-msde_02" id="toc-analisi-bivariata-e-cross-correlazione-msde_02" class="nav-link" data-scroll-target="#analisi-bivariata-e-cross-correlazione-msde_02"><span class="header-section-number">3</span> Analisi Bivariata e Cross-Correlazione (MSDE_02)</a>
  <ul class="collapse">
  <li><a href="#fondamenti-teorici-1" id="toc-fondamenti-teorici-1" class="nav-link" data-scroll-target="#fondamenti-teorici-1"><span class="header-section-number">3.1</span> Fondamenti teorici</a>
  <ul class="collapse">
  <li><a href="#funzione-di-cross-covarianza-e-cross-correlazione" id="toc-funzione-di-cross-covarianza-e-cross-correlazione" class="nav-link" data-scroll-target="#funzione-di-cross-covarianza-e-cross-correlazione"><span class="header-section-number">3.1.1</span> Funzione di cross-covarianza e cross-correlazione</a></li>
  <li><a href="#test-di-ljung-box-multivariato" id="toc-test-di-ljung-box-multivariato" class="nav-link" data-scroll-target="#test-di-ljung-box-multivariato"><span class="header-section-number">3.1.2</span> Test di Ljung-Box multivariato</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#transfer-function-model-msde_03" id="toc-transfer-function-model-msde_03" class="nav-link" data-scroll-target="#transfer-function-model-msde_03"><span class="header-section-number">4</span> Transfer Function Model (MSDE_03)</a>
  <ul class="collapse">
  <li><a href="#fondamenti-teorici-2" id="toc-fondamenti-teorici-2" class="nav-link" data-scroll-target="#fondamenti-teorici-2"><span class="header-section-number">4.1</span> Fondamenti teorici</a>
  <ul class="collapse">
  <li><a href="#la-relazione-tra-ccf-e-tfm" id="toc-la-relazione-tra-ccf-e-tfm" class="nav-link" data-scroll-target="#la-relazione-tra-ccf-e-tfm"><span class="header-section-number">4.1.1</span> La relazione tra CCF e TFM</a></li>
  <li><a href="#procedura-di-costruzione-del-tfm" id="toc-procedura-di-costruzione-del-tfm" class="nav-link" data-scroll-target="#procedura-di-costruzione-del-tfm"><span class="header-section-number">4.1.2</span> Procedura di costruzione del TFM</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#modelli-var-msde_04" id="toc-modelli-var-msde_04" class="nav-link" data-scroll-target="#modelli-var-msde_04"><span class="header-section-number">5</span> Modelli VAR (MSDE_04)</a>
  <ul class="collapse">
  <li><a href="#fondamenti-teorici-3" id="toc-fondamenti-teorici-3" class="nav-link" data-scroll-target="#fondamenti-teorici-3"><span class="header-section-number">5.1</span> Fondamenti teorici</a>
  <ul class="collapse">
  <li><a href="#stabilità-e-stazionarietà" id="toc-stabilità-e-stazionarietà" class="nav-link" data-scroll-target="#stabilità-e-stazionarietà"><span class="header-section-number">5.1.1</span> Stabilità e stazionarietà</a></li>
  <li><a href="#modelli-impliciti-per-le-componenti" id="toc-modelli-impliciti-per-le-componenti" class="nav-link" data-scroll-target="#modelli-impliciti-per-le-componenti"><span class="header-section-number">5.1.2</span> Modelli impliciti per le componenti</a></li>
  <li><a href="#selezione-dellordine" id="toc-selezione-dellordine" class="nav-link" data-scroll-target="#selezione-dellordine"><span class="header-section-number">5.1.3</span> Selezione dell’ordine</a></li>
  </ul></li>
  <li><a href="#stima-del-modello-var" id="toc-stima-del-modello-var" class="nav-link" data-scroll-target="#stima-del-modello-var"><span class="header-section-number">5.2</span> Stima del modello VAR</a></li>
  <li><a href="#diagnostica-del-var" id="toc-diagnostica-del-var" class="nav-link" data-scroll-target="#diagnostica-del-var"><span class="header-section-number">5.3</span> Diagnostica del VAR</a></li>
  <li><a href="#granger-causalità" id="toc-granger-causalità" class="nav-link" data-scroll-target="#granger-causalità"><span class="header-section-number">5.4</span> Granger-Causalità</a></li>
  <li><a href="#funzioni-di-risposta-allimpulso-irf" id="toc-funzioni-di-risposta-allimpulso-irf" class="nav-link" data-scroll-target="#funzioni-di-risposta-allimpulso-irf"><span class="header-section-number">5.5</span> Funzioni di Risposta all’Impulso (IRF)</a></li>
  <li><a href="#decomposizione-della-varianza-fevd" id="toc-decomposizione-della-varianza-fevd" class="nav-link" data-scroll-target="#decomposizione-della-varianza-fevd"><span class="header-section-number">5.6</span> Decomposizione della Varianza (FEVD)</a></li>
  <li><a href="#previsione-var" id="toc-previsione-var" class="nav-link" data-scroll-target="#previsione-var"><span class="header-section-number">5.7</span> Previsione VAR</a></li>
  </ul></li>
  <li><a href="#cointegrazione-msde_05" id="toc-cointegrazione-msde_05" class="nav-link" data-scroll-target="#cointegrazione-msde_05"><span class="header-section-number">6</span> Cointegrazione (MSDE_05)</a>
  <ul class="collapse">
  <li><a href="#fondamenti-teorici-4" id="toc-fondamenti-teorici-4" class="nav-link" data-scroll-target="#fondamenti-teorici-4"><span class="header-section-number">6.1</span> Fondamenti teorici</a>
  <ul class="collapse">
  <li><a href="#integrazione-e-test-di-radice-unitaria" id="toc-integrazione-e-test-di-radice-unitaria" class="nav-link" data-scroll-target="#integrazione-e-test-di-radice-unitaria"><span class="header-section-number">6.1.1</span> Integrazione e test di radice unitaria</a></li>
  <li><a href="#esempio-dettagliato-procedura-step-by-step-per-logcpi" id="toc-esempio-dettagliato-procedura-step-by-step-per-logcpi" class="nav-link" data-scroll-target="#esempio-dettagliato-procedura-step-by-step-per-logcpi"><span class="header-section-number">6.1.2</span> Esempio dettagliato: procedura step-by-step per log(CPI)</a></li>
  </ul></li>
  <li><a href="#cointegrazione" id="toc-cointegrazione" class="nav-link" data-scroll-target="#cointegrazione"><span class="header-section-number">6.2</span> Cointegrazione</a>
  <ul class="collapse">
  <li><a href="#concetto" id="toc-concetto" class="nav-link" data-scroll-target="#concetto"><span class="header-section-number">6.2.1</span> Concetto</a></li>
  <li><a href="#procedura-di-engle-granger" id="toc-procedura-di-engle-granger" class="nav-link" data-scroll-target="#procedura-di-engle-granger"><span class="header-section-number">6.2.2</span> Procedura di Engle-Granger</a></li>
  <li><a href="#procedura-di-johansen" id="toc-procedura-di-johansen" class="nav-link" data-scroll-target="#procedura-di-johansen"><span class="header-section-number">6.2.3</span> Procedura di Johansen</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#confronto-tra-modelli-e-selezione-finale" id="toc-confronto-tra-modelli-e-selezione-finale" class="nav-link" data-scroll-target="#confronto-tra-modelli-e-selezione-finale"><span class="header-section-number">7</span> Confronto tra Modelli e Selezione Finale</a>
  <ul class="collapse">
  <li><a href="#riepilogo-dei-modelli-stimati" id="toc-riepilogo-dei-modelli-stimati" class="nav-link" data-scroll-target="#riepilogo-dei-modelli-stimati"><span class="header-section-number">7.1</span> Riepilogo dei modelli stimati</a></li>
  <li><a href="#confronto-quantitativo" id="toc-confronto-quantitativo" class="nav-link" data-scroll-target="#confronto-quantitativo"><span class="header-section-number">7.2</span> Confronto quantitativo</a></li>
  <li><a href="#confronto-qualitativo-differenze-tra-i-modelli" id="toc-confronto-qualitativo-differenze-tra-i-modelli" class="nav-link" data-scroll-target="#confronto-qualitativo-differenze-tra-i-modelli"><span class="header-section-number">7.3</span> Confronto qualitativo: differenze tra i modelli</a></li>
  <li><a href="#discussione-e-selezione-del-modello-migliore" id="toc-discussione-e-selezione-del-modello-migliore" class="nav-link" data-scroll-target="#discussione-e-selezione-del-modello-migliore"><span class="header-section-number">7.4</span> Discussione e selezione del modello migliore</a></li>
  </ul></li>
  <li><a href="#appendice-pacchetti-r-utilizzati" id="toc-appendice-pacchetti-r-utilizzati" class="nav-link" data-scroll-target="#appendice-pacchetti-r-utilizzati"><span class="header-section-number">8</span> Appendice: Pacchetti R utilizzati</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Analisi Econometrica di Serie Storiche Macroeconomiche USA</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Codice</button></div></div>
<p class="subtitle lead">Modelli Statistici per Dati Economici — Progetto Finale</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Data di Pubblicazione</div>
    <div class="quarto-title-meta-contents">
      <p class="date">10 febbraio 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduzione" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduzione</h1>
<section id="obiettivo-del-progetto" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="obiettivo-del-progetto"><span class="header-section-number">1.1</span> Obiettivo del progetto</h2>
<p>Questo progetto applica le metodologie di analisi delle serie storiche studiate nel corso di Modelli Statistici per Dati Economici (MSDE) a un dataset di variabili macroeconomiche statunitensi provenienti dal database FRED (Federal Reserve Economic Data). L’analisi segue un percorso progressivo che parte dall’esplorazione univariata fino ad arrivare alla modellazione multivariata e alla cointegrazione, coprendo i seguenti ambiti:</p>
<ul>
<li><strong>Analisi univariata</strong>: decomposizione classica, identificazione e stima di modelli ARIMA secondo l’approccio Box-Jenkins, diagnostica dei residui e previsione.</li>
<li><strong>Analisi bivariata e cross-correlazione</strong>: studio delle relazioni dinamiche tra coppie di variabili tramite la funzione di cross-correlazione (CCF).</li>
<li><strong>Modelli Transfer Function (TFM)</strong>: identificazione di relazioni input-output tra variabili con prewhitening.</li>
<li><strong>Modelli VAR</strong>: stima di modelli vettoriali autoregressivi, selezione dell’ordine, test di Granger-causalità, funzioni di risposta all’impulso (IRF) e decomposizione della varianza dell’errore di previsione (FEVD).</li>
<li><strong>Cointegrazione</strong>: test di radice unitaria (ADF), procedura di Engle-Granger e procedura di Johansen per la stima del VECM.</li>
<li><strong>Confronto tra modelli</strong>: selezione del modello migliore sulla base di criteri informativi, accuratezza previsiva e coerenza economica.</li>
</ul>
</section>
<section id="il-dataset" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="il-dataset"><span class="header-section-number">1.2</span> Il dataset</h2>
<p>Il dataset contiene sei serie storiche mensili dal FRED, relative all’economia statunitense:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 38%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Variabile</th>
<th>Descrizione</th>
<th>Periodo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>produzione_industriale</code></td>
<td>Indice di produzione industriale</td>
<td>Gen 1950 – Ago 2025</td>
</tr>
<tr class="even">
<td><code>indice_prezzi_consumo</code></td>
<td>CPI — Indice dei prezzi al consumo</td>
<td>Gen 1950 – Ago 2025</td>
</tr>
<tr class="odd">
<td><code>disoccupazione</code></td>
<td>Tasso di disoccupazione (%)</td>
<td>Gen 1950 – Ago 2025</td>
</tr>
<tr class="even">
<td><code>tasso_fed_funds</code></td>
<td>Tasso dei Federal Funds (%)</td>
<td>Lug 1954 – Ago 2025</td>
</tr>
<tr class="odd">
<td><code>occupazione_non_agricola</code></td>
<td>Occupati non agricoli (migliaia)</td>
<td>Gen 1950 – Ago 2025</td>
</tr>
<tr class="even">
<td><code>consumi_personali</code></td>
<td>Consumi personali (miliardi di USD)</td>
<td>Gen 1959 – Ago 2025</td>
</tr>
</tbody>
</table>
</section>
<section id="caricamento-librerie-e-dati" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="caricamento-librerie-e-dati"><span class="header-section-number">1.3</span> Caricamento librerie e dati</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerie principali</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)      <span class="co"># Lettura file Excel</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)     <span class="co"># Test ADF, funzioni per serie storiche</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)    <span class="co"># Modelli ARIMA, auto.arima, diagnostica</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)        <span class="co"># Test di radice unitaria (ur.df), cointegrazione (ca.jo)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)        <span class="co"># Modelli VAR, Granger-causalità, IRF, FEVD</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)      <span class="co"># Test diagnostici (Breusch-Godfrey, ecc.)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)       <span class="co"># Modelli dinamici lineari</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)     <span class="co"># Grafici</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)   <span class="co"># Layout grafici multipli</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Caricamento del foglio "mensili"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dati <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"serie_macro_fred.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mensili"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rinominiamo le colonne per comodità</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dati) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data"</span>, <span class="st">"prod_ind"</span>, <span class="st">"cpi"</span>, <span class="st">"disoccupazione"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"fed_funds"</span>, <span class="st">"occupazione"</span>, <span class="st">"consumi"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizzazione struttura</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dati)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [908 × 7] (S3: tbl_df/tbl/data.frame)
 $ data          : POSIXct[1:908], format: "1950-01-01" "1950-02-01" ...
 $ prod_ind      : num [1:908] 14 14.1 14.5 15 15.3 ...
 $ cpi           : num [1:908] 23.5 23.5 23.6 23.6 23.7 23.8 24.1 24.3 24.4 24.6 ...
 $ disoccupazione: num [1:908] 6.5 6.4 6.3 5.8 5.5 5.4 5 4.5 4.4 4.2 ...
 $ fed_funds     : num [1:908] NA NA NA NA NA NA NA NA NA NA ...
 $ occupazione   : num [1:908] 43526 43297 43954 44382 44718 ...
 $ consumi       : num [1:908] NA NA NA NA NA NA NA NA NA NA ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dati)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      data                        prod_ind           cpi        
 Min.   :1950-01-01 00:00:00   Min.   : 14.00   Min.   : 23.50  
 1st Qu.:1968-11-23 12:00:00   1st Qu.: 37.27   1st Qu.: 35.48  
 Median :1987-10-16 12:00:00   Median : 59.85   Median :115.35  
 Mean   :1987-10-16 13:57:21   Mean   : 62.22   Mean   :127.16  
 3rd Qu.:2006-09-08 12:00:00   3rd Qu.: 93.07   3rd Qu.:202.60  
 Max.   :2025-08-01 00:00:00   Max.   :104.21   Max.   :323.98  
                                                                
 disoccupazione     fed_funds       occupazione        consumi       
 Min.   : 2.500   Min.   : 0.050   Min.   : 43297   Min.   :  306.1  
 1st Qu.: 4.400   1st Qu.: 1.887   1st Qu.: 69182   1st Qu.: 1050.9  
 Median : 5.500   Median : 4.330   Median :103255   Median : 4131.5  
 Mean   : 5.691   Mean   : 4.607   Mean   :100889   Mean   : 5944.0  
 3rd Qu.: 6.700   3rd Qu.: 6.138   3rd Qu.:132366   3rd Qu.: 9979.2  
 Max.   :14.800   Max.   :19.100   Max.   :159540   Max.   :20802.0  
                  NA's   :54                        NA's   :109      </code></pre>
</div>
</div>
<p>Per garantire la massima disponibilità di osservazioni comuni, restringiamo il campione al periodo in cui tutte le variabili sono disponibili: da gennaio 1959 in poi (data di inizio dei consumi personali). Per il Transfer Function Model, che richiede il tasso dei Fed Funds, il campione partirà da luglio 1954.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Campione completo: da gennaio 1959 (tutte le variabili disponibili)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dati_completo <span class="ot">&lt;-</span> dati[dati<span class="sc">$</span>data <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1959-01-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">!</span><span class="fu">is.na</span>(dati<span class="sc">$</span>consumi), ]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creazione delle serie storiche ts</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>prod_ind   <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>prod_ind, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>cpi        <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>cpi, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>disoc      <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>disoccupazione, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>fed_funds  <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>fed_funds, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>occupaz    <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>occupazione, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>consumi    <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>consumi, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Trasformazione logaritmica per le variabili con trend esponenziale</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>log_prod   <span class="ot">&lt;-</span> <span class="fu">log</span>(prod_ind)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>log_cpi    <span class="ot">&lt;-</span> <span class="fu">log</span>(cpi)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>log_consumi <span class="ot">&lt;-</span> <span class="fu">log</span>(consumi)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>log_occupaz <span class="ot">&lt;-</span> <span class="fu">log</span>(occupaz)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prod_ind, <span class="at">main =</span> <span class="st">"Produzione Industriale"</span>, <span class="at">ylab =</span> <span class="st">"Indice"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cpi, <span class="at">main =</span> <span class="st">"CPI — Indice Prezzi al Consumo"</span>, <span class="at">ylab =</span> <span class="st">"Indice"</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(disoc, <span class="at">main =</span> <span class="st">"Tasso di Disoccupazione"</span>, <span class="at">ylab =</span> <span class="st">"%"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fed_funds, <span class="at">main =</span> <span class="st">"Tasso Fed Funds"</span>, <span class="at">ylab =</span> <span class="st">"%"</span>, <span class="at">col =</span> <span class="st">"purple"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(occupaz, <span class="at">main =</span> <span class="st">"Occupazione Non Agricola"</span>, <span class="at">ylab =</span> <span class="st">"Migliaia"</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(consumi, <span class="at">main =</span> <span class="st">"Consumi Personali"</span>, <span class="at">ylab =</span> <span class="st">"Mld USD"</span>, <span class="at">col =</span> <span class="st">"brown"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/plot-overview-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Dall’ispezione visiva emergono chiaramente alcune caratteristiche: la produzione industriale, il CPI, l’occupazione e i consumi personali mostrano un trend crescente di lungo periodo, tipico delle serie I(1). Il tasso di disoccupazione presenta fluttuazioni cicliche attorno a un livello medio, mentre il tasso dei Fed Funds mostra un pattern altamente variabile legato alle decisioni di politica monetaria.</p>
</section>
</section>
<section id="analisi-univariata-msde_01" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Analisi Univariata (MSDE_01)</h1>
<section id="fondamenti-teorici" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="fondamenti-teorici"><span class="header-section-number">2.1</span> Fondamenti teorici</h2>
<p>Una serie storica è un insieme di osservazioni misurate sequenzialmente nel tempo. Lo scopo dell’analisi è duplice: comprendere il meccanismo stocastico che genera la serie e prevedere i valori futuri sulla base della storia passata. La caratteristica fondamentale è che le osservazioni non possono essere considerate indipendenti: la dipendenza temporale è la chiave dell’analisi.</p>
<section id="decomposizione-classica" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="decomposizione-classica"><span class="header-section-number">2.1.1</span> Decomposizione classica</h3>
<p>L’approccio classico decompone una serie in quattro componenti:</p>
<p><span class="math display">\[X_t = T_t + S_t + C_t + \varepsilon_t\]</span></p>
<p>dove <span class="math inline">\(T_t\)</span> è il trend (movimenti di lungo periodo nella media), <span class="math inline">\(S_t\)</span> sono gli effetti stagionali (fluttuazioni cicliche legate al calendario), <span class="math inline">\(C_t\)</span> è il ciclo (altre fluttuazioni cicliche come il ciclo economico) e <span class="math inline">\(\varepsilon_t\)</span> è la componente residuale, con <span class="math inline">\(\varepsilon_t \sim WN(0, \sigma^2)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decomposizione additiva della produzione industriale</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>decomp_prod <span class="ot">&lt;-</span> <span class="fu">decompose</span>(prod_ind, <span class="at">type =</span> <span class="st">"additive"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomp_prod, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Decomposizione Additiva — Produzione Industriale"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/decomposition-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decomposizione multiplicativa del CPI (più appropriata per serie con trend esponenziale)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>decomp_cpi <span class="ot">&lt;-</span> <span class="fu">decompose</span>(cpi, <span class="at">type =</span> <span class="st">"multiplicative"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomp_cpi, <span class="at">col =</span> <span class="st">"firebrick"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Decomposizione Multiplicativa — CPI"</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/decomposition-cpi-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>La decomposizione additiva è appropriata quando le fluttuazioni stagionali hanno ampiezza costante, mentre quella multiplicativa è preferibile quando l’ampiezza stagionale cresce proporzionalmente al livello della serie (come nel caso del CPI).</p>
</section>
<section id="approccio-moderno-box-jenkins" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="approccio-moderno-box-jenkins"><span class="header-section-number">2.1.2</span> Approccio moderno: Box-Jenkins</h3>
<p>L’approccio moderno (Box-Jenkins) mira a costruire un modello stocastico che rappresenti bene i dati, nel senso che la serie osservata possa essere vista come una realizzazione del processo stocastico. Le fasi dell’analisi sono tre: specificazione del modello (identification), stima dei parametri (estimation) e valutazione del modello (evaluation/diagnostic checking).</p>
</section>
</section>
<section id="stazionarietà-e-acfpacf" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="stazionarietà-e-acfpacf"><span class="header-section-number">2.2</span> Stazionarietà e ACF/PACF</h2>
<p>Un concetto fondamentale è quello di stazionarietà debole: un processo <span class="math inline">\(\{Y_t\}\)</span> è debolmente stazionario se la sua media <span class="math inline">\(E[Y_t] = \mu\)</span> è costante nel tempo, la varianza <span class="math inline">\(Var(Y_t) = \sigma^2\)</span> è finita e costante, e la funzione di autocovarianza <span class="math inline">\(\gamma(h) = Cov(Y_t, Y_{t+h})\)</span> dipende solo dal lag <span class="math inline">\(h\)</span> e non dal tempo <span class="math inline">\(t\)</span>.</p>
<p>La funzione di autocorrelazione (ACF) campionaria <span class="math inline">\(\hat{\rho}(k)\)</span> e la funzione di autocorrelazione parziale (PACF) campionaria <span class="math inline">\(\hat{P}(k)\)</span> sono gli strumenti principali per l’identificazione del modello. Per un processo white noise <span class="math inline">\(\varepsilon_t \sim WN(0, \sigma^2)\)</span>, le autocorrelazioni campionarie sono approssimativamente <span class="math inline">\(\hat{\rho}(k) \sim N(0, 1/n)\)</span>, il che consente di costruire le bande di confidenza <span class="math inline">\(\pm 1.96/\sqrt{n}\)</span>.</p>
<p>I pattern tipici sono: per un AR(p) la ACF decade esponenzialmente (o con oscillazioni smorzate) e la PACF si tronca al lag p; per un MA(q) la ACF si tronca al lag q e la PACF decade esponenzialmente; per un ARMA(p,q) entrambe decadono senza troncamento netto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF e PACF della produzione industriale in livelli</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(log_prod, <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"ACF — log(Produzione Industriale)"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(log_prod, <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"PACF — log(Produzione Industriale)"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF e PACF delle differenze prime</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(log_prod), <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"ACF — Δlog(Produzione Industriale)"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(log_prod), <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"PACF — Δlog(Produzione Industriale)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/acf-pacf-prod-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>La ACF della serie in livelli decade molto lentamente, segno tipico di non stazionarietà. Dopo la differenziazione, la ACF mostra un pattern compatibile con stazionarietà, con possibili componenti stagionali ai lag multipli di 12.</p>
</section>
<section id="identificazione-e-stima-del-modello-arima" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="identificazione-e-stima-del-modello-arima"><span class="header-section-number">2.3</span> Identificazione e stima del modello ARIMA</h2>
<p>Un modello ARIMA(p,d,q) è definito come:</p>
<p><span class="math display">\[\phi(B)(1-B)^d Y_t = \theta(B)\varepsilon_t\]</span></p>
<p>dove <span class="math inline">\(\phi(B) = 1 - \phi_1 B - \ldots - \phi_p B^p\)</span> è il polinomio autoregressivo, <span class="math inline">\(\theta(B) = 1 + \theta_1 B + \ldots + \theta_q B^q\)</span> è il polinomio a media mobile, <span class="math inline">\(d\)</span> è l’ordine di integrazione e <span class="math inline">\(\varepsilon_t \sim WN(0, \sigma^2)\)</span>.</p>
<p>Per dati mensili con stagionalità, si estende al modello SARIMA(p,d,q)(P,D,Q)[12]:</p>
<p><span class="math display">\[\phi(B)\Phi(B^{12})(1-B)^d(1-B^{12})^D Y_t = \theta(B)\Theta(B^{12})\varepsilon_t\]</span></p>
<p>Utilizziamo la funzione <code>auto.arima()</code> per la selezione automatica basata su criteri informativi (AIC, BIC), verificando poi il risultato con l’analisi manuale di ACF e PACF.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezione automatica del modello ARIMA per log(produzione industriale)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(log_prod, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">approximation =</span> <span class="cn">FALSE</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: log_prod 
ARIMA(0,1,1)(2,0,1)[12] with drift 

Coefficients:
         ma1    sar1     sar2     sma1   drift
      0.2950  0.4529  -0.1281  -0.4437  0.0015
s.e.  0.0375  0.1978   0.0399   0.1975  0.0004

sigma^2 = 8.613e-05:  log likelihood = 2174.04
AIC=-4336.07   AICc=-4335.95   BIC=-4309.06

Training set error measures:
                       ME        RMSE         MAE         MPE     MAPE
Training set 1.700008e-05 0.009238885 0.005442995 0.001235653 0.128452
                  MASE         ACF1
Training set 0.1383999 -0.003562318</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifica manuale: proviamo alcuni modelli alternativi</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_prod, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_prod, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_prod, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Confronto criteri informativi</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>modelli_arima <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modello =</span> <span class="fu">c</span>(<span class="st">"auto.arima"</span>, <span class="st">"ARIMA(1,1,1)(0,1,1)[12]"</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ARIMA(2,1,1)(0,1,1)[12]"</span>, <span class="st">"ARIMA(1,1,2)(1,1,1)[12]"</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(fit_auto), <span class="fu">AIC</span>(fit1), <span class="fu">AIC</span>(fit2), <span class="fu">AIC</span>(fit3)),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(fit_auto), <span class="fu">BIC</span>(fit1), <span class="fu">BIC</span>(fit2), <span class="fu">BIC</span>(fit3)),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">AICc =</span> <span class="fu">c</span>(fit_auto<span class="sc">$</span>aicc, fit1<span class="sc">$</span>aicc, fit2<span class="sc">$</span>aicc, fit3<span class="sc">$</span>aicc)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(modelli_arima, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Confronto criteri informativi — Modelli ARIMA"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Confronto criteri informativi — Modelli ARIMA</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Modello</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">auto.arima</td>
<td style="text-align: right;">-4336.07</td>
<td style="text-align: right;">-4309.06</td>
<td style="text-align: right;">-4335.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARIMA(1,1,1)(0,1,1)[12]</td>
<td style="text-align: right;">-4197.92</td>
<td style="text-align: right;">-4179.99</td>
<td style="text-align: right;">-4197.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ARIMA(2,1,1)(0,1,1)[12]</td>
<td style="text-align: right;">-4195.92</td>
<td style="text-align: right;">-4173.51</td>
<td style="text-align: right;">-4195.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARIMA(1,1,2)(1,1,1)[12]</td>
<td style="text-align: right;">-4194.22</td>
<td style="text-align: right;">-4167.32</td>
<td style="text-align: right;">-4194.09</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="diagnostica-dei-residui" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="diagnostica-dei-residui"><span class="header-section-number">2.4</span> Diagnostica dei residui</h2>
<p>La valutazione del modello si basa sull’analisi dei residui, che devono comportarsi come un white noise. I controlli fondamentali sono: assenza di autocorrelazione (verificata tramite ACF dei residui e test di Ljung-Box), normalità dei residui e assenza di eteroschedasticità.</p>
<p>Il test di Ljung-Box generalizzato verifica l’ipotesi nulla <span class="math inline">\(H_0: \rho(1) = \rho(2) = \ldots = \rho(p) = 0\)</span> contro l’alternativa che almeno una autocorrelazione sia diversa da zero. La statistica test è:</p>
<p><span class="math display">\[Q(p) = T(T+2) \sum_{l=1}^{p} \frac{\hat{\rho}^2(l)}{T-l} \xrightarrow{d} \chi^2(p - p_{par})\]</span></p>
<p>dove <span class="math inline">\(p_{par}\)</span> è il numero di parametri stimati nel modello.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezioniamo il modello migliore (quello con AIC minore)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>best_arima <span class="ot">&lt;-</span> fit_auto  <span class="co"># o il modello con AIC più basso dal confronto</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostica completa</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(best_arima)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/diagnostica-arima-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,1)(2,0,1)[12] with drift
Q* = 26.685, df = 20, p-value = 0.1443

Model df: 4.   Total lags used: 24</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di Ljung-Box a diversi lag</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test di Ljung-Box sui residui ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Test di Ljung-Box sui residui ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lag <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">36</span>)) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(<span class="fu">residuals</span>(best_arima), <span class="at">lag =</span> lag, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fitdf =</span> <span class="fu">length</span>(<span class="fu">coef</span>(best_arima)))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Lag %d: Q = %.3f, p-value = %.4f</span><span class="sc">\n</span><span class="st">"</span>, lag, test<span class="sc">$</span>statistic, test<span class="sc">$</span>p.value))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lag 12: Q = 21.184, p-value = 0.0035
Lag 24: Q = 26.685, p-value = 0.1122
Lag 36: Q = 33.204, p-value = 0.3602</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di Jarque-Bera per la normalità</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>jb_test <span class="ot">&lt;-</span> <span class="fu">jarque.bera.test</span>(<span class="fu">residuals</span>(best_arima))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Test Jarque-Bera: statistica = %.3f, p-value = %.4f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>            jb_test<span class="sc">$</span>statistic, jb_test<span class="sc">$</span>p.value))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Jarque-Bera: statistica = 103185.368, p-value = 0.0000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ-plot</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(best_arima), <span class="at">main =</span> <span class="st">"QQ-Plot dei residui ARIMA"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(best_arima), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/normalita-residui-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="previsione-univariata" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="previsione-univariata"><span class="header-section-number">2.5</span> Previsione univariata</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previsione a 12 mesi</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>prev_arima <span class="ot">&lt;-</span> <span class="fu">forecast</span>(best_arima, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prev_arima, <span class="at">main =</span> <span class="st">"Previsione ARIMA — log(Produzione Industriale)"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log(Indice)"</span>, <span class="at">xlab =</span> <span class="st">"Anno"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/forecast-arima-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>La previsione mostra gli intervalli di confidenza all’80% e al 95%. L’ampiezza crescente degli intervalli riflette l’incertezza che aumenta con l’orizzonte previsivo, una caratteristica fondamentale di tutti i modelli di serie storiche.</p>
</section>
</section>
<section id="analisi-bivariata-e-cross-correlazione-msde_02" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analisi Bivariata e Cross-Correlazione (MSDE_02)</h1>
<section id="fondamenti-teorici-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="fondamenti-teorici-1"><span class="header-section-number">3.1</span> Fondamenti teorici</h2>
<p>Quando si considerano più serie storiche congiuntamente, si ottiene una capacità interpretativa e previsiva superiore rispetto all’analisi univariata. Una serie storica multipla <span class="math inline">\(\mathbf{y}_t\)</span> è rappresentata da un vettore <span class="math inline">\(k\)</span>-dimensionale:</p>
<p><span class="math display">\[\mathbf{y}_t = [y_{1,t}, y_{2,t}, \ldots, y_{k,t}]'\]</span></p>
<p>I primi due momenti sono <span class="math inline">\(E[\mathbf{y}_t] = \boldsymbol{\mu}\)</span> (vettore <span class="math inline">\(k \times 1\)</span>) e <span class="math inline">\(V[\mathbf{y}_t] = \boldsymbol{\Sigma}\)</span> (matrice <span class="math inline">\(k \times k\)</span>).</p>
<section id="funzione-di-cross-covarianza-e-cross-correlazione" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="funzione-di-cross-covarianza-e-cross-correlazione"><span class="header-section-number">3.1.1</span> Funzione di cross-covarianza e cross-correlazione</h3>
<p>La funzione di cross-covarianza tra due componenti <span class="math inline">\(y_{i,t}\)</span> e <span class="math inline">\(y_{j,t}\)</span> al lag <span class="math inline">\(l\)</span> è:</p>
<p><span class="math display">\[\gamma_{ij}(l) = Cov(y_{i,t}, y_{j,t-l})\]</span></p>
<p>e la corrispondente cross-correlazione è:</p>
<p><span class="math display">\[\rho_{ij}(l) = \frac{\gamma_{ij}(l)}{\sqrt{\gamma_{ii}(0) \cdot \gamma_{jj}(0)}}\]</span></p>
<p>Un aspetto cruciale è che la funzione di cross-covarianza <strong>non è simmetrica</strong>: <span class="math inline">\(\gamma_{ij}(l) \neq \gamma_{ij}(-l)\)</span> in generale, ma vale <span class="math inline">\(\gamma_{ij}(l) = \gamma_{ji}(-l)\)</span>. Questo riflette il fatto che la relazione tra due variabili può essere diversa a seconda della direzione temporale.</p>
</section>
<section id="test-di-ljung-box-multivariato" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="test-di-ljung-box-multivariato"><span class="header-section-number">3.1.2</span> Test di Ljung-Box multivariato</h3>
<p>Per verificare se una serie multipla è priva di auto- e cross-correlazione si usa la generalizzazione multivariata del test di Ljung-Box:</p>
<p><span class="math display">\[Q_k(p) = T^2 \sum_{l=1}^{p} \frac{1}{T-l} \text{tr}\left[\hat{\Gamma}(l)'\hat{\Gamma}(0)^{-1}\hat{\Gamma}(l)\hat{\Gamma}(0)^{-1}\right] \xrightarrow{d} \chi^2(k^2 p)\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-correlazione tra coppie di variabili chiave</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lavoriamo sulle differenze prime per garantire stazionarietà</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>d_log_prod <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_prod)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>d_disoc    <span class="ot">&lt;-</span> <span class="fu">diff</span>(disoc)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>d_log_cpi  <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_cpi)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>d_fed      <span class="ot">&lt;-</span> <span class="fu">diff</span>(fed_funds)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># CCF tra variazione produzione industriale e variazione disoccupazione</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(d_log_prod, d_disoc, <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF: Δlog(Prod. Ind.) e Δ(Disoccupazione)"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># CCF tra variazione CPI e variazione Fed Funds</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(d_log_cpi, d_fed, <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF: Δlog(CPI) e Δ(Fed Funds)"</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># CCF tra variazione produzione e variazione CPI</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(d_log_prod, d_log_cpi, <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF: Δlog(Prod. Ind.) e Δlog(CPI)"</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/ccf-analysis-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Nell’output della funzione <code>ccf(x, y)</code>, i lag negativi indicano che <span class="math inline">\(x\)</span> anticipa <span class="math inline">\(y\)</span> (cioè i valori passati di <span class="math inline">\(x\)</span> sono correlati con il valore corrente di <span class="math inline">\(y\)</span>), mentre i lag positivi indicano che <span class="math inline">\(y\)</span> anticipa <span class="math inline">\(x\)</span>. Questo è cruciale per interpretare la direzione della relazione dinamica tra le variabili.</p>
</section>
</section>
</section>
<section id="transfer-function-model-msde_03" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Transfer Function Model (MSDE_03)</h1>
<section id="fondamenti-teorici-2" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="fondamenti-teorici-2"><span class="header-section-number">4.1</span> Fondamenti teorici</h2>
<p>Il modello Transfer Function (TFM) esprime la relazione tra una serie di output <span class="math inline">\(y_t\)</span> e una serie di input <span class="math inline">\(x_t\)</span> attraverso un filtro lineare:</p>
<p><span class="math display">\[y_t = \nu(B)x_t + \eta_t\]</span></p>
<p>dove <span class="math inline">\(\nu(B) = \sum_{j=0}^{\infty} \nu_j B^j\)</span> è la funzione di trasferimento, i coefficienti <span class="math inline">\(\nu_j\)</span> sono i pesi della risposta all’impulso (impulse response weights) e <span class="math inline">\(\eta_t\)</span> è la serie di disturbo (non necessariamente white noise), indipendente da <span class="math inline">\(x_t\)</span>. Il TFM è stabile se <span class="math inline">\(\sum |\nu_j| &lt; \infty\)</span> e causale se <span class="math inline">\(\nu_j = 0\)</span> per <span class="math inline">\(j &lt; 0\)</span>.</p>
<section id="la-relazione-tra-ccf-e-tfm" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="la-relazione-tra-ccf-e-tfm"><span class="header-section-number">4.1.1</span> La relazione tra CCF e TFM</h3>
<p>Se le serie sono stazionarie con media zero, la cross-covarianza è legata ai pesi della risposta all’impulso da:</p>
<p><span class="math display">\[\gamma_{yx}(k) = \nu_0 \gamma_x(k) + \nu_1 \gamma_x(k-1) + \nu_2 \gamma_x(k-2) + \ldots\]</span></p>
<p>Se la serie di input è white noise (<span class="math inline">\(\rho_x(k) = 0\)</span> per <span class="math inline">\(k \neq 0\)</span>), allora <span class="math inline">\(\nu_k = \frac{\sigma_y}{\sigma_x}\rho_{yx}(k)\)</span>, cioè la funzione di risposta all’impulso è direttamente proporzionale alla CCF. In caso contrario, la relazione è “contaminata” dall’autocorrelazione dell’input, rendendo necessaria la procedura di <strong>prewhitening</strong>.</p>
</section>
<section id="procedura-di-costruzione-del-tfm" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="procedura-di-costruzione-del-tfm"><span class="header-section-number">4.1.2</span> Procedura di costruzione del TFM</h3>
<ol type="1">
<li>Stimare un modello ARMA per la serie di input <span class="math inline">\(x_t\)</span>: <span class="math inline">\(\phi_x(B)x_t = \theta_x(B)\alpha_t\)</span></li>
<li>Filtrare la serie di output con lo stesso modello per ottenere <span class="math inline">\(\beta_t = \frac{\phi_x(B)}{\theta_x(B)}y_t\)</span></li>
<li>Calcolare la CCF campionaria tra <span class="math inline">\(\alpha_t\)</span> e <span class="math inline">\(\beta_t\)</span> per stimare i pesi della risposta all’impulso: <span class="math inline">\(\hat{\nu}_k = \frac{\hat{\sigma}_\beta}{\hat{\sigma}_\alpha}\hat{\rho}_{\beta\alpha}(k)\)</span></li>
<li>Identificare gli ordini <span class="math inline">\((r, s, b)\)</span> del modello razionale <span class="math inline">\(\nu(B) = \frac{\omega(B)}{\delta(B)}B^b\)</span></li>
<li>Stimare il modello completo e verificare la diagnostica</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transfer Function: Fed Funds (input) -&gt; Disoccupazione (output)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizziamo le differenze prime per la stazionarietà</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Allineiamo le serie (entrambe dal 1959 in poi)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>input_x  <span class="ot">&lt;-</span> d_fed       <span class="co"># Δ(Fed Funds) come input</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>output_y <span class="ot">&lt;-</span> d_disoc      <span class="co"># Δ(Disoccupazione) come output</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Modello ARMA per la serie di input (prewhitening)</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>fit_input <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(input_x, <span class="at">seasonal =</span> <span class="cn">FALSE</span>, <span class="at">max.p =</span> <span class="dv">5</span>, <span class="at">max.q =</span> <span class="dv">5</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Modello ARMA per l'input Δ(Fed Funds) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Modello ARMA per l'input Δ(Fed Funds) ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_input)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: input_x 
ARIMA(4,0,0) with zero mean 

Coefficients:
         ar1      ar2      ar3      ar4
      0.4711  -0.1695  -0.0100  -0.0720
s.e.  0.0387   0.0431   0.0432   0.0389

sigma^2 = 0.2209:  log likelihood = -440.3
AIC=890.6   AICc=890.69   BIC=913.1

Training set error measures:
                       ME      RMSE       MAE MPE MAPE     MASE         ACF1
Training set -0.005375293 0.4685854 0.2176437 NaN  Inf 0.616453 0.0005212256</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Ottenere i residui (serie prewhitened)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit_input)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrare l'output con lo stesso modello</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Usiamo la stessa struttura ARMA dell'input</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>beta_t <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="fu">Arima</span>(output_y, <span class="at">model =</span> fit_input))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: CCF tra le serie prewhitened</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(<span class="fu">as.numeric</span>(alpha_t), <span class="fu">as.numeric</span>(beta_t), <span class="at">lag.max =</span> <span class="dv">20</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF prewhitened: α(Fed Funds) e β(Disoccupazione)"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Per confronto: CCF senza prewhitening</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(<span class="fu">as.numeric</span>(input_x), <span class="fu">as.numeric</span>(output_y), <span class="at">lag.max =</span> <span class="dv">20</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF senza prewhitening: Δ(Fed Funds) e Δ(Disoccupazione)"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/tfm-whitened-ccf-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>La CCF dopo il prewhitening è più “pulita” e permette di identificare la struttura della funzione di trasferimento. Si noti che <span class="math inline">\(\hat{\rho}_{\beta\alpha}(k) \approx 0\)</span> per <span class="math inline">\(k &lt; 0\)</span> conferma la causalità del sistema (l’output non anticipa l’input).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4-5: Stima del Transfer Function Model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifichiamo il ritardo b e gli ordini (r,s) dalla CCF prewhitened</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Usiamo dynlm per una stima semplificata del modello</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Modello con lag dell'input</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>dati_tfm <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(output_y, input_x)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dati_tfm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"y"</span>, <span class="st">"x"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima con diversi lag</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>fit_tfm1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(y <span class="sc">~</span> <span class="fu">L</span>(x, <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">data =</span> dati_tfm)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_tfm1)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Time series regression with "ts" data:
Start = 1959(8), End = 2014(7)

Call:
dynlm(formula = y ~ L(x, 0:6), data = dati_tfm)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2222 -0.1013 -0.0003  0.1022 10.2832 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -0.002172   0.017934  -0.121    0.904  
L(x, 0:6)0  -0.088451   0.038520  -2.296    0.022 *
L(x, 0:6)1  -0.063352   0.042685  -1.484    0.138  
L(x, 0:6)2   0.027441   0.043222   0.635    0.526  
L(x, 0:6)3  -0.046625   0.043067  -1.083    0.279  
L(x, 0:6)4   0.004776   0.043050   0.111    0.912  
L(x, 0:6)5  -0.017143   0.042202  -0.406    0.685  
L(x, 0:6)6  -0.006653   0.038160  -0.174    0.862  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4606 on 652 degrees of freedom
Multiple R-squared:  0.02048,   Adjusted R-squared:  0.009962 
F-statistic: 1.947 on 7 and 652 DF,  p-value: 0.05996</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostica dei residui del TFM</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"Residui TFM"</span>, <span class="at">ylab =</span> <span class="st">"Residui"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"ACF Residui TFM"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"PACF Residui TFM"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"QQ-Plot Residui TFM"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/tfm-diagnostics-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Se i residui mostrano autocorrelazione, la componente di disturbo <span class="math inline">\(\eta_t\)</span> necessita di un modello ARMA, che va stimato congiuntamente con la funzione di trasferimento.</p>
</section>
</section>
</section>
<section id="modelli-var-msde_04" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Modelli VAR (MSDE_04)</h1>
<section id="fondamenti-teorici-3" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="fondamenti-teorici-3"><span class="header-section-number">5.1</span> Fondamenti teorici</h2>
<p>I modelli VAR (Vector AutoRegressive) rappresentano uno degli strumenti più utilizzati in econometria per l’analisi congiunta di più serie storiche. A differenza dei modelli a equazioni simultanee strutturali, nei modelli VAR non è necessario specificare quali variabili sono endogene e quali esogene: tutte le variabili sono trattate come endogene. Questo è un vantaggio importante, poiché la classificazione endogeno/esogeno richiede restrizioni identificative basate su teoria economica che spesso è vaga nelle sue indicazioni.</p>
<p>Un VAR(p) per un vettore <span class="math inline">\(k\)</span>-dimensionale <span class="math inline">\(\mathbf{y}_t\)</span> è definito come:</p>
<p><span class="math display">\[\mathbf{y}_t = \boldsymbol{\Phi}_0 + \boldsymbol{\Phi}_1 \mathbf{y}_{t-1} + \boldsymbol{\Phi}_2 \mathbf{y}_{t-2} + \ldots + \boldsymbol{\Phi}_p \mathbf{y}_{t-p} + \boldsymbol{\varepsilon}_t\]</span></p>
<p>dove <span class="math inline">\(\boldsymbol{\Phi}_0\)</span> è un vettore di intercette <span class="math inline">\((k \times 1)\)</span>, <span class="math inline">\(\boldsymbol{\Phi}_i\)</span> sono matrici di coefficienti <span class="math inline">\((k \times k)\)</span> e <span class="math inline">\(\boldsymbol{\varepsilon}_t\)</span> è un vettore di innovazioni con <span class="math inline">\(E[\boldsymbol{\varepsilon}_t] = \mathbf{0}\)</span> e <span class="math inline">\(E[\boldsymbol{\varepsilon}_t \boldsymbol{\varepsilon}_t'] = \boldsymbol{\Sigma}\)</span>.</p>
<section id="stabilità-e-stazionarietà" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="stabilità-e-stazionarietà"><span class="header-section-number">5.1.1</span> Stabilità e stazionarietà</h3>
<p>La condizione di stabilità (stazionarietà) di un VAR(p) è legata alle radici dell’equazione caratteristica. Per un VAR(1), le condizioni equivalenti sono: gli autovalori di <span class="math inline">\(\boldsymbol{\Phi}_1\)</span> hanno modulo minore di 1, oppure le radici di <span class="math inline">\(|\mathbf{I}_k - \boldsymbol{\Phi}_1 z| = 0\)</span> hanno modulo maggiore di 1.</p>
</section>
<section id="modelli-impliciti-per-le-componenti" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="modelli-impliciti-per-le-componenti"><span class="header-section-number">5.1.2</span> Modelli impliciti per le componenti</h3>
<p>Un risultato importante è che ogni componente <span class="math inline">\(y_{i,t}\)</span> di un VAR(p) con <span class="math inline">\(k\)</span> variabili segue individualmente un modello ARMA con ordini massimi <span class="math inline">\((k, k-1)\)</span>. Questo mostra come il VAR catturi interdipendenze dinamiche che un approccio univariato non può cogliere.</p>
</section>
<section id="selezione-dellordine" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="selezione-dellordine"><span class="header-section-number">5.1.3</span> Selezione dell’ordine</h3>
<p>Tre criteri informativi comunemente usati per un VAR(m) sono:</p>
<p><span class="math display">\[AIC(m) = \log|\hat{\boldsymbol{\Sigma}}_m| + \frac{2}{T}mk^2\]</span></p>
<p><span class="math display">\[BIC(m) = \log|\hat{\boldsymbol{\Sigma}}_m| + \frac{\log(T)}{T}mk^2\]</span></p>
<p><span class="math display">\[HQ(m) = \log|\hat{\boldsymbol{\Sigma}}_m| + \frac{2\log(\log(T))}{T}mk^2\]</span></p>
<p>dove <span class="math inline">\(\hat{\boldsymbol{\Sigma}}_m\)</span> è la stima ML della matrice di covarianza dei residui e <span class="math inline">\(mk^2\)</span> è il numero di parametri. Il criterio FPE (Final Prediction Error) di Akaike è:</p>
<p><span class="math display">\[FPE(m) = \left(\frac{T + km + 1}{T - km - 1}\right)^k \left|\frac{\boldsymbol{\varepsilon}_m'\boldsymbol{\varepsilon}_m}{T}\right|\]</span></p>
</section>
</section>
<section id="stima-del-modello-var" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="stima-del-modello-var"><span class="header-section-number">5.2</span> Stima del modello VAR</h2>
<p>Lavoriamo con tre variabili: produzione industriale, disoccupazione e CPI (in differenze logaritmiche dove appropriato per la stazionarietà).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparazione dati per il VAR</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizziamo le differenze per garantire stazionarietà</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>var_data <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(d_log_prod, d_disoc, d_log_cpi)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(var_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D_LogProd"</span>, <span class="st">"D_Disoc"</span>, <span class="st">"D_LogCPI"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimuovere eventuali NA</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>var_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(var_data)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Dimensioni del dataset VAR: %d osservazioni x %d variabili</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nrow</span>(var_data), <span class="fu">ncol</span>(var_data)))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dimensioni del dataset VAR: 666 osservazioni x 3 variabili</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezione dell'ordine del VAR</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>var_select <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(var_data, <span class="at">lag.max =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_select<span class="sc">$</span>selection)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC(n)  HQ(n)  SC(n) FPE(n) 
    12      2      1     12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Tabella completa dei criteri ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Tabella completa dei criteri ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(var_select<span class="sc">$</span>criteria[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="dv">4</span>))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              1        2        3        4        5        6        7        8
AIC(n) -23.1847 -23.2225 -23.2307 -23.2399 -23.2314 -23.2217 -23.2316 -23.2225
HQ(n)  -23.1528 -23.1666 -23.1509 -23.1362 -23.1038 -23.0701 -23.0562 -23.0231
SC(n)  -23.1025 -23.0785 -23.0250 -22.9725 -22.9024 -22.8309 -22.7792 -22.7084
FPE(n)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000
              9       10       11       12
AIC(n) -23.2235 -23.2801 -23.3298 -23.3451
HQ(n)  -23.0002 -23.0329 -23.0587 -23.0501
SC(n)  -22.6477 -22.6426 -22.6306 -22.5842
FPE(n)   0.0000   0.0000   0.0000   0.0000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima del VAR con l'ordine suggerito dal BIC (più parsimonioso)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>p_opt <span class="ot">&lt;-</span> var_select<span class="sc">$</span>selection[<span class="st">"SC(n)"</span>]  <span class="co"># BIC = SC (Schwarz Criterion)</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Ordine selezionato dal BIC: p = %d</span><span class="sc">\n</span><span class="st">"</span>, p_opt))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ordine selezionato dal BIC: p = 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit_var <span class="ot">&lt;-</span> <span class="fu">VAR</span>(var_data, <span class="at">p =</span> p_opt, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_var)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: D_LogProd, D_Disoc, D_LogCPI 
Deterministic variables: const 
Sample size: 665 
Log Likelihood: 4890.201 
Roots of the characteristic polynomial:
0.5965 0.2599 0.1651
Call:
VAR(y = var_data, p = p_opt, type = "const")


Estimation results for equation D_LogProd: 
========================================== 
D_LogProd = D_LogProd.l1 + D_Disoc.l1 + D_LogCPI.l1 + const 

              Estimate Std. Error t value Pr(&gt;|t|)    
D_LogProd.l1 0.3247068  0.0517473   6.275 6.33e-10 ***
D_Disoc.l1   0.0017842  0.0010926   1.633    0.103    
D_LogCPI.l1  0.0990758  0.0985421   1.005    0.315    
const        0.0007017  0.0004879   1.438    0.151    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.009379 on 661 degrees of freedom
Multiple R-Squared: 0.07742,    Adjusted R-squared: 0.07323 
F-statistic: 18.49 on 3 and 661 DF,  p-value: 1.58e-11 


Estimation results for equation D_Disoc: 
======================================== 
D_Disoc = D_LogProd.l1 + D_Disoc.l1 + D_LogCPI.l1 + const 

              Estimate Std. Error t value Pr(&gt;|t|)    
D_LogProd.l1 -17.95938    2.45258  -7.323 7.09e-13 ***
D_Disoc.l1    -0.22918    0.05178  -4.426 1.13e-05 ***
D_LogCPI.l1    0.15990    4.67044   0.034    0.973    
const          0.02685    0.02312   1.161    0.246    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.4445 on 661 degrees of freedom
Multiple R-Squared: 0.07607,    Adjusted R-squared: 0.07188 
F-statistic: 18.14 on 3 and 661 DF,  p-value: 2.538e-11 


Estimation results for equation D_LogCPI: 
========================================= 
D_LogCPI = D_LogProd.l1 + D_Disoc.l1 + D_LogCPI.l1 + const 

              Estimate Std. Error t value Pr(&gt;|t|)    
D_LogProd.l1 0.0084153  0.0164811   0.511    0.610    
D_Disoc.l1   0.0002980  0.0003480   0.856    0.392    
D_LogCPI.l1  0.5957800  0.0313849  18.983  &lt; 2e-16 ***
const        0.0012847  0.0001554   8.268 7.48e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.002987 on 661 degrees of freedom
Multiple R-Squared: 0.3541, Adjusted R-squared: 0.3511 
F-statistic: 120.8 on 3 and 661 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
           D_LogProd    D_Disoc   D_LogCPI
D_LogProd  8.796e-05 -0.0028102  1.666e-06
D_Disoc   -2.810e-03  0.1975895 -1.317e-04
D_LogCPI   1.666e-06 -0.0001317  8.923e-06

Correlation matrix of residuals:
          D_LogProd  D_Disoc D_LogCPI
D_LogProd   1.00000 -0.67407  0.05946
D_Disoc    -0.67407  1.00000 -0.09915
D_LogCPI    0.05946 -0.09915  1.00000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifica stabilità: le radici inverse devono essere all'interno del cerchio unitario</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>roots_var <span class="ot">&lt;-</span> <span class="fu">roots</span>(fit_var)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Radici inverse del polinomio caratteristico ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Radici inverse del polinomio caratteristico ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(roots_var)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5964564 0.2599448 0.1650895</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tutte le radici &lt; 1? %s</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">ifelse</span>(<span class="fu">all</span>(roots_var <span class="sc">&lt;</span> <span class="dv">1</span>), <span class="st">"SÌ — VAR stabile"</span>, <span class="st">"NO"</span>)))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Tutte le radici &lt; 1? SÌ — VAR stabile</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico delle radici</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_var, <span class="at">names =</span> <span class="fu">colnames</span>(var_data)[<span class="dv">1</span>])</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/var-stability-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="diagnostica-del-var" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="diagnostica-del-var"><span class="header-section-number">5.3</span> Diagnostica del VAR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test sui residui</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Portmanteau test (Ljung-Box multivariato)</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>serial_test <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(fit_var, <span class="at">lags.pt =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Portmanteau per autocorrelazione residua ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Test Portmanteau per autocorrelazione residua ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(serial_test)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object fit_var
Chi-squared = 294.58, df = 135, p-value = 6.672e-14</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$serial

    Portmanteau Test (asymptotic)

data:  Residuals of VAR object fit_var
Chi-squared = 294.58, df = 135, p-value = 6.672e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di normalità multivariata</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>norm_test <span class="ot">&lt;-</span> <span class="fu">normality.test</span>(fit_var, <span class="at">multivariate.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Test di normalità multivariata ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Test di normalità multivariata ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(norm_test)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$JB

    JB-Test (multivariate)

data:  Residuals of VAR object fit_var
Chi-squared = 614243, df = 6, p-value &lt; 2.2e-16


$Skewness

    Skewness only (multivariate)

data:  Residuals of VAR object fit_var
Chi-squared = 7591, df = 3, p-value &lt; 2.2e-16


$Kurtosis

    Kurtosis only (multivariate)

data:  Residuals of VAR object fit_var
Chi-squared = 606652, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$jb.mul
$jb.mul$JB

    JB-Test (multivariate)

data:  Residuals of VAR object fit_var
Chi-squared = 614243, df = 6, p-value &lt; 2.2e-16


$jb.mul$Skewness

    Skewness only (multivariate)

data:  Residuals of VAR object fit_var
Chi-squared = 7591, df = 3, p-value &lt; 2.2e-16


$jb.mul$Kurtosis

    Kurtosis only (multivariate)

data:  Residuals of VAR object fit_var
Chi-squared = 606652, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafici dei residui</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  res_i <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit_var)[, i]</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(res_i, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Residui —"</span>, <span class="fu">colnames</span>(var_data)[i]),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Residui"</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(res_i, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"ACF Residui —"</span>, <span class="fu">colnames</span>(var_data)[i]))</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/var-residual-plots-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="granger-causalità" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="granger-causalità"><span class="header-section-number">5.4</span> Granger-Causalità</h2>
<p>La Granger-causalità valuta se i valori passati di una variabile <span class="math inline">\(y_{1t}\)</span> aiutano a prevedere un’altra variabile <span class="math inline">\(y_{2t}\)</span>. Formalmente, <span class="math inline">\(y_{1t}\)</span> è Granger-causale per <span class="math inline">\(y_{2t}\)</span> se:</p>
<p><span class="math display">\[\boldsymbol{\Sigma}_t(h|\Omega_t) &lt; \boldsymbol{\Sigma}_t(h|\Omega_t \setminus \{y_{1s}: s \leq t\})\]</span></p>
<p>cioè se il MSE di previsione migliora includendo l’informazione di <span class="math inline">\(y_{1t}\)</span>. Il test si basa su un’ipotesi nulla di assenza di causalità (i coefficienti dei lag di <span class="math inline">\(y_{1t}\)</span> nell’equazione di <span class="math inline">\(y_{2t}\)</span> sono tutti zero) e si distribuisce come un <span class="math inline">\(F\)</span> sotto <span class="math inline">\(H_0\)</span>.</p>
<p>È importante sottolineare che il termine “causalità” è improprio: la Granger-causalità indica solo una correlazione tra il valore corrente di una variabile e i valori passati di un’altra, non una relazione causale in senso stretto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di Granger-causalità per tutte le coppie</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test di Granger-Causalità ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Test di Granger-Causalità ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>nomi_var <span class="ot">&lt;-</span> <span class="fu">colnames</span>(var_data)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  causa <span class="ot">&lt;-</span> <span class="fu">causality</span>(fit_var, <span class="at">cause =</span> nomi_var[i])</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"--- %s causa le altre variabili? ---</span><span class="sc">\n</span><span class="st">"</span>, nomi_var[i]))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"F-statistica = %.3f, p-value = %.4f</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>              causa<span class="sc">$</span>Granger<span class="sc">$</span>statistic, causa<span class="sc">$</span>Granger<span class="sc">$</span>p.value))</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- D_LogProd causa le altre variabili? ---
F-statistica = 26.834, p-value = 0.0000

--- D_Disoc causa le altre variabili? ---
F-statistica = 1.623, p-value = 0.1976

--- D_LogCPI causa le altre variabili? ---
F-statistica = 0.970, p-value = 0.3793</code></pre>
</div>
</div>
</section>
<section id="funzioni-di-risposta-allimpulso-irf" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="funzioni-di-risposta-allimpulso-irf"><span class="header-section-number">5.5</span> Funzioni di Risposta all’Impulso (IRF)</h2>
<p>Le impulse response functions tracciano la risposta delle variabili dipendenti nel VAR a shock unitari su ciascuna variabile. Per ottenerle, si esprime il VAR in forma VMA (Vector Moving Average). Per un VAR stabile, lo shock dovrebbe gradualmente esaurirsi.</p>
<p>Per risolvere il problema della correlazione contemporanea tra gli errori delle diverse equazioni, si utilizza la decomposizione di Cholesky, che impone un ordinamento ricorsivo delle variabili. Questo ordinamento implica che la prima variabile non è influenzata contemporaneamente dalle altre, la seconda può essere influenzata solo dalla prima, e così via.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IRF ortogonalizzate (Cholesky)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>irf_result <span class="ot">&lt;-</span> <span class="fu">irf</span>(fit_var, <span class="at">impulse =</span> nomi_var, <span class="at">response =</span> nomi_var,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n.ahead =</span> <span class="dv">24</span>, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">runs =</span> <span class="dv">500</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafici</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(irf_result)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/irf-analysis-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/irf-analysis-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/irf-analysis-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IRF selezionate: shock alla produzione -&gt; effetti su tutte le variabili</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>irf_prod <span class="ot">&lt;-</span> <span class="fu">irf</span>(fit_var, <span class="at">impulse =</span> <span class="st">"D_LogProd"</span>, <span class="at">response =</span> nomi_var,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n.ahead =</span> <span class="dv">24</span>, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">runs =</span> <span class="dv">500</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(irf_prod, <span class="at">main =</span> <span class="st">"IRF: Shock alla Produzione Industriale"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/irf-selected-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>L’ordinamento delle variabili nel VAR influenza i risultati delle IRF ortogonalizzate. Come suggerito dalla teoria, è opportuno verificare la sensibilità dei risultati invertendo l’ordinamento. Quando i residui sono poco correlati tra equazioni, l’ordinamento ha poca influenza.</p>
</section>
<section id="decomposizione-della-varianza-fevd" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="decomposizione-della-varianza-fevd"><span class="header-section-number">5.6</span> Decomposizione della Varianza (FEVD)</h2>
<p>La FEVD (Forecast Error Variance Decomposition) quantifica la proporzione della varianza dell’errore di previsione di ciascuna variabile attribuibile a shock provenienti da ciascuna delle variabili del sistema, a diversi orizzonti temporali.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FEVD</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>fevd_result <span class="ot">&lt;-</span> <span class="fu">fevd</span>(fit_var, <span class="at">n.ahead =</span> <span class="dv">24</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafici</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fevd_result)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/fevd-analysis-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabella FEVD a orizzonti selezionati</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== FEVD a 1, 6, 12, 24 mesi ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== FEVD a 1, 6, 12, 24 mesi ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var_name <span class="cf">in</span> nomi_var) {</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"--- Variabile: %s ---</span><span class="sc">\n</span><span class="st">"</span>, var_name))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  fevd_tab <span class="ot">&lt;-</span> fevd_result[[var_name]]</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(fevd_tab[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>), ], <span class="dv">4</span>))</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Variabile: D_LogProd ---
     D_LogProd D_Disoc D_LogCPI
[1,]    1.0000  0.0000   0.0000
[2,]    0.9944  0.0033   0.0022
[3,]    0.9944  0.0033   0.0023
[4,]    0.9944  0.0033   0.0023

--- Variabile: D_Disoc ---
     D_LogProd D_Disoc D_LogCPI
[1,]    0.4544  0.5456    0e+00
[2,]    0.4689  0.5309    2e-04
[3,]    0.4689  0.5309    2e-04
[4,]    0.4689  0.5309    2e-04

--- Variabile: D_LogCPI ---
     D_LogProd D_Disoc D_LogCPI
[1,]    0.0035  0.0064   0.9901
[2,]    0.0032  0.0045   0.9923
[3,]    0.0032  0.0045   0.9923
[4,]    0.0032  0.0045   0.9923</code></pre>
</div>
</div>
</section>
<section id="previsione-var" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="previsione-var"><span class="header-section-number">5.7</span> Previsione VAR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previsione a 12 mesi</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>prev_var <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_var, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prev_var)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/var-forecast-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cointegrazione-msde_05" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Cointegrazione (MSDE_05)</h1>
<section id="fondamenti-teorici-4" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="fondamenti-teorici-4"><span class="header-section-number">6.1</span> Fondamenti teorici</h2>
<section id="integrazione-e-test-di-radice-unitaria" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="integrazione-e-test-di-radice-unitaria"><span class="header-section-number">6.1.1</span> Integrazione e test di radice unitaria</h3>
<p>Una serie è integrata di ordine <span class="math inline">\(d\)</span>, indicata come <span class="math inline">\(I(d)\)</span>, se necessita di <span class="math inline">\(d\)</span> differenziazioni per diventare stazionaria. Per verificare la presenza di una radice unitaria si utilizza il test di Dickey-Fuller, basato sulla regressione:</p>
<p><span class="math display">\[\Delta y_t = \alpha + \gamma t + \delta y_{t-1} + \varepsilon_t\]</span></p>
<p>L’ipotesi nulla è <span class="math inline">\(H_0: \delta = 0\)</span> (presenza di radice unitaria). Se <span class="math inline">\(\delta = 0\)</span>, la serie è <span class="math inline">\(I(1)\)</span> con trend stocastico; se <span class="math inline">\(\delta &lt; 0\)</span>, la serie è stazionaria (eventualmente attorno a un trend). La statistica test segue una distribuzione non standard (distribuzione di Dickey-Fuller), con quantili spostati a sinistra rispetto alla normale.</p>
<p>Il test ADF (Augmented Dickey-Fuller) estende il DF a strutture più complesse:</p>
<p><span class="math display">\[\Delta y_t = \alpha + \gamma t + \delta y_{t-1} + \sum_{j=1}^{p} \beta_j \Delta y_{t-j} + \varepsilon_t\]</span></p>
<p>La scelta del numero di lag <span class="math inline">\(p\)</span> è cruciale: troppo pochi lag non rimuovono l’autocorrelazione nei residui (bias nel test), troppi lag consumano gradi di libertà e riducono la potenza. Si può usare la procedura iterativa di Ng e Perron o criteri informativi.</p>
<p>La procedura step-by-step prevede: (1) stimare il modello con intercetta e trend, testare <span class="math inline">\(\delta = 0\)</span>; se si rifiuta, la serie è stazionaria; se non si rifiuta, (2) verificare la significatività del trend con test congiunti (<span class="math inline">\(\phi_2\)</span>, <span class="math inline">\(\phi_3\)</span>); (3) se il trend non è significativo, riestimare senza trend e ripetere il test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test ADF per tutte le variabili in livelli e differenze</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=========================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=========================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  TEST DI RADICE UNITARIA (ADF)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  TEST DI RADICE UNITARIA (ADF)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=========================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=========================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>serie_test <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(Produzione Industriale)"</span> <span class="ot">=</span> log_prod,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(CPI)"</span> <span class="ot">=</span> log_cpi,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Disoccupazione"</span> <span class="ot">=</span> disoc,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Fed Funds"</span> <span class="ot">=</span> fed_funds,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(Occupazione)"</span> <span class="ot">=</span> log_occupaz,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(Consumi)"</span> <span class="ot">=</span> log_consumi</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>risultati_adf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Serie =</span> <span class="fu">character</span>(), </span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Livelli_tau =</span> <span class="fu">numeric</span>(), <span class="at">Livelli_pval =</span> <span class="fu">character</span>(),</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diff_tau =</span> <span class="fu">numeric</span>(), <span class="at">Diff_pval =</span> <span class="fu">character</span>(),</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ordine =</span> <span class="fu">character</span>(),</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (nome <span class="cf">in</span> <span class="fu">names</span>(serie_test)) {</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  serie <span class="ot">&lt;-</span> serie_test[[nome]]</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test in livelli (con trend e intercetta)</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>  adf_lev <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(serie, <span class="at">type =</span> <span class="st">"trend"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  tau_lev <span class="ot">&lt;-</span> adf_lev<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"tau3"</span>]</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>  cv_lev <span class="ot">&lt;-</span> adf_lev<span class="sc">@</span>cval[<span class="dv">1</span>, ]</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test in differenze (con intercetta)</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>  dserie <span class="ot">&lt;-</span> <span class="fu">diff</span>(serie)</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>  adf_diff <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(dserie, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>  tau_diff <span class="ot">&lt;-</span> adf_diff<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"tau2"</span>]</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  cv_diff <span class="ot">&lt;-</span> adf_diff<span class="sc">@</span>cval[<span class="dv">1</span>, ]</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determinare significatività</span></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>  sig_lev <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tau_lev <span class="sc">&lt;</span> cv_lev[<span class="st">"5pct"</span>], <span class="st">"&lt; 0.05"</span>, <span class="st">"&gt; 0.05"</span>)</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>  sig_diff <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tau_diff <span class="sc">&lt;</span> cv_diff[<span class="st">"5pct"</span>], <span class="st">"&lt; 0.05"</span>, <span class="st">"&gt; 0.05"</span>)</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>  ordine <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sig_lev <span class="sc">==</span> <span class="st">"&lt; 0.05"</span>, <span class="st">"I(0)"</span>,</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(sig_diff <span class="sc">==</span> <span class="st">"&lt; 0.05"</span>, <span class="st">"I(1)"</span>, <span class="st">"I(2)?"</span>))</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>  risultati_adf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(risultati_adf, <span class="fu">data.frame</span>(</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Serie =</span> nome,</span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">Livelli_tau =</span> <span class="fu">round</span>(tau_lev, <span class="dv">3</span>),</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Livelli_pval =</span> sig_lev,</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diff_tau =</span> <span class="fu">round</span>(tau_diff, <span class="dv">3</span>),</span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diff_pval =</span> sig_diff,</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ordine =</span> ordine,</span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"--- %s ---</span><span class="sc">\n</span><span class="st">"</span>, nome))</span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Livelli: tau3 = %.3f (CV 5%%: %.3f) -&gt; %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>              tau_lev, cv_lev[<span class="st">"5pct"</span>], sig_lev))</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Differenze: tau2 = %.3f (CV 5%%: %.3f) -&gt; %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>              tau_diff, cv_diff[<span class="st">"5pct"</span>], sig_diff))</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  -&gt; Serie %s</span><span class="sc">\n\n</span><span class="st">"</span>, ordine))</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- log(Produzione Industriale) ---
  Livelli: tau3 = -1.916 (CV 5%: -3.410) -&gt; &gt; 0.05
  Differenze: tau2 = -6.581 (CV 5%: -2.860) -&gt; &lt; 0.05
  -&gt; Serie I(1)

--- log(CPI) ---
  Livelli: tau3 = -2.664 (CV 5%: -3.410) -&gt; &gt; 0.05
  Differenze: tau2 = -2.998 (CV 5%: -2.860) -&gt; &lt; 0.05
  -&gt; Serie I(1)

--- Disoccupazione ---
  Livelli: tau3 = -3.538 (CV 5%: -3.410) -&gt; &lt; 0.05
  Differenze: tau2 = -14.275 (CV 5%: -2.860) -&gt; &lt; 0.05
  -&gt; Serie I(0)

--- Fed Funds ---
  Livelli: tau3 = -3.046 (CV 5%: -3.410) -&gt; &gt; 0.05
  Differenze: tau2 = -6.389 (CV 5%: -2.860) -&gt; &lt; 0.05
  -&gt; Serie I(1)

--- log(Occupazione) ---
  Livelli: tau3 = -1.933 (CV 5%: -3.410) -&gt; &gt; 0.05
  Differenze: tau2 = -19.573 (CV 5%: -2.860) -&gt; &lt; 0.05
  -&gt; Serie I(1)

--- log(Consumi) ---
  Livelli: tau3 = -2.626 (CV 5%: -3.410) -&gt; &gt; 0.05
  Differenze: tau2 = -5.634 (CV 5%: -2.860) -&gt; &lt; 0.05
  -&gt; Serie I(1)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(risultati_adf, </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Serie"</span>, <span class="st">"τ (livelli)"</span>, <span class="st">"p-value"</span>, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"τ (diff)"</span>, <span class="st">"p-value"</span>, <span class="st">"Ordine I(d)"</span>),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Risultati dei test ADF di radice unitaria"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Risultati dei test ADF di radice unitaria</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 33%">
<col style="width: 14%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Serie</th>
<th style="text-align: right;">τ (livelli)</th>
<th style="text-align: left;">p-value</th>
<th style="text-align: right;">τ (diff)</th>
<th style="text-align: left;">p-value</th>
<th style="text-align: left;">Ordine I(d)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5pct</td>
<td style="text-align: left;">log(Produzione Industriale)</td>
<td style="text-align: right;">-1.916</td>
<td style="text-align: left;">&gt; 0.05</td>
<td style="text-align: right;">-6.581</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: left;">I(1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">5pct1</td>
<td style="text-align: left;">log(CPI)</td>
<td style="text-align: right;">-2.664</td>
<td style="text-align: left;">&gt; 0.05</td>
<td style="text-align: right;">-2.998</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: left;">I(1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5pct2</td>
<td style="text-align: left;">Disoccupazione</td>
<td style="text-align: right;">-3.538</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: right;">-14.275</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: left;">I(0)</td>
</tr>
<tr class="even">
<td style="text-align: left;">5pct3</td>
<td style="text-align: left;">Fed Funds</td>
<td style="text-align: right;">-3.046</td>
<td style="text-align: left;">&gt; 0.05</td>
<td style="text-align: right;">-6.389</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: left;">I(1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5pct4</td>
<td style="text-align: left;">log(Occupazione)</td>
<td style="text-align: right;">-1.933</td>
<td style="text-align: left;">&gt; 0.05</td>
<td style="text-align: right;">-19.573</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: left;">I(1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">5pct5</td>
<td style="text-align: left;">log(Consumi)</td>
<td style="text-align: right;">-2.626</td>
<td style="text-align: left;">&gt; 0.05</td>
<td style="text-align: right;">-5.634</td>
<td style="text-align: left;">&lt; 0.05</td>
<td style="text-align: left;">I(1)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="esempio-dettagliato-procedura-step-by-step-per-logcpi" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="esempio-dettagliato-procedura-step-by-step-per-logcpi"><span class="header-section-number">6.1.2</span> Esempio dettagliato: procedura step-by-step per log(CPI)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Procedura completa per log(CPI) come nell'esempio del corso</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Procedura ADF step-by-step per log(CPI) ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Procedura ADF step-by-step per log(CPI) ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Modello con trend e intercetta</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>adf_step1 <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(log_cpi, <span class="at">type =</span> <span class="st">"trend"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Step 1: Modello con trend e intercetta</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Step 1: Modello con trend e intercetta</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adf_step1)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
############################################### 
# Augmented Dickey-Fuller Test Unit Root Test # 
############################################### 

Test regression trend 


Call:
lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0158949 -0.0015446 -0.0000941  0.0016003  0.0145767 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   9.334e-03  3.127e-03   2.985  0.00295 ** 
z.lag.1      -2.020e-03  7.584e-04  -2.664  0.00791 ** 
tt            4.189e-06  2.181e-06   1.921  0.05519 .  
z.diff.lag1   4.866e-01  3.911e-02  12.442  &lt; 2e-16 ***
z.diff.lag2  -5.804e-02  4.322e-02  -1.343  0.17974    
z.diff.lag3  -3.174e-02  4.320e-02  -0.735  0.46271    
z.diff.lag4   6.274e-02  4.323e-02   1.451  0.14716    
z.diff.lag5   5.281e-03  4.323e-02   0.122  0.90281    
z.diff.lag6  -8.115e-02  4.277e-02  -1.898  0.05820 .  
z.diff.lag7   1.312e-01  4.284e-02   3.062  0.00229 ** 
z.diff.lag8  -5.798e-02  4.316e-02  -1.343  0.17959    
z.diff.lag9   4.300e-03  4.307e-02   0.100  0.92052    
z.diff.lag10  6.124e-02  4.299e-02   1.424  0.15480    
z.diff.lag11  1.396e-01  4.301e-02   3.246  0.00123 ** 
z.diff.lag12  1.104e-01  3.892e-02   2.836  0.00471 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.002783 on 639 degrees of freedom
Multiple R-squared:  0.4537,    Adjusted R-squared:  0.4418 
F-statistic: 37.91 on 14 and 639 DF,  p-value: &lt; 2.2e-16


Value of test-statistic is: -2.6642 5.2982 5.3873 

Critical values for test statistics: 
      1pct  5pct 10pct
tau3 -3.96 -3.41 -3.12
phi2  6.09  4.68  4.03
phi3  8.27  6.25  5.34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Verificare se servono drift e trend (phi2, phi3)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Step 2: Test congiunti</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Step 2: Test congiunti</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"tau3 = %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_step1<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"tau3"</span>]))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tau3 = -2.664</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"phi2 (H0: delta=alpha=gamma=0) = %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_step1<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"phi2"</span>]))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phi2 (H0: delta=alpha=gamma=0) = 5.298</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"phi3 (H0: delta=gamma=0) = %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_step1<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"phi3"</span>]))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phi3 (H0: delta=gamma=0) = 5.387</code></pre>
</div>
</div>
</section>
</section>
<section id="cointegrazione" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="cointegrazione"><span class="header-section-number">6.2</span> Cointegrazione</h2>
<section id="concetto" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="concetto"><span class="header-section-number">6.2.1</span> Concetto</h3>
<p>Un insieme di variabili <span class="math inline">\(I(1)\)</span> è cointegrato se esiste una combinazione lineare <span class="math inline">\(\boldsymbol{\beta}'\mathbf{y}_t\)</span> che è <span class="math inline">\(I(0)\)</span>. Il vettore <span class="math inline">\(\boldsymbol{\beta}\)</span> è detto vettore di cointegrazione e rappresenta una relazione di equilibrio di lungo periodo. Deviazioni dall’equilibrio sono temporanee: le forze di mercato riportano il sistema verso l’equilibrio.</p>
</section>
<section id="procedura-di-engle-granger" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="procedura-di-engle-granger"><span class="header-section-number">6.2.2</span> Procedura di Engle-Granger</h3>
<p>La procedura si articola in tre passi:</p>
<ol type="1">
<li>Verificare che tutte le variabili siano <span class="math inline">\(I(1)\)</span> (condizione necessaria per la cointegrazione)</li>
<li>Stimare la relazione di cointegrazione con OLS: <span class="math inline">\(y_{1,t} = \beta_2 y_{2,t} + \ldots + \beta_k y_{k,t} + \varepsilon_t\)</span></li>
<li>Testare la stazionarietà dei residui <span class="math inline">\(\hat{\varepsilon}_t\)</span> con un test ADF, usando valori critici specifici (Engle-Yoo / MacKinnon) che tengono conto del fatto che <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> è stimato</li>
</ol>
<p>Se i residui sono <span class="math inline">\(I(0)\)</span>, le variabili sono cointegrate. I valori critici sono più stringenti rispetto al test ADF standard, perché per costruzione l’OLS minimizza la varianza dei residui, rendendoli “più stazionari” anche in assenza di vera cointegrazione.</p>
<p>Sotto cointegrazione, si stima poi il modello a correzione dell’errore (ECM):</p>
<p><span class="math display">\[\Delta y_t = \beta_0 \Delta x_t + \tilde{\alpha}(\hat{\varepsilon}_{t-1}) + \eta_t\]</span></p>
<p>dove <span class="math inline">\(\tilde{\alpha}\)</span> è la velocità di aggiustamento verso l’equilibrio (deve essere negativo per avere convergenza).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Procedura di Engle-Granger</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezioniamo le variabili I(1): log(Prod), log(CPI), log(Occupazione), log(Consumi)</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Regressione di cointegrazione (OLS)</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log(Consumi) = f(log(Produzione), log(CPI))</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>coint_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_consumi <span class="sc">~</span> log_prod <span class="sc">+</span> log_cpi)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(coint_reg)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_consumi ~ log_prod + log_cpi)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.12743 -0.04731 -0.02212  0.06147  0.15706 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.93507    0.05374  -17.40   &lt;2e-16 ***
log_prod     0.74402    0.03047   24.42   &lt;2e-16 ***
log_cpi      1.26042    0.01731   72.81   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0721 on 664 degrees of freedom
Multiple R-squared:  0.9945,    Adjusted R-squared:  0.9944 
F-statistic: 5.967e+04 on 2 and 664 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Estrarre i residui e testarli per radice unitaria</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>residui_coint <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(coint_reg), <span class="at">start =</span> <span class="fu">start</span>(log_consumi), </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residui_coint, <span class="at">main =</span> <span class="st">"Residui di cointegrazione"</span>, <span class="at">ylab =</span> <span class="st">"Residui"</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(residui_coint, <span class="at">main =</span> <span class="st">"ACF residui di cointegrazione"</span>)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(residui_coint, <span class="at">main =</span> <span class="st">"PACF residui di cointegrazione"</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test ADF sui residui (valori critici Engle-Granger)</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>adf_coint <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(residui_coint, <span class="at">type =</span> <span class="st">"none"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Test ADF sui residui di cointegrazione ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Test ADF sui residui di cointegrazione ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adf_coint)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
############################################### 
# Augmented Dickey-Fuller Test Unit Root Test # 
############################################### 

Test regression none 


Call:
lm(formula = z.diff ~ z.lag.1 - 1 + z.diff.lag)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.037221 -0.004127 -0.000368  0.004048  0.069208 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
z.lag.1    -0.005253   0.004178  -1.257   0.2091  
z.diff.lag  0.095174   0.039000   2.440   0.0149 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007589 on 652 degrees of freedom
Multiple R-squared:  0.01088,   Adjusted R-squared:  0.007842 
F-statistic: 3.585 on 2 and 652 DF,  p-value: 0.0283


Value of test-statistic is: -1.2574 

Critical values for test statistics: 
      1pct  5pct 10pct
tau1 -2.58 -1.95 -1.62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Nota: I valori critici per il test di Engle-Granger con 3 variabili I(1)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Nota: I valori critici per il test di Engle-Granger con 3 variabili I(1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">sono più stringenti dei DF standard:"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
sono più stringenti dei DF standard:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">1%: -3.96, 5%: -3.41, 10%: -3.13 (con intercetta)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1%: -3.96, 5%: -3.41, 10%: -3.13 (con intercetta)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Statistica tau: %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_coint<span class="sc">@</span>teststat[<span class="dv">1</span>]))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Statistica tau: -1.257</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/engle-granger-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Stima del modello ECM (Error Correction Model)</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Se c'è cointegrazione, stimiamo l'ECM</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>d_log_consumi <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_consumi)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>d_log_prod_c  <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_prod)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>d_log_cpi_c   <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_cpi)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>ect <span class="ot">&lt;-</span> residui_coint[<span class="sc">-</span><span class="fu">length</span>(residui_coint)]  <span class="co"># ECT ritardato di 1</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Allineare le lunghezze</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">length</span>(d_log_consumi), <span class="fu">length</span>(d_log_prod_c), </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">length</span>(d_log_cpi_c), <span class="fu">length</span>(ect))</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>dati_ecm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dy =</span> <span class="fu">tail</span>(d_log_consumi, n),</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">dx1 =</span> <span class="fu">tail</span>(d_log_prod_c, n),</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">dx2 =</span> <span class="fu">tail</span>(d_log_cpi_c, n),</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ect_lag =</span> <span class="fu">tail</span>(ect, n)</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>fit_ecm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dy <span class="sc">~</span> dx1 <span class="sc">+</span> dx2 <span class="sc">+</span> ect_lag, <span class="at">data =</span> dati_ecm)</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Modello a Correzione dell'Errore (ECM) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Modello a Correzione dell'Errore (ECM) ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_ecm)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dy ~ dx1 + dx2 + ect_lag, data = dati_ecm)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.051511 -0.003214 -0.000360  0.002825  0.068510 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.0029950  0.0003420   8.756  &lt; 2e-16 ***
dx1          0.5378646  0.0265407  20.266  &lt; 2e-16 ***
dx2          0.4487751  0.0698152   6.428 2.47e-10 ***
ect_lag     -0.0003486  0.0035926  -0.097    0.923    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.006639 on 662 degrees of freedom
Multiple R-squared:  0.4184,    Adjusted R-squared:  0.4158 
F-statistic: 158.8 on 3 and 662 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coeff. ECT (velocità di aggiustamento): %.4f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">coef</span>(fit_ecm)[<span class="st">"ect_lag"</span>]))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coeff. ECT (velocità di aggiustamento): -0.0003</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Un valore negativo e significativo indica convergenza verso l'equilibrio.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Un valore negativo e significativo indica convergenza verso l'equilibrio.</code></pre>
</div>
</div>
</section>
<section id="procedura-di-johansen" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="procedura-di-johansen"><span class="header-section-number">6.2.3</span> Procedura di Johansen</h3>
<p>La procedura di Johansen è più generale della Engle-Granger: permette di testare il rango di cointegrazione <span class="math inline">\(r\)</span> e stimare molteplici relazioni di cointegrazione in un contesto VECM (Vector Error Correction Model):</p>
<p><span class="math display">\[\Delta \mathbf{y}_t = \boldsymbol{\Pi} \mathbf{y}_{t-1} + \sum_{i=1}^{k-1} \boldsymbol{\Gamma}_i \Delta \mathbf{y}_{t-i} + \mathbf{u}_t\]</span></p>
<p>dove <span class="math inline">\(\boldsymbol{\Pi} = \boldsymbol{\alpha}\boldsymbol{\beta}'\)</span>, con <span class="math inline">\(\boldsymbol{\beta}\)</span> matrice dei vettori di cointegrazione e <span class="math inline">\(\boldsymbol{\alpha}\)</span> matrice dei coefficienti di aggiustamento (loading).</p>
<p>Il test si basa sull’esame del rango della matrice <span class="math inline">\(\boldsymbol{\Pi}\)</span> attraverso i suoi autovalori <span class="math inline">\(\hat{\lambda}_1 \geq \hat{\lambda}_2 \geq \ldots \geq \hat{\lambda}_g\)</span>. Le due statistiche test sono:</p>
<p><span class="math display">\[\lambda_{trace}(r) = -T \sum_{i=r+1}^{g} \ln(1 - \hat{\lambda}_i)\]</span></p>
<p><span class="math display">\[\lambda_{max}(r, r+1) = -T \ln(1 - \hat{\lambda}_{r+1})\]</span></p>
<p>Se <span class="math inline">\(\boldsymbol{\Pi}\)</span> ha rango zero, non c’è cointegrazione. Se ha rango pieno <span class="math inline">\(g\)</span>, le variabili sono stazionarie. Se ha rango <span class="math inline">\(r\)</span> con <span class="math inline">\(0 &lt; r &lt; g\)</span>, esistono <span class="math inline">\(r\)</span> relazioni di cointegrazione.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparazione dati per Johansen</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Usiamo le variabili in livelli (log)</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>johansen_data <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(log_consumi, log_prod, log_cpi)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(johansen_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"log_Consumi"</span>, <span class="st">"log_Prod"</span>, <span class="st">"log_CPI"</span>)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>johansen_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(johansen_data)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezione del lag ottimale per il VECM</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Il VECM con k lag corrisponde a un VAR con k+1 lag</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>var_select_j <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(johansen_data, <span class="at">lag.max =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Selezione ordine per il VECM ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Selezione ordine per il VECM ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_select_j<span class="sc">$</span>selection)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC(n)  HQ(n)  SC(n) FPE(n) 
    12      3      2     12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>k_vecm <span class="ot">&lt;-</span> var_select_j<span class="sc">$</span>selection[<span class="st">"SC(n)"</span>]  <span class="co"># BIC</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test trace di Johansen</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Trace di Johansen ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Test Trace di Johansen ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>jo_trace <span class="ot">&lt;-</span> <span class="fu">ca.jo</span>(johansen_data, <span class="at">type =</span> <span class="st">"trace"</span>, <span class="at">ecdet =</span> <span class="st">"const"</span>, <span class="at">K =</span> k_vecm)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jo_trace)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
###################### 
# Johansen-Procedure # 
###################### 

Test type: trace statistic , without linear trend and constant in cointegration 

Eigenvalues (lambda):
[1]  2.188697e-01  9.929081e-03  3.857047e-03 -1.107990e-16

Values of teststatistic and critical values of test:

           test 10pct  5pct  1pct
r &lt;= 2 |   2.57  7.52  9.24 12.97
r &lt;= 1 |   9.21 17.85 19.96 24.60
r = 0  | 173.47 32.00 34.91 41.07

Eigenvectors, normalised to first column:
(These are the cointegration relations)

               log_Consumi.l2 log_Prod.l2  log_CPI.l2   constant
log_Consumi.l2       1.000000   1.0000000  1.00000000  1.0000000
log_Prod.l2         -1.291446   0.1723343 -3.18823868 -0.7011990
log_CPI.l2          -1.873110  -1.9884504 -0.09285321 -1.2130840
constant             7.956966   0.5870580  5.57670313  0.5266998

Weights W:
(This is the loading matrix)

              log_Consumi.l2   log_Prod.l2   log_CPI.l2      constant
log_Consumi.d   2.636798e-03 -0.0016568365 1.326130e-03 -2.135511e-15
log_Prod.d      2.140456e-05 -0.0001129765 2.217716e-03 -5.520917e-15
log_CPI.d       8.129246e-04  0.0013135495 2.493228e-05  2.114103e-15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test max eigenvalue di Johansen</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Max Eigenvalue di Johansen ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Test Max Eigenvalue di Johansen ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>jo_eigen <span class="ot">&lt;-</span> <span class="fu">ca.jo</span>(johansen_data, <span class="at">type =</span> <span class="st">"eigen"</span>, <span class="at">ecdet =</span> <span class="st">"const"</span>, <span class="at">K =</span> k_vecm)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jo_eigen)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
###################### 
# Johansen-Procedure # 
###################### 

Test type: maximal eigenvalue statistic (lambda max) , without linear trend and constant in cointegration 

Eigenvalues (lambda):
[1]  2.188697e-01  9.929081e-03  3.857047e-03 -1.107990e-16

Values of teststatistic and critical values of test:

           test 10pct  5pct  1pct
r &lt;= 2 |   2.57  7.52  9.24 12.97
r &lt;= 1 |   6.64 13.75 15.67 20.20
r = 0  | 164.26 19.77 22.00 26.81

Eigenvectors, normalised to first column:
(These are the cointegration relations)

               log_Consumi.l2 log_Prod.l2  log_CPI.l2   constant
log_Consumi.l2       1.000000   1.0000000  1.00000000  1.0000000
log_Prod.l2         -1.291446   0.1723343 -3.18823868 -0.7011990
log_CPI.l2          -1.873110  -1.9884504 -0.09285321 -1.2130840
constant             7.956966   0.5870580  5.57670313  0.5266998

Weights W:
(This is the loading matrix)

              log_Consumi.l2   log_Prod.l2   log_CPI.l2      constant
log_Consumi.d   2.636798e-03 -0.0016568365 1.326130e-03 -2.135511e-15
log_Prod.d      2.140456e-05 -0.0001129765 2.217716e-03 -5.520917e-15
log_CPI.d       8.129246e-04  0.0013135495 2.493228e-05  2.114103e-15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima del VECM con il rango di cointegrazione identificato</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Supponiamo r = 1 (da verificare con i risultati dei test sopra)</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Se i test indicano r diverso, modificare di conseguenza</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Stima del VECM ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Stima del VECM ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determiniamo il rango dai risultati del test</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (il rango è il numero di ipotesi H0 rifiutate in sequenza)</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>vecm <span class="ot">&lt;-</span> <span class="fu">cajorls</span>(jo_trace, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Vettore di cointegrazione (beta normalizzato) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Vettore di cointegrazione (beta normalizzato) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vecm<span class="sc">$</span>beta)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    ect1
log_Consumi.l2  1.000000
log_Prod.l2    -1.291446
log_CPI.l2     -1.873110
constant        7.956966</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Coefficienti di aggiustamento (alpha) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Coefficienti di aggiustamento (alpha) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vecm<span class="sc">$</span>rlm<span class="sc">$</span>coefficients[<span class="dv">1</span>, ])</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>log_Consumi.d    log_Prod.d     log_CPI.d 
 2.636798e-03  2.140456e-05  8.129246e-04 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversione VECM -&gt; VAR per previsioni e diagnostica</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>vecm_var <span class="ot">&lt;-</span> <span class="fu">vec2var</span>(jo_trace, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostica</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>serial_vecm <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(vecm_var, <span class="at">lags.pt =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Portmanteau su residui VECM ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Test Portmanteau su residui VECM ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(serial_vecm)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object vecm_var
Chi-squared = 296.16, df = 129, p-value = 3.553e-15</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$serial

    Portmanteau Test (asymptotic)

data:  Residuals of VAR object vecm_var
Chi-squared = 296.16, df = 129, p-value = 3.553e-15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previsione dal VECM</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>prev_vecm <span class="ot">&lt;-</span> <span class="fu">predict</span>(vecm_var, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prev_vecm)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="progetto_msde_files/figure-html/vecm-forecast-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="confronto-tra-modelli-e-selezione-finale" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Confronto tra Modelli e Selezione Finale</h1>
<section id="riepilogo-dei-modelli-stimati" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="riepilogo-dei-modelli-stimati"><span class="header-section-number">7.1</span> Riepilogo dei modelli stimati</h2>
<p>In questo progetto sono stati stimati diversi modelli per analizzare le serie macroeconomiche USA:</p>
<ol type="1">
<li><strong>ARIMA univariato</strong>: modello per la singola serie (produzione industriale), cattura la dinamica temporale individuale inclusa la stagionalità.</li>
<li><strong>Transfer Function Model</strong>: relazione unidirezionale input-output tra Fed Funds e disoccupazione, con prewhitening per eliminare la contaminazione dell’autocorrelazione dell’input.</li>
<li><strong>VAR</strong>: modello multivariato simmetrico per produzione, disoccupazione e CPI, che tratta tutte le variabili come endogene.</li>
<li><strong>VECM</strong>: modello a correzione dell’errore per consumi, produzione e CPI, che incorpora le relazioni di equilibrio di lungo periodo.</li>
</ol>
</section>
<section id="confronto-quantitativo" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="confronto-quantitativo"><span class="header-section-number">7.2</span> Confronto quantitativo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confronto basato sulla previsione in-sample e criteri informativi</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== CONFRONTO TRA MODELLI ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== CONFRONTO TRA MODELLI ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. ARIMA</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. ARIMA univariato (Produzione Industriale)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. ARIMA univariato (Produzione Industriale)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   AIC = %.2f, BIC = %.2f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">AIC</span>(best_arima), <span class="fu">BIC</span>(best_arima)))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   AIC = -4336.07, BIC = -4309.06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   σ² residui = %.6f</span><span class="sc">\n</span><span class="st">"</span>, best_arima<span class="sc">$</span>sigma2))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   σ² residui = 0.000086</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. VAR</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. VAR multivariato</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
2. VAR multivariato</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  eq_name <span class="ot">&lt;-</span> <span class="fu">names</span>(fit_var<span class="sc">$</span>varresult)[i]</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  aic_i <span class="ot">&lt;-</span> <span class="fu">AIC</span>(fit_var<span class="sc">$</span>varresult[[i]])</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  bic_i <span class="ot">&lt;-</span> <span class="fu">BIC</span>(fit_var<span class="sc">$</span>varresult[[i]])</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   Eq. %s: AIC = %.2f, BIC = %.2f</span><span class="sc">\n</span><span class="st">"</span>, eq_name, aic_i, bic_i))</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Eq. D_LogProd: AIC = -4317.00, BIC = -4294.50
   Eq. D_Disoc: AIC = 814.84, BIC = 837.34
   Eq. D_LogCPI: AIC = -5838.73, BIC = -5816.23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Confronto previsivo: RMSE in-sample per la produzione industriale</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>rmse_arima <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(best_arima)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>rmse_var   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(fit_var)[, <span class="st">"D_LogProd"</span>]<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- RMSE in-sample per Δlog(Prod) ---</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- RMSE in-sample per Δlog(Prod) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   ARIMA: %.6f</span><span class="sc">\n</span><span class="st">"</span>, rmse_arima))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ARIMA: 0.009239</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   VAR:   %.6f</span><span class="sc">\n</span><span class="st">"</span>, rmse_var))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   VAR:   0.009351</code></pre>
</div>
</div>
</section>
<section id="confronto-qualitativo-differenze-tra-i-modelli" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="confronto-qualitativo-differenze-tra-i-modelli"><span class="header-section-number">7.3</span> Confronto qualitativo: differenze tra i modelli</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>confronto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Criterio =</span> <span class="fu">c</span>(<span class="st">"N. variabili"</span>, <span class="st">"Relazioni dinamiche"</span>, </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Relazioni di lungo periodo"</span>, <span class="st">"Direzione causalità"</span>,</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Stagionalità"</span>, <span class="st">"Previsione"</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Interpretabilità"</span>, <span class="st">"N. parametri"</span>),</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ARIMA =</span> <span class="fu">c</span>(<span class="st">"1 (univariato)"</span>, <span class="st">"Solo autocorrelazione"</span>, </span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"No (stazionario/differenziato)"</span>, <span class="st">"N/A"</span>,</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Sì (SARIMA)"</span>, <span class="st">"Solo variabile target"</span>,</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Alta"</span>, <span class="st">"Basso"</span>),</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">TFM =</span> <span class="fu">c</span>(<span class="st">"2 (input-output)"</span>, <span class="st">"Unidirezionale"</span>,</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"No"</span>, <span class="st">"Imposta dal ricercatore"</span>,</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Possibile"</span>, <span class="st">"Solo variabile output"</span>,</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Media"</span>, <span class="st">"Medio"</span>),</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">VAR =</span> <span class="fu">c</span>(<span class="st">"k (tutte endogene)"</span>, <span class="st">"Bidirezionali/multilaterali"</span>,</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">"No (serie stazionarie)"</span>, <span class="st">"Testata (Granger)"</span>,</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Possibile"</span>, <span class="st">"Tutte le variabili"</span>,</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Media (IRF, FEVD)"</span>, <span class="st">"Alto (k²p)"</span>),</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">VECM =</span> <span class="fu">c</span>(<span class="st">"k (tutte endogene)"</span>, <span class="st">"Bidirezionali + equilibrio"</span>,</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Sì (cointegrazione)"</span>, <span class="st">"Testata + ECT"</span>,</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Possibile"</span>, <span class="st">"Tutte + convergenza LR"</span>,</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Alta (relaz. economiche)"</span>, <span class="st">"Alto"</span>)</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(confronto, <span class="at">caption =</span> <span class="st">"Confronto qualitativo tra i modelli"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Confronto qualitativo tra i modelli</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 17%">
<col style="width: 20%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Criterio</th>
<th style="text-align: left;">ARIMA</th>
<th style="text-align: left;">TFM</th>
<th style="text-align: left;">VAR</th>
<th style="text-align: left;">VECM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N. variabili</td>
<td style="text-align: left;">1 (univariato)</td>
<td style="text-align: left;">2 (input-output)</td>
<td style="text-align: left;">k (tutte endogene)</td>
<td style="text-align: left;">k (tutte endogene)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Relazioni dinamiche</td>
<td style="text-align: left;">Solo autocorrelazione</td>
<td style="text-align: left;">Unidirezionale</td>
<td style="text-align: left;">Bidirezionali/multilaterali</td>
<td style="text-align: left;">Bidirezionali + equilibrio</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Relazioni di lungo periodo</td>
<td style="text-align: left;">No (stazionario/differenziato)</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No (serie stazionarie)</td>
<td style="text-align: left;">Sì (cointegrazione)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Direzione causalità</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;">Imposta dal ricercatore</td>
<td style="text-align: left;">Testata (Granger)</td>
<td style="text-align: left;">Testata + ECT</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stagionalità</td>
<td style="text-align: left;">Sì (SARIMA)</td>
<td style="text-align: left;">Possibile</td>
<td style="text-align: left;">Possibile</td>
<td style="text-align: left;">Possibile</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previsione</td>
<td style="text-align: left;">Solo variabile target</td>
<td style="text-align: left;">Solo variabile output</td>
<td style="text-align: left;">Tutte le variabili</td>
<td style="text-align: left;">Tutte + convergenza LR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Interpretabilità</td>
<td style="text-align: left;">Alta</td>
<td style="text-align: left;">Media</td>
<td style="text-align: left;">Media (IRF, FEVD)</td>
<td style="text-align: left;">Alta (relaz. economiche)</td>
</tr>
<tr class="even">
<td style="text-align: left;">N. parametri</td>
<td style="text-align: left;">Basso</td>
<td style="text-align: left;">Medio</td>
<td style="text-align: left;">Alto (k²p)</td>
<td style="text-align: left;">Alto</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="discussione-e-selezione-del-modello-migliore" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="discussione-e-selezione-del-modello-migliore"><span class="header-section-number">7.4</span> Discussione e selezione del modello migliore</h2>
<p>La scelta del modello “migliore” non è univoca e dipende dall’obiettivo dell’analisi.</p>
<p><strong>Per la previsione univariata a breve termine</strong>, il modello ARIMA (o SARIMA) è spesso la scelta più efficiente: è parsimonioso, cattura la stagionalità, e non richiede la specificazione di relazioni tra variabili. Il suo limite è che ignora completamente l’informazione contenuta in altre variabili potenzialmente rilevanti.</p>
<p><strong>Per comprendere le interazioni dinamiche</strong> tra variabili macroeconomiche (come produzione, inflazione e disoccupazione), il VAR è lo strumento naturale. La Granger-causalità, le IRF e la FEVD forniscono un quadro completo delle interdipendenze. Tuttavia, il VAR richiede serie stazionarie e non cattura relazioni di equilibrio di lungo periodo.</p>
<p><strong>Il Transfer Function Model</strong> è appropriato quando la teoria economica suggerisce una relazione unidirezionale chiara tra input e output (es. la politica monetaria influenza la disoccupazione con un ritardo). Il suo vantaggio è la parsimonia rispetto al VAR e la possibilità di modellare esplicitamente la struttura dei ritardi.</p>
<p><strong>Il VECM è il modello più completo</strong> quando le serie sono <span class="math inline">\(I(1)\)</span> e cointegrate: incorpora sia le dinamiche di breve periodo (attraverso i termini in differenze, come il VAR) sia le relazioni di equilibrio di lungo periodo (attraverso il termine di correzione dell’errore). Il VECM è quindi preferibile al VAR in differenze, poiché quest’ultimo ignorerebbe le relazioni di lungo periodo, perdendo informazione rilevante contenuta nei livelli delle serie.</p>
<p><strong>In sintesi</strong>: la scelta dipende dall’obiettivo specifico dell’analisi, dalla natura dei dati (stazionari o integrati, cointegrati o meno), e dal compromesso tra complessità del modello e interpretabilità dei risultati. Per serie macroeconomiche <span class="math inline">\(I(1)\)</span> con relazioni di equilibrio — come quelle analizzate in questo progetto — il VECM rappresenta generalmente la scelta metodologicamente più appropriata.</p>
</section>
</section>
<section id="appendice-pacchetti-r-utilizzati" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Appendice: Pacchetti R utilizzati</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26200)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=Italian_Italy.utf8  LC_CTYPE=Italian_Italy.utf8   
[3] LC_MONETARY=Italian_Italy.utf8 LC_NUMERIC=C                  
[5] LC_TIME=Italian_Italy.utf8    

time zone: Europe/Rome
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gridExtra_2.3     ggplot2_4.0.2     dynlm_0.3-6       vars_1.6-1       
 [5] lmtest_0.9-40     strucchange_1.5-4 sandwich_3.1-1    zoo_1.8-15       
 [9] MASS_7.3-65       urca_1.3-4        forecast_9.0.0    tseries_0.10-59  
[13] readxl_1.4.5     

loaded via a namespace (and not attached):
 [1] generics_0.1.4     lattice_0.22-7     digest_0.6.39      magrittr_2.0.4    
 [5] evaluate_1.0.5     grid_4.5.2         RColorBrewer_1.1-3 fastmap_1.2.0     
 [9] cellranger_1.1.0   jsonlite_2.0.0     nnet_7.3-20        Formula_1.2-5     
[13] scales_1.4.0       abind_1.4-8        cli_3.6.5          rlang_1.1.6       
[17] withr_3.0.2        yaml_2.3.12        tools_4.5.2        parallel_4.5.2    
[21] dplyr_1.1.4        colorspace_2.1-2   curl_7.0.0         vctrs_0.6.5       
[25] R6_2.6.1           lifecycle_1.0.5    car_3.1-5          pkgconfig_2.0.3   
[29] pillar_1.11.1      gtable_0.3.6       glue_1.8.0         quantmod_0.4.28   
[33] Rcpp_1.1.0         xfun_0.56          tibble_3.3.0       tidyselect_1.2.1  
[37] rstudioapi_0.18.0  knitr_1.51         farver_2.1.2       htmltools_0.5.9   
[41] nlme_3.1-168       labeling_0.4.3     carData_3.0-6      rmarkdown_2.30    
[45] xts_0.14.1         timeDate_4052.112  fracdiff_1.5-3     compiler_4.5.2    
[49] S7_0.2.1           quadprog_1.5-8     TTR_0.24.4        </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Eseguire il codice</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb170" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Analisi Econometrica di Serie Storiche Macroeconomiche USA"</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Modelli Statistici per Dati Economici — Progetto Finale"</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> ""</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 10</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 6</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> it</span></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduzione</span></span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Obiettivo del progetto</span></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>Questo progetto applica le metodologie di analisi delle serie storiche studiate nel corso di Modelli Statistici per Dati Economici (MSDE) a un dataset di variabili macroeconomiche statunitensi provenienti dal database FRED (Federal Reserve Economic Data). L'analisi segue un percorso progressivo che parte dall'esplorazione univariata fino ad arrivare alla modellazione multivariata e alla cointegrazione, coprendo i seguenti ambiti:</span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Analisi univariata**: decomposizione classica, identificazione e stima di modelli ARIMA secondo l'approccio Box-Jenkins, diagnostica dei residui e previsione.</span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Analisi bivariata e cross-correlazione**: studio delle relazioni dinamiche tra coppie di variabili tramite la funzione di cross-correlazione (CCF).</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Modelli Transfer Function (TFM)**: identificazione di relazioni input-output tra variabili con prewhitening.</span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Modelli VAR**: stima di modelli vettoriali autoregressivi, selezione dell'ordine, test di Granger-causalità, funzioni di risposta all'impulso (IRF) e decomposizione della varianza dell'errore di previsione (FEVD).</span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cointegrazione**: test di radice unitaria (ADF), procedura di Engle-Granger e procedura di Johansen per la stima del VECM.</span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Confronto tra modelli**: selezione del modello migliore sulla base di criteri informativi, accuratezza previsiva e coerenza economica.</span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Il dataset</span></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a>Il dataset contiene sei serie storiche mensili dal FRED, relative all'economia statunitense:</span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Variabile <span class="pp">|</span> Descrizione <span class="pp">|</span> Periodo <span class="pp">|</span></span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------------|----------------------------|--------------------|</span></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`produzione_industriale`</span> <span class="pp">|</span> Indice di produzione industriale <span class="pp">|</span> Gen 1950 – Ago 2025 <span class="pp">|</span></span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`indice_prezzi_consumo`</span> <span class="pp">|</span> CPI — Indice dei prezzi al consumo <span class="pp">|</span> Gen 1950 – Ago 2025 <span class="pp">|</span></span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`disoccupazione`</span> <span class="pp">|</span> Tasso di disoccupazione (%) <span class="pp">|</span> Gen 1950 – Ago 2025 <span class="pp">|</span></span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`tasso_fed_funds`</span> <span class="pp">|</span> Tasso dei Federal Funds (%) <span class="pp">|</span> Lug 1954 – Ago 2025 <span class="pp">|</span></span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`occupazione_non_agricola`</span> <span class="pp">|</span> Occupati non agricoli (migliaia) <span class="pp">|</span> Gen 1950 – Ago 2025 <span class="pp">|</span></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`consumi_personali`</span> <span class="pp">|</span> Consumi personali (miliardi di USD) <span class="pp">|</span> Gen 1959 – Ago 2025 <span class="pp">|</span></span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Caricamento librerie e dati</span></span>
<span id="cb170-49"><a href="#cb170-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-52"><a href="#cb170-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-53"><a href="#cb170-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb170-54"><a href="#cb170-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-55"><a href="#cb170-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerie principali</span></span>
<span id="cb170-56"><a href="#cb170-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)      <span class="co"># Lettura file Excel</span></span>
<span id="cb170-57"><a href="#cb170-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)     <span class="co"># Test ADF, funzioni per serie storiche</span></span>
<span id="cb170-58"><a href="#cb170-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)    <span class="co"># Modelli ARIMA, auto.arima, diagnostica</span></span>
<span id="cb170-59"><a href="#cb170-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)        <span class="co"># Test di radice unitaria (ur.df), cointegrazione (ca.jo)</span></span>
<span id="cb170-60"><a href="#cb170-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)        <span class="co"># Modelli VAR, Granger-causalità, IRF, FEVD</span></span>
<span id="cb170-61"><a href="#cb170-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)      <span class="co"># Test diagnostici (Breusch-Godfrey, ecc.)</span></span>
<span id="cb170-62"><a href="#cb170-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)       <span class="co"># Modelli dinamici lineari</span></span>
<span id="cb170-63"><a href="#cb170-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)     <span class="co"># Grafici</span></span>
<span id="cb170-64"><a href="#cb170-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)   <span class="co"># Layout grafici multipli</span></span>
<span id="cb170-65"><a href="#cb170-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-66"><a href="#cb170-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-69"><a href="#cb170-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-70"><a href="#cb170-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-data</span></span>
<span id="cb170-71"><a href="#cb170-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-72"><a href="#cb170-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Caricamento del foglio "mensili"</span></span>
<span id="cb170-73"><a href="#cb170-73" aria-hidden="true" tabindex="-1"></a>dati <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"serie_macro_fred.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mensili"</span>)</span>
<span id="cb170-74"><a href="#cb170-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-75"><a href="#cb170-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Rinominiamo le colonne per comodità</span></span>
<span id="cb170-76"><a href="#cb170-76" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dati) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data"</span>, <span class="st">"prod_ind"</span>, <span class="st">"cpi"</span>, <span class="st">"disoccupazione"</span>,</span>
<span id="cb170-77"><a href="#cb170-77" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"fed_funds"</span>, <span class="st">"occupazione"</span>, <span class="st">"consumi"</span>)</span>
<span id="cb170-78"><a href="#cb170-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-79"><a href="#cb170-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizzazione struttura</span></span>
<span id="cb170-80"><a href="#cb170-80" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dati)</span>
<span id="cb170-81"><a href="#cb170-81" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dati)</span>
<span id="cb170-82"><a href="#cb170-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-83"><a href="#cb170-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-84"><a href="#cb170-84" aria-hidden="true" tabindex="-1"></a>Per garantire la massima disponibilità di osservazioni comuni, restringiamo il campione al periodo in cui tutte le variabili sono disponibili: da gennaio 1959 in poi (data di inizio dei consumi personali). Per il Transfer Function Model, che richiede il tasso dei Fed Funds, il campione partirà da luglio 1954.</span>
<span id="cb170-85"><a href="#cb170-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-88"><a href="#cb170-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-89"><a href="#cb170-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: create-ts</span></span>
<span id="cb170-90"><a href="#cb170-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-91"><a href="#cb170-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Campione completo: da gennaio 1959 (tutte le variabili disponibili)</span></span>
<span id="cb170-92"><a href="#cb170-92" aria-hidden="true" tabindex="-1"></a>dati_completo <span class="ot">&lt;-</span> dati[dati<span class="sc">$</span>data <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1959-01-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb170-93"><a href="#cb170-93" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">!</span><span class="fu">is.na</span>(dati<span class="sc">$</span>consumi), ]</span>
<span id="cb170-94"><a href="#cb170-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-95"><a href="#cb170-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Creazione delle serie storiche ts</span></span>
<span id="cb170-96"><a href="#cb170-96" aria-hidden="true" tabindex="-1"></a>prod_ind   <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>prod_ind, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-97"><a href="#cb170-97" aria-hidden="true" tabindex="-1"></a>cpi        <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>cpi, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-98"><a href="#cb170-98" aria-hidden="true" tabindex="-1"></a>disoc      <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>disoccupazione, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-99"><a href="#cb170-99" aria-hidden="true" tabindex="-1"></a>fed_funds  <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>fed_funds, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-100"><a href="#cb170-100" aria-hidden="true" tabindex="-1"></a>occupaz    <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>occupazione, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-101"><a href="#cb170-101" aria-hidden="true" tabindex="-1"></a>consumi    <span class="ot">&lt;-</span> <span class="fu">ts</span>(dati_completo<span class="sc">$</span>consumi, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-102"><a href="#cb170-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-103"><a href="#cb170-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Trasformazione logaritmica per le variabili con trend esponenziale</span></span>
<span id="cb170-104"><a href="#cb170-104" aria-hidden="true" tabindex="-1"></a>log_prod   <span class="ot">&lt;-</span> <span class="fu">log</span>(prod_ind)</span>
<span id="cb170-105"><a href="#cb170-105" aria-hidden="true" tabindex="-1"></a>log_cpi    <span class="ot">&lt;-</span> <span class="fu">log</span>(cpi)</span>
<span id="cb170-106"><a href="#cb170-106" aria-hidden="true" tabindex="-1"></a>log_consumi <span class="ot">&lt;-</span> <span class="fu">log</span>(consumi)</span>
<span id="cb170-107"><a href="#cb170-107" aria-hidden="true" tabindex="-1"></a>log_occupaz <span class="ot">&lt;-</span> <span class="fu">log</span>(occupaz)</span>
<span id="cb170-108"><a href="#cb170-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-109"><a href="#cb170-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-112"><a href="#cb170-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-113"><a href="#cb170-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot-overview</span></span>
<span id="cb170-114"><a href="#cb170-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb170-115"><a href="#cb170-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-116"><a href="#cb170-116" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-117"><a href="#cb170-117" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prod_ind, <span class="at">main =</span> <span class="st">"Produzione Industriale"</span>, <span class="at">ylab =</span> <span class="st">"Indice"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb170-118"><a href="#cb170-118" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cpi, <span class="at">main =</span> <span class="st">"CPI — Indice Prezzi al Consumo"</span>, <span class="at">ylab =</span> <span class="st">"Indice"</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>)</span>
<span id="cb170-119"><a href="#cb170-119" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(disoc, <span class="at">main =</span> <span class="st">"Tasso di Disoccupazione"</span>, <span class="at">ylab =</span> <span class="st">"%"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb170-120"><a href="#cb170-120" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fed_funds, <span class="at">main =</span> <span class="st">"Tasso Fed Funds"</span>, <span class="at">ylab =</span> <span class="st">"%"</span>, <span class="at">col =</span> <span class="st">"purple"</span>)</span>
<span id="cb170-121"><a href="#cb170-121" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(occupaz, <span class="at">main =</span> <span class="st">"Occupazione Non Agricola"</span>, <span class="at">ylab =</span> <span class="st">"Migliaia"</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>)</span>
<span id="cb170-122"><a href="#cb170-122" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(consumi, <span class="at">main =</span> <span class="st">"Consumi Personali"</span>, <span class="at">ylab =</span> <span class="st">"Mld USD"</span>, <span class="at">col =</span> <span class="st">"brown"</span>)</span>
<span id="cb170-123"><a href="#cb170-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-124"><a href="#cb170-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-125"><a href="#cb170-125" aria-hidden="true" tabindex="-1"></a>Dall'ispezione visiva emergono chiaramente alcune caratteristiche: la produzione industriale, il CPI, l'occupazione e i consumi personali mostrano un trend crescente di lungo periodo, tipico delle serie I(1). Il tasso di disoccupazione presenta fluttuazioni cicliche attorno a un livello medio, mentre il tasso dei Fed Funds mostra un pattern altamente variabile legato alle decisioni di politica monetaria.</span>
<span id="cb170-126"><a href="#cb170-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-127"><a href="#cb170-127" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analisi Univariata (MSDE_01)</span></span>
<span id="cb170-128"><a href="#cb170-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-129"><a href="#cb170-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fondamenti teorici</span></span>
<span id="cb170-130"><a href="#cb170-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-131"><a href="#cb170-131" aria-hidden="true" tabindex="-1"></a>Una serie storica è un insieme di osservazioni misurate sequenzialmente nel tempo. Lo scopo dell'analisi è duplice: comprendere il meccanismo stocastico che genera la serie e prevedere i valori futuri sulla base della storia passata. La caratteristica fondamentale è che le osservazioni non possono essere considerate indipendenti: la dipendenza temporale è la chiave dell'analisi.</span>
<span id="cb170-132"><a href="#cb170-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-133"><a href="#cb170-133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Decomposizione classica</span></span>
<span id="cb170-134"><a href="#cb170-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-135"><a href="#cb170-135" aria-hidden="true" tabindex="-1"></a>L'approccio classico decompone una serie in quattro componenti:</span>
<span id="cb170-136"><a href="#cb170-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-137"><a href="#cb170-137" aria-hidden="true" tabindex="-1"></a>$$X_t = T_t + S_t + C_t + \varepsilon_t$$</span>
<span id="cb170-138"><a href="#cb170-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-139"><a href="#cb170-139" aria-hidden="true" tabindex="-1"></a>dove $T_t$ è il trend (movimenti di lungo periodo nella media), $S_t$ sono gli effetti stagionali (fluttuazioni cicliche legate al calendario), $C_t$ è il ciclo (altre fluttuazioni cicliche come il ciclo economico) e $\varepsilon_t$ è la componente residuale, con $\varepsilon_t \sim WN(0, \sigma^2)$.</span>
<span id="cb170-140"><a href="#cb170-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-143"><a href="#cb170-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-144"><a href="#cb170-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: decomposition</span></span>
<span id="cb170-145"><a href="#cb170-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-146"><a href="#cb170-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-147"><a href="#cb170-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Decomposizione additiva della produzione industriale</span></span>
<span id="cb170-148"><a href="#cb170-148" aria-hidden="true" tabindex="-1"></a>decomp_prod <span class="ot">&lt;-</span> <span class="fu">decompose</span>(prod_ind, <span class="at">type =</span> <span class="st">"additive"</span>)</span>
<span id="cb170-149"><a href="#cb170-149" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomp_prod, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb170-150"><a href="#cb170-150" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Decomposizione Additiva — Produzione Industriale"</span>, </span>
<span id="cb170-151"><a href="#cb170-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb170-152"><a href="#cb170-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-153"><a href="#cb170-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-156"><a href="#cb170-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-157"><a href="#cb170-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: decomposition-cpi</span></span>
<span id="cb170-158"><a href="#cb170-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-159"><a href="#cb170-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-160"><a href="#cb170-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Decomposizione multiplicativa del CPI (più appropriata per serie con trend esponenziale)</span></span>
<span id="cb170-161"><a href="#cb170-161" aria-hidden="true" tabindex="-1"></a>decomp_cpi <span class="ot">&lt;-</span> <span class="fu">decompose</span>(cpi, <span class="at">type =</span> <span class="st">"multiplicative"</span>)</span>
<span id="cb170-162"><a href="#cb170-162" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomp_cpi, <span class="at">col =</span> <span class="st">"firebrick"</span>)</span>
<span id="cb170-163"><a href="#cb170-163" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Decomposizione Multiplicativa — CPI"</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb170-164"><a href="#cb170-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-165"><a href="#cb170-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-166"><a href="#cb170-166" aria-hidden="true" tabindex="-1"></a>La decomposizione additiva è appropriata quando le fluttuazioni stagionali hanno ampiezza costante, mentre quella multiplicativa è preferibile quando l'ampiezza stagionale cresce proporzionalmente al livello della serie (come nel caso del CPI).</span>
<span id="cb170-167"><a href="#cb170-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-168"><a href="#cb170-168" aria-hidden="true" tabindex="-1"></a><span class="fu">### Approccio moderno: Box-Jenkins</span></span>
<span id="cb170-169"><a href="#cb170-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-170"><a href="#cb170-170" aria-hidden="true" tabindex="-1"></a>L'approccio moderno (Box-Jenkins) mira a costruire un modello stocastico che rappresenti bene i dati, nel senso che la serie osservata possa essere vista come una realizzazione del processo stocastico. Le fasi dell'analisi sono tre: specificazione del modello (identification), stima dei parametri (estimation) e valutazione del modello (evaluation/diagnostic checking).</span>
<span id="cb170-171"><a href="#cb170-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-172"><a href="#cb170-172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stazionarietà e ACF/PACF</span></span>
<span id="cb170-173"><a href="#cb170-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-174"><a href="#cb170-174" aria-hidden="true" tabindex="-1"></a>Un concetto fondamentale è quello di stazionarietà debole: un processo $<span class="sc">\{</span>Y_t<span class="sc">\}</span>$ è debolmente stazionario se la sua media $E<span class="co">[</span><span class="ot">Y_t</span><span class="co">]</span> = \mu$ è costante nel tempo, la varianza $Var(Y_t) = \sigma^2$ è finita e costante, e la funzione di autocovarianza $\gamma(h) = Cov(Y_t, Y_{t+h})$ dipende solo dal lag $h$ e non dal tempo $t$.</span>
<span id="cb170-175"><a href="#cb170-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-176"><a href="#cb170-176" aria-hidden="true" tabindex="-1"></a>La funzione di autocorrelazione (ACF) campionaria $\hat{\rho}(k)$ e la funzione di autocorrelazione parziale (PACF) campionaria $\hat{P}(k)$ sono gli strumenti principali per l'identificazione del modello. Per un processo white noise $\varepsilon_t \sim WN(0, \sigma^2)$, le autocorrelazioni campionarie sono approssimativamente $\hat{\rho}(k) \sim N(0, 1/n)$, il che consente di costruire le bande di confidenza $\pm 1.96/\sqrt{n}$.</span>
<span id="cb170-177"><a href="#cb170-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-178"><a href="#cb170-178" aria-hidden="true" tabindex="-1"></a>I pattern tipici sono: per un AR(p) la ACF decade esponenzialmente (o con oscillazioni smorzate) e la PACF si tronca al lag p; per un MA(q) la ACF si tronca al lag q e la PACF decade esponenzialmente; per un ARMA(p,q) entrambe decadono senza troncamento netto.</span>
<span id="cb170-179"><a href="#cb170-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-182"><a href="#cb170-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-183"><a href="#cb170-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: acf-pacf-prod</span></span>
<span id="cb170-184"><a href="#cb170-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-185"><a href="#cb170-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-186"><a href="#cb170-186" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF e PACF della produzione industriale in livelli</span></span>
<span id="cb170-187"><a href="#cb170-187" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-188"><a href="#cb170-188" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(log_prod, <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"ACF — log(Produzione Industriale)"</span>)</span>
<span id="cb170-189"><a href="#cb170-189" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(log_prod, <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"PACF — log(Produzione Industriale)"</span>)</span>
<span id="cb170-190"><a href="#cb170-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-191"><a href="#cb170-191" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF e PACF delle differenze prime</span></span>
<span id="cb170-192"><a href="#cb170-192" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(log_prod), <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"ACF — Δlog(Produzione Industriale)"</span>)</span>
<span id="cb170-193"><a href="#cb170-193" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(log_prod), <span class="at">lag.max =</span> <span class="dv">48</span>, <span class="at">main =</span> <span class="st">"PACF — Δlog(Produzione Industriale)"</span>)</span>
<span id="cb170-194"><a href="#cb170-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-195"><a href="#cb170-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-196"><a href="#cb170-196" aria-hidden="true" tabindex="-1"></a>La ACF della serie in livelli decade molto lentamente, segno tipico di non stazionarietà. Dopo la differenziazione, la ACF mostra un pattern compatibile con stazionarietà, con possibili componenti stagionali ai lag multipli di 12.</span>
<span id="cb170-197"><a href="#cb170-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-198"><a href="#cb170-198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Identificazione e stima del modello ARIMA</span></span>
<span id="cb170-199"><a href="#cb170-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-200"><a href="#cb170-200" aria-hidden="true" tabindex="-1"></a>Un modello ARIMA(p,d,q) è definito come:</span>
<span id="cb170-201"><a href="#cb170-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-202"><a href="#cb170-202" aria-hidden="true" tabindex="-1"></a>$$\phi(B)(1-B)^d Y_t = \theta(B)\varepsilon_t$$</span>
<span id="cb170-203"><a href="#cb170-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-204"><a href="#cb170-204" aria-hidden="true" tabindex="-1"></a>dove $\phi(B) = 1 - \phi_1 B - \ldots - \phi_p B^p$ è il polinomio autoregressivo, $\theta(B) = 1 + \theta_1 B + \ldots + \theta_q B^q$ è il polinomio a media mobile, $d$ è l'ordine di integrazione e $\varepsilon_t \sim WN(0, \sigma^2)$.</span>
<span id="cb170-205"><a href="#cb170-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-206"><a href="#cb170-206" aria-hidden="true" tabindex="-1"></a>Per dati mensili con stagionalità, si estende al modello SARIMA(p,d,q)(P,D,Q)<span class="sc">\[</span>12<span class="sc">\]</span>:</span>
<span id="cb170-207"><a href="#cb170-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-208"><a href="#cb170-208" aria-hidden="true" tabindex="-1"></a>$$\phi(B)\Phi(B^{12})(1-B)^d(1-B^{12})^D Y_t = \theta(B)\Theta(B^{12})\varepsilon_t$$</span>
<span id="cb170-209"><a href="#cb170-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-210"><a href="#cb170-210" aria-hidden="true" tabindex="-1"></a>Utilizziamo la funzione <span class="in">`auto.arima()`</span> per la selezione automatica basata su criteri informativi (AIC, BIC), verificando poi il risultato con l'analisi manuale di ACF e PACF.</span>
<span id="cb170-211"><a href="#cb170-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-214"><a href="#cb170-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-215"><a href="#cb170-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: arima-identification</span></span>
<span id="cb170-216"><a href="#cb170-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-217"><a href="#cb170-217" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezione automatica del modello ARIMA per log(produzione industriale)</span></span>
<span id="cb170-218"><a href="#cb170-218" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(log_prod, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, </span>
<span id="cb170-219"><a href="#cb170-219" aria-hidden="true" tabindex="-1"></a>                        <span class="at">approximation =</span> <span class="cn">FALSE</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb170-220"><a href="#cb170-220" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span>
<span id="cb170-221"><a href="#cb170-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-222"><a href="#cb170-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-225"><a href="#cb170-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-226"><a href="#cb170-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: arima-manual</span></span>
<span id="cb170-227"><a href="#cb170-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-228"><a href="#cb170-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifica manuale: proviamo alcuni modelli alternativi</span></span>
<span id="cb170-229"><a href="#cb170-229" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_prod, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb170-230"><a href="#cb170-230" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_prod, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb170-231"><a href="#cb170-231" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_prod, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb170-232"><a href="#cb170-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-233"><a href="#cb170-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Confronto criteri informativi</span></span>
<span id="cb170-234"><a href="#cb170-234" aria-hidden="true" tabindex="-1"></a>modelli_arima <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb170-235"><a href="#cb170-235" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modello =</span> <span class="fu">c</span>(<span class="st">"auto.arima"</span>, <span class="st">"ARIMA(1,1,1)(0,1,1)[12]"</span>, </span>
<span id="cb170-236"><a href="#cb170-236" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ARIMA(2,1,1)(0,1,1)[12]"</span>, <span class="st">"ARIMA(1,1,2)(1,1,1)[12]"</span>),</span>
<span id="cb170-237"><a href="#cb170-237" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(fit_auto), <span class="fu">AIC</span>(fit1), <span class="fu">AIC</span>(fit2), <span class="fu">AIC</span>(fit3)),</span>
<span id="cb170-238"><a href="#cb170-238" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(fit_auto), <span class="fu">BIC</span>(fit1), <span class="fu">BIC</span>(fit2), <span class="fu">BIC</span>(fit3)),</span>
<span id="cb170-239"><a href="#cb170-239" aria-hidden="true" tabindex="-1"></a>  <span class="at">AICc =</span> <span class="fu">c</span>(fit_auto<span class="sc">$</span>aicc, fit1<span class="sc">$</span>aicc, fit2<span class="sc">$</span>aicc, fit3<span class="sc">$</span>aicc)</span>
<span id="cb170-240"><a href="#cb170-240" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-241"><a href="#cb170-241" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(modelli_arima, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb170-242"><a href="#cb170-242" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Confronto criteri informativi — Modelli ARIMA"</span>)</span>
<span id="cb170-243"><a href="#cb170-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-244"><a href="#cb170-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-245"><a href="#cb170-245" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostica dei residui</span></span>
<span id="cb170-246"><a href="#cb170-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-247"><a href="#cb170-247" aria-hidden="true" tabindex="-1"></a>La valutazione del modello si basa sull'analisi dei residui, che devono comportarsi come un white noise. I controlli fondamentali sono: assenza di autocorrelazione (verificata tramite ACF dei residui e test di Ljung-Box), normalità dei residui e assenza di eteroschedasticità.</span>
<span id="cb170-248"><a href="#cb170-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-249"><a href="#cb170-249" aria-hidden="true" tabindex="-1"></a>Il test di Ljung-Box generalizzato verifica l'ipotesi nulla $H_0: \rho(1) = \rho(2) = \ldots = \rho(p) = 0$ contro l'alternativa che almeno una autocorrelazione sia diversa da zero. La statistica test è:</span>
<span id="cb170-250"><a href="#cb170-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-251"><a href="#cb170-251" aria-hidden="true" tabindex="-1"></a>$$Q(p) = T(T+2) \sum_{l=1}^{p} \frac{\hat{\rho}^2(l)}{T-l} \xrightarrow{d} \chi^2(p - p_{par})$$</span>
<span id="cb170-252"><a href="#cb170-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-253"><a href="#cb170-253" aria-hidden="true" tabindex="-1"></a>dove $p_{par}$ è il numero di parametri stimati nel modello.</span>
<span id="cb170-254"><a href="#cb170-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-257"><a href="#cb170-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-258"><a href="#cb170-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: diagnostica-arima</span></span>
<span id="cb170-259"><a href="#cb170-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-260"><a href="#cb170-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-261"><a href="#cb170-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezioniamo il modello migliore (quello con AIC minore)</span></span>
<span id="cb170-262"><a href="#cb170-262" aria-hidden="true" tabindex="-1"></a>best_arima <span class="ot">&lt;-</span> fit_auto  <span class="co"># o il modello con AIC più basso dal confronto</span></span>
<span id="cb170-263"><a href="#cb170-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-264"><a href="#cb170-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostica completa</span></span>
<span id="cb170-265"><a href="#cb170-265" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(best_arima)</span>
<span id="cb170-266"><a href="#cb170-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-267"><a href="#cb170-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-270"><a href="#cb170-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-271"><a href="#cb170-271" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ljung-box-test</span></span>
<span id="cb170-272"><a href="#cb170-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-273"><a href="#cb170-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di Ljung-Box a diversi lag</span></span>
<span id="cb170-274"><a href="#cb170-274" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test di Ljung-Box sui residui ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-275"><a href="#cb170-275" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lag <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">36</span>)) {</span>
<span id="cb170-276"><a href="#cb170-276" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(<span class="fu">residuals</span>(best_arima), <span class="at">lag =</span> lag, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>,</span>
<span id="cb170-277"><a href="#cb170-277" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fitdf =</span> <span class="fu">length</span>(<span class="fu">coef</span>(best_arima)))</span>
<span id="cb170-278"><a href="#cb170-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Lag %d: Q = %.3f, p-value = %.4f</span><span class="sc">\n</span><span class="st">"</span>, lag, test<span class="sc">$</span>statistic, test<span class="sc">$</span>p.value))</span>
<span id="cb170-279"><a href="#cb170-279" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-280"><a href="#cb170-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-281"><a href="#cb170-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-284"><a href="#cb170-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-285"><a href="#cb170-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: normalita-residui</span></span>
<span id="cb170-286"><a href="#cb170-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-287"><a href="#cb170-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di Jarque-Bera per la normalità</span></span>
<span id="cb170-288"><a href="#cb170-288" aria-hidden="true" tabindex="-1"></a>jb_test <span class="ot">&lt;-</span> <span class="fu">jarque.bera.test</span>(<span class="fu">residuals</span>(best_arima))</span>
<span id="cb170-289"><a href="#cb170-289" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Test Jarque-Bera: statistica = %.3f, p-value = %.4f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb170-290"><a href="#cb170-290" aria-hidden="true" tabindex="-1"></a>            jb_test<span class="sc">$</span>statistic, jb_test<span class="sc">$</span>p.value))</span>
<span id="cb170-291"><a href="#cb170-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-292"><a href="#cb170-292" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ-plot</span></span>
<span id="cb170-293"><a href="#cb170-293" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb170-294"><a href="#cb170-294" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(best_arima), <span class="at">main =</span> <span class="st">"QQ-Plot dei residui ARIMA"</span>)</span>
<span id="cb170-295"><a href="#cb170-295" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(best_arima), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb170-296"><a href="#cb170-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-297"><a href="#cb170-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-298"><a href="#cb170-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Previsione univariata</span></span>
<span id="cb170-299"><a href="#cb170-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-302"><a href="#cb170-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-303"><a href="#cb170-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: forecast-arima</span></span>
<span id="cb170-304"><a href="#cb170-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb170-305"><a href="#cb170-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-306"><a href="#cb170-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Previsione a 12 mesi</span></span>
<span id="cb170-307"><a href="#cb170-307" aria-hidden="true" tabindex="-1"></a>prev_arima <span class="ot">&lt;-</span> <span class="fu">forecast</span>(best_arima, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb170-308"><a href="#cb170-308" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prev_arima, <span class="at">main =</span> <span class="st">"Previsione ARIMA — log(Produzione Industriale)"</span>,</span>
<span id="cb170-309"><a href="#cb170-309" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log(Indice)"</span>, <span class="at">xlab =</span> <span class="st">"Anno"</span>)</span>
<span id="cb170-310"><a href="#cb170-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-311"><a href="#cb170-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-312"><a href="#cb170-312" aria-hidden="true" tabindex="-1"></a>La previsione mostra gli intervalli di confidenza all'80% e al 95%. L'ampiezza crescente degli intervalli riflette l'incertezza che aumenta con l'orizzonte previsivo, una caratteristica fondamentale di tutti i modelli di serie storiche.</span>
<span id="cb170-313"><a href="#cb170-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-314"><a href="#cb170-314" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analisi Bivariata e Cross-Correlazione (MSDE_02)</span></span>
<span id="cb170-315"><a href="#cb170-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-316"><a href="#cb170-316" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fondamenti teorici</span></span>
<span id="cb170-317"><a href="#cb170-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-318"><a href="#cb170-318" aria-hidden="true" tabindex="-1"></a>Quando si considerano più serie storiche congiuntamente, si ottiene una capacità interpretativa e previsiva superiore rispetto all'analisi univariata. Una serie storica multipla $\mathbf{y}_t$ è rappresentata da un vettore $k$-dimensionale:</span>
<span id="cb170-319"><a href="#cb170-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-320"><a href="#cb170-320" aria-hidden="true" tabindex="-1"></a>$$\mathbf{y}_t = [y_{1,t}, y_{2,t}, \ldots, y_{k,t}]'$$</span>
<span id="cb170-321"><a href="#cb170-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-322"><a href="#cb170-322" aria-hidden="true" tabindex="-1"></a>I primi due momenti sono $E<span class="co">[</span><span class="ot">\mathbf{y}_t</span><span class="co">]</span> = \boldsymbol{\mu}$ (vettore $k \times 1$) e $V<span class="co">[</span><span class="ot">\mathbf{y}_t</span><span class="co">]</span> = \boldsymbol{\Sigma}$ (matrice $k \times k$).</span>
<span id="cb170-323"><a href="#cb170-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-324"><a href="#cb170-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Funzione di cross-covarianza e cross-correlazione</span></span>
<span id="cb170-325"><a href="#cb170-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-326"><a href="#cb170-326" aria-hidden="true" tabindex="-1"></a>La funzione di cross-covarianza tra due componenti $y_{i,t}$ e $y_{j,t}$ al lag $l$ è:</span>
<span id="cb170-327"><a href="#cb170-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-328"><a href="#cb170-328" aria-hidden="true" tabindex="-1"></a>$$\gamma_{ij}(l) = Cov(y_{i,t}, y_{j,t-l})$$</span>
<span id="cb170-329"><a href="#cb170-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-330"><a href="#cb170-330" aria-hidden="true" tabindex="-1"></a>e la corrispondente cross-correlazione è:</span>
<span id="cb170-331"><a href="#cb170-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-332"><a href="#cb170-332" aria-hidden="true" tabindex="-1"></a>$$\rho_{ij}(l) = \frac{\gamma_{ij}(l)}{\sqrt{\gamma_{ii}(0) \cdot \gamma_{jj}(0)}}$$</span>
<span id="cb170-333"><a href="#cb170-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-334"><a href="#cb170-334" aria-hidden="true" tabindex="-1"></a>Un aspetto cruciale è che la funzione di cross-covarianza **non è simmetrica**: $\gamma_{ij}(l) \neq \gamma_{ij}(-l)$ in generale, ma vale $\gamma_{ij}(l) = \gamma_{ji}(-l)$. Questo riflette il fatto che la relazione tra due variabili può essere diversa a seconda della direzione temporale.</span>
<span id="cb170-335"><a href="#cb170-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-336"><a href="#cb170-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test di Ljung-Box multivariato</span></span>
<span id="cb170-337"><a href="#cb170-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-338"><a href="#cb170-338" aria-hidden="true" tabindex="-1"></a>Per verificare se una serie multipla è priva di auto- e cross-correlazione si usa la generalizzazione multivariata del test di Ljung-Box:</span>
<span id="cb170-339"><a href="#cb170-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-340"><a href="#cb170-340" aria-hidden="true" tabindex="-1"></a>$$Q_k(p) = T^2 \sum_{l=1}^{p} \frac{1}{T-l} \text{tr}\left<span class="co">[</span><span class="ot">\hat{\Gamma}(l)'\hat{\Gamma}(0)^{-1}\hat{\Gamma}(l)\hat{\Gamma}(0)^{-1}\right</span><span class="co">]</span> \xrightarrow{d} \chi^2(k^2 p)$$</span>
<span id="cb170-341"><a href="#cb170-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-344"><a href="#cb170-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-345"><a href="#cb170-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ccf-analysis</span></span>
<span id="cb170-346"><a href="#cb170-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb170-347"><a href="#cb170-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-348"><a href="#cb170-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-correlazione tra coppie di variabili chiave</span></span>
<span id="cb170-349"><a href="#cb170-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Lavoriamo sulle differenze prime per garantire stazionarietà</span></span>
<span id="cb170-350"><a href="#cb170-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-351"><a href="#cb170-351" aria-hidden="true" tabindex="-1"></a>d_log_prod <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_prod)</span>
<span id="cb170-352"><a href="#cb170-352" aria-hidden="true" tabindex="-1"></a>d_disoc    <span class="ot">&lt;-</span> <span class="fu">diff</span>(disoc)</span>
<span id="cb170-353"><a href="#cb170-353" aria-hidden="true" tabindex="-1"></a>d_log_cpi  <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_cpi)</span>
<span id="cb170-354"><a href="#cb170-354" aria-hidden="true" tabindex="-1"></a>d_fed      <span class="ot">&lt;-</span> <span class="fu">diff</span>(fed_funds)</span>
<span id="cb170-355"><a href="#cb170-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-356"><a href="#cb170-356" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-357"><a href="#cb170-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-358"><a href="#cb170-358" aria-hidden="true" tabindex="-1"></a><span class="co"># CCF tra variazione produzione industriale e variazione disoccupazione</span></span>
<span id="cb170-359"><a href="#cb170-359" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(d_log_prod, d_disoc, <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb170-360"><a href="#cb170-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF: Δlog(Prod. Ind.) e Δ(Disoccupazione)"</span>,</span>
<span id="cb170-361"><a href="#cb170-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb170-362"><a href="#cb170-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-363"><a href="#cb170-363" aria-hidden="true" tabindex="-1"></a><span class="co"># CCF tra variazione CPI e variazione Fed Funds</span></span>
<span id="cb170-364"><a href="#cb170-364" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(d_log_cpi, d_fed, <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb170-365"><a href="#cb170-365" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF: Δlog(CPI) e Δ(Fed Funds)"</span>,</span>
<span id="cb170-366"><a href="#cb170-366" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb170-367"><a href="#cb170-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-368"><a href="#cb170-368" aria-hidden="true" tabindex="-1"></a><span class="co"># CCF tra variazione produzione e variazione CPI</span></span>
<span id="cb170-369"><a href="#cb170-369" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(d_log_prod, d_log_cpi, <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb170-370"><a href="#cb170-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF: Δlog(Prod. Ind.) e Δlog(CPI)"</span>,</span>
<span id="cb170-371"><a href="#cb170-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb170-372"><a href="#cb170-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-373"><a href="#cb170-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-374"><a href="#cb170-374" aria-hidden="true" tabindex="-1"></a>Nell'output della funzione <span class="in">`ccf(x, y)`</span>, i lag negativi indicano che $x$ anticipa $y$ (cioè i valori passati di $x$ sono correlati con il valore corrente di $y$), mentre i lag positivi indicano che $y$ anticipa $x$. Questo è cruciale per interpretare la direzione della relazione dinamica tra le variabili.</span>
<span id="cb170-375"><a href="#cb170-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-376"><a href="#cb170-376" aria-hidden="true" tabindex="-1"></a><span class="fu"># Transfer Function Model (MSDE_03)</span></span>
<span id="cb170-377"><a href="#cb170-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-378"><a href="#cb170-378" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fondamenti teorici</span></span>
<span id="cb170-379"><a href="#cb170-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-380"><a href="#cb170-380" aria-hidden="true" tabindex="-1"></a>Il modello Transfer Function (TFM) esprime la relazione tra una serie di output $y_t$ e una serie di input $x_t$ attraverso un filtro lineare:</span>
<span id="cb170-381"><a href="#cb170-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-382"><a href="#cb170-382" aria-hidden="true" tabindex="-1"></a>$$y_t = \nu(B)x_t + \eta_t$$</span>
<span id="cb170-383"><a href="#cb170-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-384"><a href="#cb170-384" aria-hidden="true" tabindex="-1"></a>dove $\nu(B) = \sum_{j=0}^{\infty} \nu_j B^j$ è la funzione di trasferimento, i coefficienti $\nu_j$ sono i pesi della risposta all'impulso (impulse response weights) e $\eta_t$ è la serie di disturbo (non necessariamente white noise), indipendente da $x_t$. Il TFM è stabile se $\sum |\nu_j| &lt; \infty$ e causale se $\nu_j = 0$ per $j &lt; 0$.</span>
<span id="cb170-385"><a href="#cb170-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-386"><a href="#cb170-386" aria-hidden="true" tabindex="-1"></a><span class="fu">### La relazione tra CCF e TFM</span></span>
<span id="cb170-387"><a href="#cb170-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-388"><a href="#cb170-388" aria-hidden="true" tabindex="-1"></a>Se le serie sono stazionarie con media zero, la cross-covarianza è legata ai pesi della risposta all'impulso da:</span>
<span id="cb170-389"><a href="#cb170-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-390"><a href="#cb170-390" aria-hidden="true" tabindex="-1"></a>$$\gamma_{yx}(k) = \nu_0 \gamma_x(k) + \nu_1 \gamma_x(k-1) + \nu_2 \gamma_x(k-2) + \ldots$$</span>
<span id="cb170-391"><a href="#cb170-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-392"><a href="#cb170-392" aria-hidden="true" tabindex="-1"></a>Se la serie di input è white noise ($\rho_x(k) = 0$ per $k \neq 0$), allora $\nu_k = \frac{\sigma_y}{\sigma_x}\rho_{yx}(k)$, cioè la funzione di risposta all'impulso è direttamente proporzionale alla CCF. In caso contrario, la relazione è "contaminata" dall'autocorrelazione dell'input, rendendo necessaria la procedura di **prewhitening**.</span>
<span id="cb170-393"><a href="#cb170-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-394"><a href="#cb170-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Procedura di costruzione del TFM</span></span>
<span id="cb170-395"><a href="#cb170-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-396"><a href="#cb170-396" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Stimare un modello ARMA per la serie di input $x_t$: $\phi_x(B)x_t = \theta_x(B)\alpha_t$</span>
<span id="cb170-397"><a href="#cb170-397" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Filtrare la serie di output con lo stesso modello per ottenere $\beta_t = \frac{\phi_x(B)}{\theta_x(B)}y_t$</span>
<span id="cb170-398"><a href="#cb170-398" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Calcolare la CCF campionaria tra $\alpha_t$ e $\beta_t$ per stimare i pesi della risposta all'impulso: $\hat{\nu}_k = \frac{\hat{\sigma}_\beta}{\hat{\sigma}_\alpha}\hat{\rho}_{\beta\alpha}(k)$</span>
<span id="cb170-399"><a href="#cb170-399" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Identificare gli ordini $(r, s, b)$ del modello razionale $\nu(B) = \frac{\omega(B)}{\delta(B)}B^b$</span>
<span id="cb170-400"><a href="#cb170-400" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Stimare il modello completo e verificare la diagnostica</span>
<span id="cb170-401"><a href="#cb170-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-404"><a href="#cb170-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-405"><a href="#cb170-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tfm-prewhitening</span></span>
<span id="cb170-406"><a href="#cb170-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-407"><a href="#cb170-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Transfer Function: Fed Funds (input) -&gt; Disoccupazione (output)</span></span>
<span id="cb170-408"><a href="#cb170-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizziamo le differenze prime per la stazionarietà</span></span>
<span id="cb170-409"><a href="#cb170-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-410"><a href="#cb170-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Allineiamo le serie (entrambe dal 1959 in poi)</span></span>
<span id="cb170-411"><a href="#cb170-411" aria-hidden="true" tabindex="-1"></a>input_x  <span class="ot">&lt;-</span> d_fed       <span class="co"># Δ(Fed Funds) come input</span></span>
<span id="cb170-412"><a href="#cb170-412" aria-hidden="true" tabindex="-1"></a>output_y <span class="ot">&lt;-</span> d_disoc      <span class="co"># Δ(Disoccupazione) come output</span></span>
<span id="cb170-413"><a href="#cb170-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-414"><a href="#cb170-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Modello ARMA per la serie di input (prewhitening)</span></span>
<span id="cb170-415"><a href="#cb170-415" aria-hidden="true" tabindex="-1"></a>fit_input <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(input_x, <span class="at">seasonal =</span> <span class="cn">FALSE</span>, <span class="at">max.p =</span> <span class="dv">5</span>, <span class="at">max.q =</span> <span class="dv">5</span>)</span>
<span id="cb170-416"><a href="#cb170-416" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Modello ARMA per l'input Δ(Fed Funds) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-417"><a href="#cb170-417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_input)</span>
<span id="cb170-418"><a href="#cb170-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-419"><a href="#cb170-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-422"><a href="#cb170-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-423"><a href="#cb170-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tfm-whitened-ccf</span></span>
<span id="cb170-424"><a href="#cb170-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-425"><a href="#cb170-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-426"><a href="#cb170-426" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Ottenere i residui (serie prewhitened)</span></span>
<span id="cb170-427"><a href="#cb170-427" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit_input)</span>
<span id="cb170-428"><a href="#cb170-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-429"><a href="#cb170-429" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrare l'output con lo stesso modello</span></span>
<span id="cb170-430"><a href="#cb170-430" aria-hidden="true" tabindex="-1"></a><span class="co"># Usiamo la stessa struttura ARMA dell'input</span></span>
<span id="cb170-431"><a href="#cb170-431" aria-hidden="true" tabindex="-1"></a>beta_t <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="fu">Arima</span>(output_y, <span class="at">model =</span> fit_input))</span>
<span id="cb170-432"><a href="#cb170-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-433"><a href="#cb170-433" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: CCF tra le serie prewhitened</span></span>
<span id="cb170-434"><a href="#cb170-434" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-435"><a href="#cb170-435" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(<span class="fu">as.numeric</span>(alpha_t), <span class="fu">as.numeric</span>(beta_t), <span class="at">lag.max =</span> <span class="dv">20</span>,</span>
<span id="cb170-436"><a href="#cb170-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF prewhitened: α(Fed Funds) e β(Disoccupazione)"</span>,</span>
<span id="cb170-437"><a href="#cb170-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb170-438"><a href="#cb170-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-439"><a href="#cb170-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Per confronto: CCF senza prewhitening</span></span>
<span id="cb170-440"><a href="#cb170-440" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(<span class="fu">as.numeric</span>(input_x), <span class="fu">as.numeric</span>(output_y), <span class="at">lag.max =</span> <span class="dv">20</span>,</span>
<span id="cb170-441"><a href="#cb170-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"CCF senza prewhitening: Δ(Fed Funds) e Δ(Disoccupazione)"</span>,</span>
<span id="cb170-442"><a href="#cb170-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"CCF"</span>)</span>
<span id="cb170-443"><a href="#cb170-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-444"><a href="#cb170-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-445"><a href="#cb170-445" aria-hidden="true" tabindex="-1"></a>La CCF dopo il prewhitening è più "pulita" e permette di identificare la struttura della funzione di trasferimento. Si noti che $\hat{\rho}_{\beta\alpha}(k) \approx 0$ per $k &lt; 0$ conferma la causalità del sistema (l'output non anticipa l'input).</span>
<span id="cb170-446"><a href="#cb170-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-449"><a href="#cb170-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-450"><a href="#cb170-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tfm-estimation</span></span>
<span id="cb170-451"><a href="#cb170-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-452"><a href="#cb170-452" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4-5: Stima del Transfer Function Model</span></span>
<span id="cb170-453"><a href="#cb170-453" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifichiamo il ritardo b e gli ordini (r,s) dalla CCF prewhitened</span></span>
<span id="cb170-454"><a href="#cb170-454" aria-hidden="true" tabindex="-1"></a><span class="co"># Usiamo dynlm per una stima semplificata del modello</span></span>
<span id="cb170-455"><a href="#cb170-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-456"><a href="#cb170-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Modello con lag dell'input</span></span>
<span id="cb170-457"><a href="#cb170-457" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb170-458"><a href="#cb170-458" aria-hidden="true" tabindex="-1"></a>dati_tfm <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(output_y, input_x)</span>
<span id="cb170-459"><a href="#cb170-459" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dati_tfm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"y"</span>, <span class="st">"x"</span>)</span>
<span id="cb170-460"><a href="#cb170-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-461"><a href="#cb170-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima con diversi lag</span></span>
<span id="cb170-462"><a href="#cb170-462" aria-hidden="true" tabindex="-1"></a>fit_tfm1 <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(y <span class="sc">~</span> <span class="fu">L</span>(x, <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">data =</span> dati_tfm)</span>
<span id="cb170-463"><a href="#cb170-463" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_tfm1)</span>
<span id="cb170-464"><a href="#cb170-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-465"><a href="#cb170-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-468"><a href="#cb170-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-469"><a href="#cb170-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tfm-diagnostics</span></span>
<span id="cb170-470"><a href="#cb170-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb170-471"><a href="#cb170-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-472"><a href="#cb170-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostica dei residui del TFM</span></span>
<span id="cb170-473"><a href="#cb170-473" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-474"><a href="#cb170-474" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"Residui TFM"</span>, <span class="at">ylab =</span> <span class="st">"Residui"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb170-475"><a href="#cb170-475" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"ACF Residui TFM"</span>)</span>
<span id="cb170-476"><a href="#cb170-476" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"PACF Residui TFM"</span>)</span>
<span id="cb170-477"><a href="#cb170-477" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">main =</span> <span class="st">"QQ-Plot Residui TFM"</span>)</span>
<span id="cb170-478"><a href="#cb170-478" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(fit_tfm1), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb170-479"><a href="#cb170-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-480"><a href="#cb170-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-481"><a href="#cb170-481" aria-hidden="true" tabindex="-1"></a>Se i residui mostrano autocorrelazione, la componente di disturbo $\eta_t$ necessita di un modello ARMA, che va stimato congiuntamente con la funzione di trasferimento.</span>
<span id="cb170-482"><a href="#cb170-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-483"><a href="#cb170-483" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelli VAR (MSDE_04)</span></span>
<span id="cb170-484"><a href="#cb170-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-485"><a href="#cb170-485" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fondamenti teorici</span></span>
<span id="cb170-486"><a href="#cb170-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-487"><a href="#cb170-487" aria-hidden="true" tabindex="-1"></a>I modelli VAR (Vector AutoRegressive) rappresentano uno degli strumenti più utilizzati in econometria per l'analisi congiunta di più serie storiche. A differenza dei modelli a equazioni simultanee strutturali, nei modelli VAR non è necessario specificare quali variabili sono endogene e quali esogene: tutte le variabili sono trattate come endogene. Questo è un vantaggio importante, poiché la classificazione endogeno/esogeno richiede restrizioni identificative basate su teoria economica che spesso è vaga nelle sue indicazioni.</span>
<span id="cb170-488"><a href="#cb170-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-489"><a href="#cb170-489" aria-hidden="true" tabindex="-1"></a>Un VAR(p) per un vettore $k$-dimensionale $\mathbf{y}_t$ è definito come:</span>
<span id="cb170-490"><a href="#cb170-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-491"><a href="#cb170-491" aria-hidden="true" tabindex="-1"></a>$$\mathbf{y}_t = \boldsymbol{\Phi}_0 + \boldsymbol{\Phi}_1 \mathbf{y}_{t-1} + \boldsymbol{\Phi}_2 \mathbf{y}_{t-2} + \ldots + \boldsymbol{\Phi}_p \mathbf{y}_{t-p} + \boldsymbol{\varepsilon}_t$$</span>
<span id="cb170-492"><a href="#cb170-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-493"><a href="#cb170-493" aria-hidden="true" tabindex="-1"></a>dove $\boldsymbol{\Phi}_0$ è un vettore di intercette $(k \times 1)$, $\boldsymbol{\Phi}_i$ sono matrici di coefficienti $(k \times k)$ e $\boldsymbol{\varepsilon}_t$ è un vettore di innovazioni con $E<span class="co">[</span><span class="ot">\boldsymbol{\varepsilon}_t</span><span class="co">]</span> = \mathbf{0}$ e $E<span class="co">[</span><span class="ot">\boldsymbol{\varepsilon}_t \boldsymbol{\varepsilon}_t'</span><span class="co">]</span> = \boldsymbol{\Sigma}$.</span>
<span id="cb170-494"><a href="#cb170-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-495"><a href="#cb170-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stabilità e stazionarietà</span></span>
<span id="cb170-496"><a href="#cb170-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-497"><a href="#cb170-497" aria-hidden="true" tabindex="-1"></a>La condizione di stabilità (stazionarietà) di un VAR(p) è legata alle radici dell'equazione caratteristica. Per un VAR(1), le condizioni equivalenti sono: gli autovalori di $\boldsymbol{\Phi}_1$ hanno modulo minore di 1, oppure le radici di $|\mathbf{I}_k - \boldsymbol{\Phi}_1 z| = 0$ hanno modulo maggiore di 1.</span>
<span id="cb170-498"><a href="#cb170-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-499"><a href="#cb170-499" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modelli impliciti per le componenti</span></span>
<span id="cb170-500"><a href="#cb170-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-501"><a href="#cb170-501" aria-hidden="true" tabindex="-1"></a>Un risultato importante è che ogni componente $y_{i,t}$ di un VAR(p) con $k$ variabili segue individualmente un modello ARMA con ordini massimi $(k, k-1)$. Questo mostra come il VAR catturi interdipendenze dinamiche che un approccio univariato non può cogliere.</span>
<span id="cb170-502"><a href="#cb170-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-503"><a href="#cb170-503" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selezione dell'ordine</span></span>
<span id="cb170-504"><a href="#cb170-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-505"><a href="#cb170-505" aria-hidden="true" tabindex="-1"></a>Tre criteri informativi comunemente usati per un VAR(m) sono:</span>
<span id="cb170-506"><a href="#cb170-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-507"><a href="#cb170-507" aria-hidden="true" tabindex="-1"></a>$$AIC(m) = \log|\hat{\boldsymbol{\Sigma}}_m| + \frac{2}{T}mk^2$$</span>
<span id="cb170-508"><a href="#cb170-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-509"><a href="#cb170-509" aria-hidden="true" tabindex="-1"></a>$$BIC(m) = \log|\hat{\boldsymbol{\Sigma}}_m| + \frac{\log(T)}{T}mk^2$$</span>
<span id="cb170-510"><a href="#cb170-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-511"><a href="#cb170-511" aria-hidden="true" tabindex="-1"></a>$$HQ(m) = \log|\hat{\boldsymbol{\Sigma}}_m| + \frac{2\log(\log(T))}{T}mk^2$$</span>
<span id="cb170-512"><a href="#cb170-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-513"><a href="#cb170-513" aria-hidden="true" tabindex="-1"></a>dove $\hat{\boldsymbol{\Sigma}}_m$ è la stima ML della matrice di covarianza dei residui e $mk^2$ è il numero di parametri. Il criterio FPE (Final Prediction Error) di Akaike è:</span>
<span id="cb170-514"><a href="#cb170-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-515"><a href="#cb170-515" aria-hidden="true" tabindex="-1"></a>$$FPE(m) = \left(\frac{T + km + 1}{T - km - 1}\right)^k \left|\frac{\boldsymbol{\varepsilon}_m'\boldsymbol{\varepsilon}_m}{T}\right|$$</span>
<span id="cb170-516"><a href="#cb170-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-517"><a href="#cb170-517" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stima del modello VAR</span></span>
<span id="cb170-518"><a href="#cb170-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-519"><a href="#cb170-519" aria-hidden="true" tabindex="-1"></a>Lavoriamo con tre variabili: produzione industriale, disoccupazione e CPI (in differenze logaritmiche dove appropriato per la stazionarietà).</span>
<span id="cb170-520"><a href="#cb170-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-523"><a href="#cb170-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-524"><a href="#cb170-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-preparation</span></span>
<span id="cb170-525"><a href="#cb170-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-526"><a href="#cb170-526" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparazione dati per il VAR</span></span>
<span id="cb170-527"><a href="#cb170-527" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizziamo le differenze per garantire stazionarietà</span></span>
<span id="cb170-528"><a href="#cb170-528" aria-hidden="true" tabindex="-1"></a>var_data <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(d_log_prod, d_disoc, d_log_cpi)</span>
<span id="cb170-529"><a href="#cb170-529" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(var_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D_LogProd"</span>, <span class="st">"D_Disoc"</span>, <span class="st">"D_LogCPI"</span>)</span>
<span id="cb170-530"><a href="#cb170-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-531"><a href="#cb170-531" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimuovere eventuali NA</span></span>
<span id="cb170-532"><a href="#cb170-532" aria-hidden="true" tabindex="-1"></a>var_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(var_data)</span>
<span id="cb170-533"><a href="#cb170-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-534"><a href="#cb170-534" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Dimensioni del dataset VAR: %d osservazioni x %d variabili</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb170-535"><a href="#cb170-535" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nrow</span>(var_data), <span class="fu">ncol</span>(var_data)))</span>
<span id="cb170-536"><a href="#cb170-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-537"><a href="#cb170-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-540"><a href="#cb170-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-541"><a href="#cb170-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-order-selection</span></span>
<span id="cb170-542"><a href="#cb170-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-543"><a href="#cb170-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezione dell'ordine del VAR</span></span>
<span id="cb170-544"><a href="#cb170-544" aria-hidden="true" tabindex="-1"></a>var_select <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(var_data, <span class="at">lag.max =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb170-545"><a href="#cb170-545" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_select<span class="sc">$</span>selection)</span>
<span id="cb170-546"><a href="#cb170-546" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Tabella completa dei criteri ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-547"><a href="#cb170-547" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(var_select<span class="sc">$</span>criteria[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="dv">4</span>))</span>
<span id="cb170-548"><a href="#cb170-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-549"><a href="#cb170-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-552"><a href="#cb170-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-553"><a href="#cb170-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-estimation</span></span>
<span id="cb170-554"><a href="#cb170-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-555"><a href="#cb170-555" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima del VAR con l'ordine suggerito dal BIC (più parsimonioso)</span></span>
<span id="cb170-556"><a href="#cb170-556" aria-hidden="true" tabindex="-1"></a>p_opt <span class="ot">&lt;-</span> var_select<span class="sc">$</span>selection[<span class="st">"SC(n)"</span>]  <span class="co"># BIC = SC (Schwarz Criterion)</span></span>
<span id="cb170-557"><a href="#cb170-557" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Ordine selezionato dal BIC: p = %d</span><span class="sc">\n</span><span class="st">"</span>, p_opt))</span>
<span id="cb170-558"><a href="#cb170-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-559"><a href="#cb170-559" aria-hidden="true" tabindex="-1"></a>fit_var <span class="ot">&lt;-</span> <span class="fu">VAR</span>(var_data, <span class="at">p =</span> p_opt, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb170-560"><a href="#cb170-560" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_var)</span>
<span id="cb170-561"><a href="#cb170-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-562"><a href="#cb170-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-565"><a href="#cb170-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-566"><a href="#cb170-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-stability</span></span>
<span id="cb170-567"><a href="#cb170-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb170-568"><a href="#cb170-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-569"><a href="#cb170-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifica stabilità: le radici inverse devono essere all'interno del cerchio unitario</span></span>
<span id="cb170-570"><a href="#cb170-570" aria-hidden="true" tabindex="-1"></a>roots_var <span class="ot">&lt;-</span> <span class="fu">roots</span>(fit_var)</span>
<span id="cb170-571"><a href="#cb170-571" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Radici inverse del polinomio caratteristico ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-572"><a href="#cb170-572" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(roots_var)</span>
<span id="cb170-573"><a href="#cb170-573" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tutte le radici &lt; 1? %s</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">ifelse</span>(<span class="fu">all</span>(roots_var <span class="sc">&lt;</span> <span class="dv">1</span>), <span class="st">"SÌ — VAR stabile"</span>, <span class="st">"NO"</span>)))</span>
<span id="cb170-574"><a href="#cb170-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-575"><a href="#cb170-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico delle radici</span></span>
<span id="cb170-576"><a href="#cb170-576" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_var, <span class="at">names =</span> <span class="fu">colnames</span>(var_data)[<span class="dv">1</span>])</span>
<span id="cb170-577"><a href="#cb170-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-578"><a href="#cb170-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-579"><a href="#cb170-579" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostica del VAR</span></span>
<span id="cb170-580"><a href="#cb170-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-583"><a href="#cb170-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-584"><a href="#cb170-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-diagnostics</span></span>
<span id="cb170-585"><a href="#cb170-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-586"><a href="#cb170-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Test sui residui</span></span>
<span id="cb170-587"><a href="#cb170-587" aria-hidden="true" tabindex="-1"></a><span class="co"># Portmanteau test (Ljung-Box multivariato)</span></span>
<span id="cb170-588"><a href="#cb170-588" aria-hidden="true" tabindex="-1"></a>serial_test <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(fit_var, <span class="at">lags.pt =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>)</span>
<span id="cb170-589"><a href="#cb170-589" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Portmanteau per autocorrelazione residua ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-590"><a href="#cb170-590" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(serial_test)</span>
<span id="cb170-591"><a href="#cb170-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-592"><a href="#cb170-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di normalità multivariata</span></span>
<span id="cb170-593"><a href="#cb170-593" aria-hidden="true" tabindex="-1"></a>norm_test <span class="ot">&lt;-</span> <span class="fu">normality.test</span>(fit_var, <span class="at">multivariate.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb170-594"><a href="#cb170-594" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Test di normalità multivariata ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-595"><a href="#cb170-595" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(norm_test)</span>
<span id="cb170-596"><a href="#cb170-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-597"><a href="#cb170-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-600"><a href="#cb170-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-601"><a href="#cb170-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-residual-plots</span></span>
<span id="cb170-602"><a href="#cb170-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-603"><a href="#cb170-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-604"><a href="#cb170-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafici dei residui</span></span>
<span id="cb170-605"><a href="#cb170-605" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-606"><a href="#cb170-606" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb170-607"><a href="#cb170-607" aria-hidden="true" tabindex="-1"></a>  res_i <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit_var)[, i]</span>
<span id="cb170-608"><a href="#cb170-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(res_i, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Residui —"</span>, <span class="fu">colnames</span>(var_data)[i]),</span>
<span id="cb170-609"><a href="#cb170-609" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Residui"</span>)</span>
<span id="cb170-610"><a href="#cb170-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(res_i, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"ACF Residui —"</span>, <span class="fu">colnames</span>(var_data)[i]))</span>
<span id="cb170-611"><a href="#cb170-611" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-612"><a href="#cb170-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-613"><a href="#cb170-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-614"><a href="#cb170-614" aria-hidden="true" tabindex="-1"></a><span class="fu">## Granger-Causalità</span></span>
<span id="cb170-615"><a href="#cb170-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-616"><a href="#cb170-616" aria-hidden="true" tabindex="-1"></a>La Granger-causalità valuta se i valori passati di una variabile $y_{1t}$ aiutano a prevedere un'altra variabile $y_{2t}$. Formalmente, $y_{1t}$ è Granger-causale per $y_{2t}$ se:</span>
<span id="cb170-617"><a href="#cb170-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-618"><a href="#cb170-618" aria-hidden="true" tabindex="-1"></a>$$\boldsymbol{\Sigma}_t(h|\Omega_t) &lt; \boldsymbol{\Sigma}_t(h|\Omega_t \setminus \{y_{1s}: s \leq t<span class="sc">\}</span>)$$</span>
<span id="cb170-619"><a href="#cb170-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-620"><a href="#cb170-620" aria-hidden="true" tabindex="-1"></a>cioè se il MSE di previsione migliora includendo l'informazione di $y_{1t}$. Il test si basa su un'ipotesi nulla di assenza di causalità (i coefficienti dei lag di $y_{1t}$ nell'equazione di $y_{2t}$ sono tutti zero) e si distribuisce come un $F$ sotto $H_0$.</span>
<span id="cb170-621"><a href="#cb170-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-622"><a href="#cb170-622" aria-hidden="true" tabindex="-1"></a>È importante sottolineare che il termine "causalità" è improprio: la Granger-causalità indica solo una correlazione tra il valore corrente di una variabile e i valori passati di un'altra, non una relazione causale in senso stretto.</span>
<span id="cb170-623"><a href="#cb170-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-626"><a href="#cb170-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-627"><a href="#cb170-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: granger-causality</span></span>
<span id="cb170-628"><a href="#cb170-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-629"><a href="#cb170-629" aria-hidden="true" tabindex="-1"></a><span class="co"># Test di Granger-causalità per tutte le coppie</span></span>
<span id="cb170-630"><a href="#cb170-630" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test di Granger-Causalità ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb170-631"><a href="#cb170-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-632"><a href="#cb170-632" aria-hidden="true" tabindex="-1"></a>nomi_var <span class="ot">&lt;-</span> <span class="fu">colnames</span>(var_data)</span>
<span id="cb170-633"><a href="#cb170-633" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb170-634"><a href="#cb170-634" aria-hidden="true" tabindex="-1"></a>  causa <span class="ot">&lt;-</span> <span class="fu">causality</span>(fit_var, <span class="at">cause =</span> nomi_var[i])</span>
<span id="cb170-635"><a href="#cb170-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"--- %s causa le altre variabili? ---</span><span class="sc">\n</span><span class="st">"</span>, nomi_var[i]))</span>
<span id="cb170-636"><a href="#cb170-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"F-statistica = %.3f, p-value = %.4f</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb170-637"><a href="#cb170-637" aria-hidden="true" tabindex="-1"></a>              causa<span class="sc">$</span>Granger<span class="sc">$</span>statistic, causa<span class="sc">$</span>Granger<span class="sc">$</span>p.value))</span>
<span id="cb170-638"><a href="#cb170-638" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-639"><a href="#cb170-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-640"><a href="#cb170-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-641"><a href="#cb170-641" aria-hidden="true" tabindex="-1"></a><span class="fu">## Funzioni di Risposta all'Impulso (IRF)</span></span>
<span id="cb170-642"><a href="#cb170-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-643"><a href="#cb170-643" aria-hidden="true" tabindex="-1"></a>Le impulse response functions tracciano la risposta delle variabili dipendenti nel VAR a shock unitari su ciascuna variabile. Per ottenerle, si esprime il VAR in forma VMA (Vector Moving Average). Per un VAR stabile, lo shock dovrebbe gradualmente esaurirsi.</span>
<span id="cb170-644"><a href="#cb170-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-645"><a href="#cb170-645" aria-hidden="true" tabindex="-1"></a>Per risolvere il problema della correlazione contemporanea tra gli errori delle diverse equazioni, si utilizza la decomposizione di Cholesky, che impone un ordinamento ricorsivo delle variabili. Questo ordinamento implica che la prima variabile non è influenzata contemporaneamente dalle altre, la seconda può essere influenzata solo dalla prima, e così via.</span>
<span id="cb170-646"><a href="#cb170-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-649"><a href="#cb170-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-650"><a href="#cb170-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: irf-analysis</span></span>
<span id="cb170-651"><a href="#cb170-651" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb170-652"><a href="#cb170-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-653"><a href="#cb170-653" aria-hidden="true" tabindex="-1"></a><span class="co"># IRF ortogonalizzate (Cholesky)</span></span>
<span id="cb170-654"><a href="#cb170-654" aria-hidden="true" tabindex="-1"></a>irf_result <span class="ot">&lt;-</span> <span class="fu">irf</span>(fit_var, <span class="at">impulse =</span> nomi_var, <span class="at">response =</span> nomi_var,</span>
<span id="cb170-655"><a href="#cb170-655" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n.ahead =</span> <span class="dv">24</span>, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">runs =</span> <span class="dv">500</span>)</span>
<span id="cb170-656"><a href="#cb170-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-657"><a href="#cb170-657" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafici</span></span>
<span id="cb170-658"><a href="#cb170-658" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-659"><a href="#cb170-659" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(irf_result)</span>
<span id="cb170-660"><a href="#cb170-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-661"><a href="#cb170-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-664"><a href="#cb170-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-665"><a href="#cb170-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: irf-selected</span></span>
<span id="cb170-666"><a href="#cb170-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-667"><a href="#cb170-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-668"><a href="#cb170-668" aria-hidden="true" tabindex="-1"></a><span class="co"># IRF selezionate: shock alla produzione -&gt; effetti su tutte le variabili</span></span>
<span id="cb170-669"><a href="#cb170-669" aria-hidden="true" tabindex="-1"></a>irf_prod <span class="ot">&lt;-</span> <span class="fu">irf</span>(fit_var, <span class="at">impulse =</span> <span class="st">"D_LogProd"</span>, <span class="at">response =</span> nomi_var,</span>
<span id="cb170-670"><a href="#cb170-670" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n.ahead =</span> <span class="dv">24</span>, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">runs =</span> <span class="dv">500</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb170-671"><a href="#cb170-671" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(irf_prod, <span class="at">main =</span> <span class="st">"IRF: Shock alla Produzione Industriale"</span>)</span>
<span id="cb170-672"><a href="#cb170-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-673"><a href="#cb170-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-674"><a href="#cb170-674" aria-hidden="true" tabindex="-1"></a>L'ordinamento delle variabili nel VAR influenza i risultati delle IRF ortogonalizzate. Come suggerito dalla teoria, è opportuno verificare la sensibilità dei risultati invertendo l'ordinamento. Quando i residui sono poco correlati tra equazioni, l'ordinamento ha poca influenza.</span>
<span id="cb170-675"><a href="#cb170-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-676"><a href="#cb170-676" aria-hidden="true" tabindex="-1"></a><span class="fu">## Decomposizione della Varianza (FEVD)</span></span>
<span id="cb170-677"><a href="#cb170-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-678"><a href="#cb170-678" aria-hidden="true" tabindex="-1"></a>La FEVD (Forecast Error Variance Decomposition) quantifica la proporzione della varianza dell'errore di previsione di ciascuna variabile attribuibile a shock provenienti da ciascuna delle variabili del sistema, a diversi orizzonti temporali.</span>
<span id="cb170-679"><a href="#cb170-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-682"><a href="#cb170-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-683"><a href="#cb170-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fevd-analysis</span></span>
<span id="cb170-684"><a href="#cb170-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-685"><a href="#cb170-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-686"><a href="#cb170-686" aria-hidden="true" tabindex="-1"></a><span class="co"># FEVD</span></span>
<span id="cb170-687"><a href="#cb170-687" aria-hidden="true" tabindex="-1"></a>fevd_result <span class="ot">&lt;-</span> <span class="fu">fevd</span>(fit_var, <span class="at">n.ahead =</span> <span class="dv">24</span>)</span>
<span id="cb170-688"><a href="#cb170-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-689"><a href="#cb170-689" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafici</span></span>
<span id="cb170-690"><a href="#cb170-690" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fevd_result)</span>
<span id="cb170-691"><a href="#cb170-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-692"><a href="#cb170-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-695"><a href="#cb170-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-696"><a href="#cb170-696" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fevd-table</span></span>
<span id="cb170-697"><a href="#cb170-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-698"><a href="#cb170-698" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabella FEVD a orizzonti selezionati</span></span>
<span id="cb170-699"><a href="#cb170-699" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== FEVD a 1, 6, 12, 24 mesi ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb170-700"><a href="#cb170-700" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var_name <span class="cf">in</span> nomi_var) {</span>
<span id="cb170-701"><a href="#cb170-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"--- Variabile: %s ---</span><span class="sc">\n</span><span class="st">"</span>, var_name))</span>
<span id="cb170-702"><a href="#cb170-702" aria-hidden="true" tabindex="-1"></a>  fevd_tab <span class="ot">&lt;-</span> fevd_result[[var_name]]</span>
<span id="cb170-703"><a href="#cb170-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(fevd_tab[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>), ], <span class="dv">4</span>))</span>
<span id="cb170-704"><a href="#cb170-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-705"><a href="#cb170-705" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-706"><a href="#cb170-706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-707"><a href="#cb170-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-708"><a href="#cb170-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## Previsione VAR</span></span>
<span id="cb170-709"><a href="#cb170-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-712"><a href="#cb170-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-713"><a href="#cb170-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: var-forecast</span></span>
<span id="cb170-714"><a href="#cb170-714" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-715"><a href="#cb170-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-716"><a href="#cb170-716" aria-hidden="true" tabindex="-1"></a><span class="co"># Previsione a 12 mesi</span></span>
<span id="cb170-717"><a href="#cb170-717" aria-hidden="true" tabindex="-1"></a>prev_var <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_var, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb170-718"><a href="#cb170-718" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prev_var)</span>
<span id="cb170-719"><a href="#cb170-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-720"><a href="#cb170-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-721"><a href="#cb170-721" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cointegrazione (MSDE_05)</span></span>
<span id="cb170-722"><a href="#cb170-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-723"><a href="#cb170-723" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fondamenti teorici</span></span>
<span id="cb170-724"><a href="#cb170-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-725"><a href="#cb170-725" aria-hidden="true" tabindex="-1"></a><span class="fu">### Integrazione e test di radice unitaria</span></span>
<span id="cb170-726"><a href="#cb170-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-727"><a href="#cb170-727" aria-hidden="true" tabindex="-1"></a>Una serie è integrata di ordine $d$, indicata come $I(d)$, se necessita di $d$ differenziazioni per diventare stazionaria. Per verificare la presenza di una radice unitaria si utilizza il test di Dickey-Fuller, basato sulla regressione:</span>
<span id="cb170-728"><a href="#cb170-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-729"><a href="#cb170-729" aria-hidden="true" tabindex="-1"></a>$$\Delta y_t = \alpha + \gamma t + \delta y_{t-1} + \varepsilon_t$$</span>
<span id="cb170-730"><a href="#cb170-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-731"><a href="#cb170-731" aria-hidden="true" tabindex="-1"></a>L'ipotesi nulla è $H_0: \delta = 0$ (presenza di radice unitaria). Se $\delta = 0$, la serie è $I(1)$ con trend stocastico; se $\delta &lt; 0$, la serie è stazionaria (eventualmente attorno a un trend). La statistica test segue una distribuzione non standard (distribuzione di Dickey-Fuller), con quantili spostati a sinistra rispetto alla normale.</span>
<span id="cb170-732"><a href="#cb170-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-733"><a href="#cb170-733" aria-hidden="true" tabindex="-1"></a>Il test ADF (Augmented Dickey-Fuller) estende il DF a strutture più complesse:</span>
<span id="cb170-734"><a href="#cb170-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-735"><a href="#cb170-735" aria-hidden="true" tabindex="-1"></a>$$\Delta y_t = \alpha + \gamma t + \delta y_{t-1} + \sum_{j=1}^{p} \beta_j \Delta y_{t-j} + \varepsilon_t$$</span>
<span id="cb170-736"><a href="#cb170-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-737"><a href="#cb170-737" aria-hidden="true" tabindex="-1"></a>La scelta del numero di lag $p$ è cruciale: troppo pochi lag non rimuovono l'autocorrelazione nei residui (bias nel test), troppi lag consumano gradi di libertà e riducono la potenza. Si può usare la procedura iterativa di Ng e Perron o criteri informativi.</span>
<span id="cb170-738"><a href="#cb170-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-739"><a href="#cb170-739" aria-hidden="true" tabindex="-1"></a>La procedura step-by-step prevede: (1) stimare il modello con intercetta e trend, testare $\delta = 0$; se si rifiuta, la serie è stazionaria; se non si rifiuta, (2) verificare la significatività del trend con test congiunti ($\phi_2$, $\phi_3$); (3) se il trend non è significativo, riestimare senza trend e ripetere il test.</span>
<span id="cb170-740"><a href="#cb170-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-743"><a href="#cb170-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-744"><a href="#cb170-744" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: unit-root-tests</span></span>
<span id="cb170-745"><a href="#cb170-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-746"><a href="#cb170-746" aria-hidden="true" tabindex="-1"></a><span class="co"># Test ADF per tutte le variabili in livelli e differenze</span></span>
<span id="cb170-747"><a href="#cb170-747" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=========================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-748"><a href="#cb170-748" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  TEST DI RADICE UNITARIA (ADF)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-749"><a href="#cb170-749" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=========================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb170-750"><a href="#cb170-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-751"><a href="#cb170-751" aria-hidden="true" tabindex="-1"></a>serie_test <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb170-752"><a href="#cb170-752" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(Produzione Industriale)"</span> <span class="ot">=</span> log_prod,</span>
<span id="cb170-753"><a href="#cb170-753" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(CPI)"</span> <span class="ot">=</span> log_cpi,</span>
<span id="cb170-754"><a href="#cb170-754" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Disoccupazione"</span> <span class="ot">=</span> disoc,</span>
<span id="cb170-755"><a href="#cb170-755" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Fed Funds"</span> <span class="ot">=</span> fed_funds,</span>
<span id="cb170-756"><a href="#cb170-756" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(Occupazione)"</span> <span class="ot">=</span> log_occupaz,</span>
<span id="cb170-757"><a href="#cb170-757" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log(Consumi)"</span> <span class="ot">=</span> log_consumi</span>
<span id="cb170-758"><a href="#cb170-758" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-759"><a href="#cb170-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-760"><a href="#cb170-760" aria-hidden="true" tabindex="-1"></a>risultati_adf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb170-761"><a href="#cb170-761" aria-hidden="true" tabindex="-1"></a>  <span class="at">Serie =</span> <span class="fu">character</span>(), </span>
<span id="cb170-762"><a href="#cb170-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">Livelli_tau =</span> <span class="fu">numeric</span>(), <span class="at">Livelli_pval =</span> <span class="fu">character</span>(),</span>
<span id="cb170-763"><a href="#cb170-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diff_tau =</span> <span class="fu">numeric</span>(), <span class="at">Diff_pval =</span> <span class="fu">character</span>(),</span>
<span id="cb170-764"><a href="#cb170-764" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ordine =</span> <span class="fu">character</span>(),</span>
<span id="cb170-765"><a href="#cb170-765" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb170-766"><a href="#cb170-766" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-767"><a href="#cb170-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-768"><a href="#cb170-768" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (nome <span class="cf">in</span> <span class="fu">names</span>(serie_test)) {</span>
<span id="cb170-769"><a href="#cb170-769" aria-hidden="true" tabindex="-1"></a>  serie <span class="ot">&lt;-</span> serie_test[[nome]]</span>
<span id="cb170-770"><a href="#cb170-770" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-771"><a href="#cb170-771" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test in livelli (con trend e intercetta)</span></span>
<span id="cb170-772"><a href="#cb170-772" aria-hidden="true" tabindex="-1"></a>  adf_lev <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(serie, <span class="at">type =</span> <span class="st">"trend"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb170-773"><a href="#cb170-773" aria-hidden="true" tabindex="-1"></a>  tau_lev <span class="ot">&lt;-</span> adf_lev<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"tau3"</span>]</span>
<span id="cb170-774"><a href="#cb170-774" aria-hidden="true" tabindex="-1"></a>  cv_lev <span class="ot">&lt;-</span> adf_lev<span class="sc">@</span>cval[<span class="dv">1</span>, ]</span>
<span id="cb170-775"><a href="#cb170-775" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-776"><a href="#cb170-776" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test in differenze (con intercetta)</span></span>
<span id="cb170-777"><a href="#cb170-777" aria-hidden="true" tabindex="-1"></a>  dserie <span class="ot">&lt;-</span> <span class="fu">diff</span>(serie)</span>
<span id="cb170-778"><a href="#cb170-778" aria-hidden="true" tabindex="-1"></a>  adf_diff <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(dserie, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb170-779"><a href="#cb170-779" aria-hidden="true" tabindex="-1"></a>  tau_diff <span class="ot">&lt;-</span> adf_diff<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"tau2"</span>]</span>
<span id="cb170-780"><a href="#cb170-780" aria-hidden="true" tabindex="-1"></a>  cv_diff <span class="ot">&lt;-</span> adf_diff<span class="sc">@</span>cval[<span class="dv">1</span>, ]</span>
<span id="cb170-781"><a href="#cb170-781" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-782"><a href="#cb170-782" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determinare significatività</span></span>
<span id="cb170-783"><a href="#cb170-783" aria-hidden="true" tabindex="-1"></a>  sig_lev <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tau_lev <span class="sc">&lt;</span> cv_lev[<span class="st">"5pct"</span>], <span class="st">"&lt; 0.05"</span>, <span class="st">"&gt; 0.05"</span>)</span>
<span id="cb170-784"><a href="#cb170-784" aria-hidden="true" tabindex="-1"></a>  sig_diff <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tau_diff <span class="sc">&lt;</span> cv_diff[<span class="st">"5pct"</span>], <span class="st">"&lt; 0.05"</span>, <span class="st">"&gt; 0.05"</span>)</span>
<span id="cb170-785"><a href="#cb170-785" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-786"><a href="#cb170-786" aria-hidden="true" tabindex="-1"></a>  ordine <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sig_lev <span class="sc">==</span> <span class="st">"&lt; 0.05"</span>, <span class="st">"I(0)"</span>,</span>
<span id="cb170-787"><a href="#cb170-787" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(sig_diff <span class="sc">==</span> <span class="st">"&lt; 0.05"</span>, <span class="st">"I(1)"</span>, <span class="st">"I(2)?"</span>))</span>
<span id="cb170-788"><a href="#cb170-788" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-789"><a href="#cb170-789" aria-hidden="true" tabindex="-1"></a>  risultati_adf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(risultati_adf, <span class="fu">data.frame</span>(</span>
<span id="cb170-790"><a href="#cb170-790" aria-hidden="true" tabindex="-1"></a>    <span class="at">Serie =</span> nome,</span>
<span id="cb170-791"><a href="#cb170-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">Livelli_tau =</span> <span class="fu">round</span>(tau_lev, <span class="dv">3</span>),</span>
<span id="cb170-792"><a href="#cb170-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">Livelli_pval =</span> sig_lev,</span>
<span id="cb170-793"><a href="#cb170-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diff_tau =</span> <span class="fu">round</span>(tau_diff, <span class="dv">3</span>),</span>
<span id="cb170-794"><a href="#cb170-794" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diff_pval =</span> sig_diff,</span>
<span id="cb170-795"><a href="#cb170-795" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ordine =</span> ordine,</span>
<span id="cb170-796"><a href="#cb170-796" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb170-797"><a href="#cb170-797" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb170-798"><a href="#cb170-798" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-799"><a href="#cb170-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"--- %s ---</span><span class="sc">\n</span><span class="st">"</span>, nome))</span>
<span id="cb170-800"><a href="#cb170-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Livelli: tau3 = %.3f (CV 5%%: %.3f) -&gt; %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb170-801"><a href="#cb170-801" aria-hidden="true" tabindex="-1"></a>              tau_lev, cv_lev[<span class="st">"5pct"</span>], sig_lev))</span>
<span id="cb170-802"><a href="#cb170-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Differenze: tau2 = %.3f (CV 5%%: %.3f) -&gt; %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb170-803"><a href="#cb170-803" aria-hidden="true" tabindex="-1"></a>              tau_diff, cv_diff[<span class="st">"5pct"</span>], sig_diff))</span>
<span id="cb170-804"><a href="#cb170-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  -&gt; Serie %s</span><span class="sc">\n\n</span><span class="st">"</span>, ordine))</span>
<span id="cb170-805"><a href="#cb170-805" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-806"><a href="#cb170-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-807"><a href="#cb170-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-810"><a href="#cb170-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-811"><a href="#cb170-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: unit-root-summary</span></span>
<span id="cb170-812"><a href="#cb170-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-813"><a href="#cb170-813" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(risultati_adf, </span>
<span id="cb170-814"><a href="#cb170-814" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Serie"</span>, <span class="st">"τ (livelli)"</span>, <span class="st">"p-value"</span>, </span>
<span id="cb170-815"><a href="#cb170-815" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"τ (diff)"</span>, <span class="st">"p-value"</span>, <span class="st">"Ordine I(d)"</span>),</span>
<span id="cb170-816"><a href="#cb170-816" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Risultati dei test ADF di radice unitaria"</span>)</span>
<span id="cb170-817"><a href="#cb170-817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-818"><a href="#cb170-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-819"><a href="#cb170-819" aria-hidden="true" tabindex="-1"></a><span class="fu">### Esempio dettagliato: procedura step-by-step per log(CPI)</span></span>
<span id="cb170-820"><a href="#cb170-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-823"><a href="#cb170-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-824"><a href="#cb170-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: adf-detailed</span></span>
<span id="cb170-825"><a href="#cb170-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-826"><a href="#cb170-826" aria-hidden="true" tabindex="-1"></a><span class="co"># Procedura completa per log(CPI) come nell'esempio del corso</span></span>
<span id="cb170-827"><a href="#cb170-827" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Procedura ADF step-by-step per log(CPI) ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb170-828"><a href="#cb170-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-829"><a href="#cb170-829" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Modello con trend e intercetta</span></span>
<span id="cb170-830"><a href="#cb170-830" aria-hidden="true" tabindex="-1"></a>adf_step1 <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(log_cpi, <span class="at">type =</span> <span class="st">"trend"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb170-831"><a href="#cb170-831" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Step 1: Modello con trend e intercetta</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-832"><a href="#cb170-832" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adf_step1)</span>
<span id="cb170-833"><a href="#cb170-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-834"><a href="#cb170-834" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Verificare se servono drift e trend (phi2, phi3)</span></span>
<span id="cb170-835"><a href="#cb170-835" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Step 2: Test congiunti</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-836"><a href="#cb170-836" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"tau3 = %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_step1<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"tau3"</span>]))</span>
<span id="cb170-837"><a href="#cb170-837" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"phi2 (H0: delta=alpha=gamma=0) = %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_step1<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"phi2"</span>]))</span>
<span id="cb170-838"><a href="#cb170-838" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"phi3 (H0: delta=gamma=0) = %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_step1<span class="sc">@</span>teststat[<span class="dv">1</span>, <span class="st">"phi3"</span>]))</span>
<span id="cb170-839"><a href="#cb170-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-840"><a href="#cb170-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-841"><a href="#cb170-841" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cointegrazione</span></span>
<span id="cb170-842"><a href="#cb170-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-843"><a href="#cb170-843" aria-hidden="true" tabindex="-1"></a><span class="fu">### Concetto</span></span>
<span id="cb170-844"><a href="#cb170-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-845"><a href="#cb170-845" aria-hidden="true" tabindex="-1"></a>Un insieme di variabili $I(1)$ è cointegrato se esiste una combinazione lineare $\boldsymbol{\beta}'\mathbf{y}_t$ che è $I(0)$. Il vettore $\boldsymbol{\beta}$ è detto vettore di cointegrazione e rappresenta una relazione di equilibrio di lungo periodo. Deviazioni dall'equilibrio sono temporanee: le forze di mercato riportano il sistema verso l'equilibrio.</span>
<span id="cb170-846"><a href="#cb170-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-847"><a href="#cb170-847" aria-hidden="true" tabindex="-1"></a><span class="fu">### Procedura di Engle-Granger</span></span>
<span id="cb170-848"><a href="#cb170-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-849"><a href="#cb170-849" aria-hidden="true" tabindex="-1"></a>La procedura si articola in tre passi:</span>
<span id="cb170-850"><a href="#cb170-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-851"><a href="#cb170-851" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Verificare che tutte le variabili siano $I(1)$ (condizione necessaria per la cointegrazione)</span>
<span id="cb170-852"><a href="#cb170-852" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Stimare la relazione di cointegrazione con OLS: $y_{1,t} = \beta_2 y_{2,t} + \ldots + \beta_k y_{k,t} + \varepsilon_t$</span>
<span id="cb170-853"><a href="#cb170-853" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Testare la stazionarietà dei residui $\hat{\varepsilon}_t$ con un test ADF, usando valori critici specifici (Engle-Yoo / MacKinnon) che tengono conto del fatto che $\hat{\boldsymbol{\beta}}$ è stimato</span>
<span id="cb170-854"><a href="#cb170-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-855"><a href="#cb170-855" aria-hidden="true" tabindex="-1"></a>Se i residui sono $I(0)$, le variabili sono cointegrate. I valori critici sono più stringenti rispetto al test ADF standard, perché per costruzione l'OLS minimizza la varianza dei residui, rendendoli "più stazionari" anche in assenza di vera cointegrazione.</span>
<span id="cb170-856"><a href="#cb170-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-857"><a href="#cb170-857" aria-hidden="true" tabindex="-1"></a>Sotto cointegrazione, si stima poi il modello a correzione dell'errore (ECM):</span>
<span id="cb170-858"><a href="#cb170-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-859"><a href="#cb170-859" aria-hidden="true" tabindex="-1"></a>$$\Delta y_t = \beta_0 \Delta x_t + \tilde{\alpha}(\hat{\varepsilon}_{t-1}) + \eta_t$$</span>
<span id="cb170-860"><a href="#cb170-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-861"><a href="#cb170-861" aria-hidden="true" tabindex="-1"></a>dove $\tilde{\alpha}$ è la velocità di aggiustamento verso l'equilibrio (deve essere negativo per avere convergenza).</span>
<span id="cb170-862"><a href="#cb170-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-865"><a href="#cb170-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-866"><a href="#cb170-866" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: engle-granger</span></span>
<span id="cb170-867"><a href="#cb170-867" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-868"><a href="#cb170-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-869"><a href="#cb170-869" aria-hidden="true" tabindex="-1"></a><span class="co"># Procedura di Engle-Granger</span></span>
<span id="cb170-870"><a href="#cb170-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezioniamo le variabili I(1): log(Prod), log(CPI), log(Occupazione), log(Consumi)</span></span>
<span id="cb170-871"><a href="#cb170-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-872"><a href="#cb170-872" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Regressione di cointegrazione (OLS)</span></span>
<span id="cb170-873"><a href="#cb170-873" aria-hidden="true" tabindex="-1"></a><span class="co"># log(Consumi) = f(log(Produzione), log(CPI))</span></span>
<span id="cb170-874"><a href="#cb170-874" aria-hidden="true" tabindex="-1"></a>coint_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_consumi <span class="sc">~</span> log_prod <span class="sc">+</span> log_cpi)</span>
<span id="cb170-875"><a href="#cb170-875" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(coint_reg)</span>
<span id="cb170-876"><a href="#cb170-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-877"><a href="#cb170-877" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Estrarre i residui e testarli per radice unitaria</span></span>
<span id="cb170-878"><a href="#cb170-878" aria-hidden="true" tabindex="-1"></a>residui_coint <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(coint_reg), <span class="at">start =</span> <span class="fu">start</span>(log_consumi), </span>
<span id="cb170-879"><a href="#cb170-879" aria-hidden="true" tabindex="-1"></a>                    <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb170-880"><a href="#cb170-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-881"><a href="#cb170-881" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb170-882"><a href="#cb170-882" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residui_coint, <span class="at">main =</span> <span class="st">"Residui di cointegrazione"</span>, <span class="at">ylab =</span> <span class="st">"Residui"</span>)</span>
<span id="cb170-883"><a href="#cb170-883" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb170-884"><a href="#cb170-884" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(residui_coint, <span class="at">main =</span> <span class="st">"ACF residui di cointegrazione"</span>)</span>
<span id="cb170-885"><a href="#cb170-885" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(residui_coint, <span class="at">main =</span> <span class="st">"PACF residui di cointegrazione"</span>)</span>
<span id="cb170-886"><a href="#cb170-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-887"><a href="#cb170-887" aria-hidden="true" tabindex="-1"></a><span class="co"># Test ADF sui residui (valori critici Engle-Granger)</span></span>
<span id="cb170-888"><a href="#cb170-888" aria-hidden="true" tabindex="-1"></a>adf_coint <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(residui_coint, <span class="at">type =</span> <span class="st">"none"</span>, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb170-889"><a href="#cb170-889" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Test ADF sui residui di cointegrazione ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-890"><a href="#cb170-890" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adf_coint)</span>
<span id="cb170-891"><a href="#cb170-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-892"><a href="#cb170-892" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Nota: I valori critici per il test di Engle-Granger con 3 variabili I(1)"</span>)</span>
<span id="cb170-893"><a href="#cb170-893" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">sono più stringenti dei DF standard:"</span>)</span>
<span id="cb170-894"><a href="#cb170-894" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">1%: -3.96, 5%: -3.41, 10%: -3.13 (con intercetta)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-895"><a href="#cb170-895" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Statistica tau: %.3f</span><span class="sc">\n</span><span class="st">"</span>, adf_coint<span class="sc">@</span>teststat[<span class="dv">1</span>]))</span>
<span id="cb170-896"><a href="#cb170-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-897"><a href="#cb170-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-900"><a href="#cb170-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-901"><a href="#cb170-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ecm-estimation</span></span>
<span id="cb170-902"><a href="#cb170-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-903"><a href="#cb170-903" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Stima del modello ECM (Error Correction Model)</span></span>
<span id="cb170-904"><a href="#cb170-904" aria-hidden="true" tabindex="-1"></a><span class="co"># Se c'è cointegrazione, stimiamo l'ECM</span></span>
<span id="cb170-905"><a href="#cb170-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-906"><a href="#cb170-906" aria-hidden="true" tabindex="-1"></a>d_log_consumi <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_consumi)</span>
<span id="cb170-907"><a href="#cb170-907" aria-hidden="true" tabindex="-1"></a>d_log_prod_c  <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_prod)</span>
<span id="cb170-908"><a href="#cb170-908" aria-hidden="true" tabindex="-1"></a>d_log_cpi_c   <span class="ot">&lt;-</span> <span class="fu">diff</span>(log_cpi)</span>
<span id="cb170-909"><a href="#cb170-909" aria-hidden="true" tabindex="-1"></a>ect <span class="ot">&lt;-</span> residui_coint[<span class="sc">-</span><span class="fu">length</span>(residui_coint)]  <span class="co"># ECT ritardato di 1</span></span>
<span id="cb170-910"><a href="#cb170-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-911"><a href="#cb170-911" aria-hidden="true" tabindex="-1"></a><span class="co"># Allineare le lunghezze</span></span>
<span id="cb170-912"><a href="#cb170-912" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">length</span>(d_log_consumi), <span class="fu">length</span>(d_log_prod_c), </span>
<span id="cb170-913"><a href="#cb170-913" aria-hidden="true" tabindex="-1"></a>         <span class="fu">length</span>(d_log_cpi_c), <span class="fu">length</span>(ect))</span>
<span id="cb170-914"><a href="#cb170-914" aria-hidden="true" tabindex="-1"></a>dati_ecm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb170-915"><a href="#cb170-915" aria-hidden="true" tabindex="-1"></a>  <span class="at">dy =</span> <span class="fu">tail</span>(d_log_consumi, n),</span>
<span id="cb170-916"><a href="#cb170-916" aria-hidden="true" tabindex="-1"></a>  <span class="at">dx1 =</span> <span class="fu">tail</span>(d_log_prod_c, n),</span>
<span id="cb170-917"><a href="#cb170-917" aria-hidden="true" tabindex="-1"></a>  <span class="at">dx2 =</span> <span class="fu">tail</span>(d_log_cpi_c, n),</span>
<span id="cb170-918"><a href="#cb170-918" aria-hidden="true" tabindex="-1"></a>  <span class="at">ect_lag =</span> <span class="fu">tail</span>(ect, n)</span>
<span id="cb170-919"><a href="#cb170-919" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-920"><a href="#cb170-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-921"><a href="#cb170-921" aria-hidden="true" tabindex="-1"></a>fit_ecm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dy <span class="sc">~</span> dx1 <span class="sc">+</span> dx2 <span class="sc">+</span> ect_lag, <span class="at">data =</span> dati_ecm)</span>
<span id="cb170-922"><a href="#cb170-922" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Modello a Correzione dell'Errore (ECM) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-923"><a href="#cb170-923" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_ecm)</span>
<span id="cb170-924"><a href="#cb170-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-925"><a href="#cb170-925" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coeff. ECT (velocità di aggiustamento): %.4f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">coef</span>(fit_ecm)[<span class="st">"ect_lag"</span>]))</span>
<span id="cb170-926"><a href="#cb170-926" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Un valore negativo e significativo indica convergenza verso l'equilibrio.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-927"><a href="#cb170-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-928"><a href="#cb170-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-929"><a href="#cb170-929" aria-hidden="true" tabindex="-1"></a><span class="fu">### Procedura di Johansen</span></span>
<span id="cb170-930"><a href="#cb170-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-931"><a href="#cb170-931" aria-hidden="true" tabindex="-1"></a>La procedura di Johansen è più generale della Engle-Granger: permette di testare il rango di cointegrazione $r$ e stimare molteplici relazioni di cointegrazione in un contesto VECM (Vector Error Correction Model):</span>
<span id="cb170-932"><a href="#cb170-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-933"><a href="#cb170-933" aria-hidden="true" tabindex="-1"></a>$$\Delta \mathbf{y}_t = \boldsymbol{\Pi} \mathbf{y}_{t-1} + \sum_{i=1}^{k-1} \boldsymbol{\Gamma}_i \Delta \mathbf{y}_{t-i} + \mathbf{u}_t$$</span>
<span id="cb170-934"><a href="#cb170-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-935"><a href="#cb170-935" aria-hidden="true" tabindex="-1"></a>dove $\boldsymbol{\Pi} = \boldsymbol{\alpha}\boldsymbol{\beta}'$, con $\boldsymbol{\beta}$ matrice dei vettori di cointegrazione e $\boldsymbol{\alpha}$ matrice dei coefficienti di aggiustamento (loading).</span>
<span id="cb170-936"><a href="#cb170-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-937"><a href="#cb170-937" aria-hidden="true" tabindex="-1"></a>Il test si basa sull'esame del rango della matrice $\boldsymbol{\Pi}$ attraverso i suoi autovalori $\hat{\lambda}_1 \geq \hat{\lambda}_2 \geq \ldots \geq \hat{\lambda}_g$. Le due statistiche test sono:</span>
<span id="cb170-938"><a href="#cb170-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-939"><a href="#cb170-939" aria-hidden="true" tabindex="-1"></a>$$\lambda_{trace}(r) = -T \sum_{i=r+1}^{g} \ln(1 - \hat{\lambda}_i)$$</span>
<span id="cb170-940"><a href="#cb170-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-941"><a href="#cb170-941" aria-hidden="true" tabindex="-1"></a>$$\lambda_{max}(r, r+1) = -T \ln(1 - \hat{\lambda}_{r+1})$$</span>
<span id="cb170-942"><a href="#cb170-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-943"><a href="#cb170-943" aria-hidden="true" tabindex="-1"></a>Se $\boldsymbol{\Pi}$ ha rango zero, non c'è cointegrazione. Se ha rango pieno $g$, le variabili sono stazionarie. Se ha rango $r$ con $0 &lt; r &lt; g$, esistono $r$ relazioni di cointegrazione.</span>
<span id="cb170-944"><a href="#cb170-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-947"><a href="#cb170-947" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-948"><a href="#cb170-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: johansen-test</span></span>
<span id="cb170-949"><a href="#cb170-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-950"><a href="#cb170-950" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparazione dati per Johansen</span></span>
<span id="cb170-951"><a href="#cb170-951" aria-hidden="true" tabindex="-1"></a><span class="co"># Usiamo le variabili in livelli (log)</span></span>
<span id="cb170-952"><a href="#cb170-952" aria-hidden="true" tabindex="-1"></a>johansen_data <span class="ot">&lt;-</span> <span class="fu">ts.union</span>(log_consumi, log_prod, log_cpi)</span>
<span id="cb170-953"><a href="#cb170-953" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(johansen_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"log_Consumi"</span>, <span class="st">"log_Prod"</span>, <span class="st">"log_CPI"</span>)</span>
<span id="cb170-954"><a href="#cb170-954" aria-hidden="true" tabindex="-1"></a>johansen_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(johansen_data)</span>
<span id="cb170-955"><a href="#cb170-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-956"><a href="#cb170-956" aria-hidden="true" tabindex="-1"></a><span class="co"># Selezione del lag ottimale per il VECM</span></span>
<span id="cb170-957"><a href="#cb170-957" aria-hidden="true" tabindex="-1"></a><span class="co"># Il VECM con k lag corrisponde a un VAR con k+1 lag</span></span>
<span id="cb170-958"><a href="#cb170-958" aria-hidden="true" tabindex="-1"></a>var_select_j <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(johansen_data, <span class="at">lag.max =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb170-959"><a href="#cb170-959" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Selezione ordine per il VECM ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-960"><a href="#cb170-960" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_select_j<span class="sc">$</span>selection)</span>
<span id="cb170-961"><a href="#cb170-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-962"><a href="#cb170-962" aria-hidden="true" tabindex="-1"></a>k_vecm <span class="ot">&lt;-</span> var_select_j<span class="sc">$</span>selection[<span class="st">"SC(n)"</span>]  <span class="co"># BIC</span></span>
<span id="cb170-963"><a href="#cb170-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-964"><a href="#cb170-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-967"><a href="#cb170-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-968"><a href="#cb170-968" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: johansen-trace</span></span>
<span id="cb170-969"><a href="#cb170-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-970"><a href="#cb170-970" aria-hidden="true" tabindex="-1"></a><span class="co"># Test trace di Johansen</span></span>
<span id="cb170-971"><a href="#cb170-971" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Trace di Johansen ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-972"><a href="#cb170-972" aria-hidden="true" tabindex="-1"></a>jo_trace <span class="ot">&lt;-</span> <span class="fu">ca.jo</span>(johansen_data, <span class="at">type =</span> <span class="st">"trace"</span>, <span class="at">ecdet =</span> <span class="st">"const"</span>, <span class="at">K =</span> k_vecm)</span>
<span id="cb170-973"><a href="#cb170-973" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jo_trace)</span>
<span id="cb170-974"><a href="#cb170-974" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-975"><a href="#cb170-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-978"><a href="#cb170-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-979"><a href="#cb170-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: johansen-eigen</span></span>
<span id="cb170-980"><a href="#cb170-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-981"><a href="#cb170-981" aria-hidden="true" tabindex="-1"></a><span class="co"># Test max eigenvalue di Johansen</span></span>
<span id="cb170-982"><a href="#cb170-982" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Max Eigenvalue di Johansen ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-983"><a href="#cb170-983" aria-hidden="true" tabindex="-1"></a>jo_eigen <span class="ot">&lt;-</span> <span class="fu">ca.jo</span>(johansen_data, <span class="at">type =</span> <span class="st">"eigen"</span>, <span class="at">ecdet =</span> <span class="st">"const"</span>, <span class="at">K =</span> k_vecm)</span>
<span id="cb170-984"><a href="#cb170-984" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jo_eigen)</span>
<span id="cb170-985"><a href="#cb170-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-986"><a href="#cb170-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-989"><a href="#cb170-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-990"><a href="#cb170-990" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vecm-estimation</span></span>
<span id="cb170-991"><a href="#cb170-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-992"><a href="#cb170-992" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima del VECM con il rango di cointegrazione identificato</span></span>
<span id="cb170-993"><a href="#cb170-993" aria-hidden="true" tabindex="-1"></a><span class="co"># Supponiamo r = 1 (da verificare con i risultati dei test sopra)</span></span>
<span id="cb170-994"><a href="#cb170-994" aria-hidden="true" tabindex="-1"></a><span class="co"># Se i test indicano r diverso, modificare di conseguenza</span></span>
<span id="cb170-995"><a href="#cb170-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-996"><a href="#cb170-996" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Stima del VECM ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-997"><a href="#cb170-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-998"><a href="#cb170-998" aria-hidden="true" tabindex="-1"></a><span class="co"># Determiniamo il rango dai risultati del test</span></span>
<span id="cb170-999"><a href="#cb170-999" aria-hidden="true" tabindex="-1"></a><span class="co"># (il rango è il numero di ipotesi H0 rifiutate in sequenza)</span></span>
<span id="cb170-1000"><a href="#cb170-1000" aria-hidden="true" tabindex="-1"></a>vecm <span class="ot">&lt;-</span> <span class="fu">cajorls</span>(jo_trace, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb170-1001"><a href="#cb170-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1002"><a href="#cb170-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Vettore di cointegrazione (beta normalizzato) ---</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-1003"><a href="#cb170-1003" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vecm<span class="sc">$</span>beta)</span>
<span id="cb170-1004"><a href="#cb170-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1005"><a href="#cb170-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Coefficienti di aggiustamento (alpha) ---</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-1006"><a href="#cb170-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vecm<span class="sc">$</span>rlm<span class="sc">$</span>coefficients[<span class="dv">1</span>, ])</span>
<span id="cb170-1007"><a href="#cb170-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1008"><a href="#cb170-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1011"><a href="#cb170-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1012"><a href="#cb170-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vecm-to-var</span></span>
<span id="cb170-1013"><a href="#cb170-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1014"><a href="#cb170-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversione VECM -&gt; VAR per previsioni e diagnostica</span></span>
<span id="cb170-1015"><a href="#cb170-1015" aria-hidden="true" tabindex="-1"></a>vecm_var <span class="ot">&lt;-</span> <span class="fu">vec2var</span>(jo_trace, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb170-1016"><a href="#cb170-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1017"><a href="#cb170-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostica</span></span>
<span id="cb170-1018"><a href="#cb170-1018" aria-hidden="true" tabindex="-1"></a>serial_vecm <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(vecm_var, <span class="at">lags.pt =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>)</span>
<span id="cb170-1019"><a href="#cb170-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Test Portmanteau su residui VECM ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-1020"><a href="#cb170-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(serial_vecm)</span>
<span id="cb170-1021"><a href="#cb170-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1022"><a href="#cb170-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1025"><a href="#cb170-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1026"><a href="#cb170-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vecm-forecast</span></span>
<span id="cb170-1027"><a href="#cb170-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb170-1028"><a href="#cb170-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1029"><a href="#cb170-1029" aria-hidden="true" tabindex="-1"></a><span class="co"># Previsione dal VECM</span></span>
<span id="cb170-1030"><a href="#cb170-1030" aria-hidden="true" tabindex="-1"></a>prev_vecm <span class="ot">&lt;-</span> <span class="fu">predict</span>(vecm_var, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb170-1031"><a href="#cb170-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prev_vecm)</span>
<span id="cb170-1032"><a href="#cb170-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1033"><a href="#cb170-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1034"><a href="#cb170-1034" aria-hidden="true" tabindex="-1"></a><span class="fu"># Confronto tra Modelli e Selezione Finale</span></span>
<span id="cb170-1035"><a href="#cb170-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1036"><a href="#cb170-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">## Riepilogo dei modelli stimati</span></span>
<span id="cb170-1037"><a href="#cb170-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1038"><a href="#cb170-1038" aria-hidden="true" tabindex="-1"></a>In questo progetto sono stati stimati diversi modelli per analizzare le serie macroeconomiche USA:</span>
<span id="cb170-1039"><a href="#cb170-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1040"><a href="#cb170-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**ARIMA univariato**: modello per la singola serie (produzione industriale), cattura la dinamica temporale individuale inclusa la stagionalità.</span>
<span id="cb170-1041"><a href="#cb170-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Transfer Function Model**: relazione unidirezionale input-output tra Fed Funds e disoccupazione, con prewhitening per eliminare la contaminazione dell'autocorrelazione dell'input.</span>
<span id="cb170-1042"><a href="#cb170-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**VAR**: modello multivariato simmetrico per produzione, disoccupazione e CPI, che tratta tutte le variabili come endogene.</span>
<span id="cb170-1043"><a href="#cb170-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**VECM**: modello a correzione dell'errore per consumi, produzione e CPI, che incorpora le relazioni di equilibrio di lungo periodo.</span>
<span id="cb170-1044"><a href="#cb170-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1045"><a href="#cb170-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confronto quantitativo</span></span>
<span id="cb170-1046"><a href="#cb170-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1049"><a href="#cb170-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1050"><a href="#cb170-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model-comparison</span></span>
<span id="cb170-1051"><a href="#cb170-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1052"><a href="#cb170-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># Confronto basato sulla previsione in-sample e criteri informativi</span></span>
<span id="cb170-1053"><a href="#cb170-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== CONFRONTO TRA MODELLI ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb170-1054"><a href="#cb170-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1055"><a href="#cb170-1055" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. ARIMA</span></span>
<span id="cb170-1056"><a href="#cb170-1056" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. ARIMA univariato (Produzione Industriale)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-1057"><a href="#cb170-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   AIC = %.2f, BIC = %.2f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">AIC</span>(best_arima), <span class="fu">BIC</span>(best_arima)))</span>
<span id="cb170-1058"><a href="#cb170-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   σ² residui = %.6f</span><span class="sc">\n</span><span class="st">"</span>, best_arima<span class="sc">$</span>sigma2))</span>
<span id="cb170-1059"><a href="#cb170-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1060"><a href="#cb170-1060" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. VAR</span></span>
<span id="cb170-1061"><a href="#cb170-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. VAR multivariato</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb170-1062"><a href="#cb170-1062" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb170-1063"><a href="#cb170-1063" aria-hidden="true" tabindex="-1"></a>  eq_name <span class="ot">&lt;-</span> <span class="fu">names</span>(fit_var<span class="sc">$</span>varresult)[i]</span>
<span id="cb170-1064"><a href="#cb170-1064" aria-hidden="true" tabindex="-1"></a>  aic_i <span class="ot">&lt;-</span> <span class="fu">AIC</span>(fit_var<span class="sc">$</span>varresult[[i]])</span>
<span id="cb170-1065"><a href="#cb170-1065" aria-hidden="true" tabindex="-1"></a>  bic_i <span class="ot">&lt;-</span> <span class="fu">BIC</span>(fit_var<span class="sc">$</span>varresult[[i]])</span>
<span id="cb170-1066"><a href="#cb170-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   Eq. %s: AIC = %.2f, BIC = %.2f</span><span class="sc">\n</span><span class="st">"</span>, eq_name, aic_i, bic_i))</span>
<span id="cb170-1067"><a href="#cb170-1067" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-1068"><a href="#cb170-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1069"><a href="#cb170-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Confronto previsivo: RMSE in-sample per la produzione industriale</span></span>
<span id="cb170-1070"><a href="#cb170-1070" aria-hidden="true" tabindex="-1"></a>rmse_arima <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(best_arima)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb170-1071"><a href="#cb170-1071" aria-hidden="true" tabindex="-1"></a>rmse_var   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(fit_var)[, <span class="st">"D_LogProd"</span>]<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb170-1072"><a href="#cb170-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1073"><a href="#cb170-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- RMSE in-sample per Δlog(Prod) ---</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb170-1074"><a href="#cb170-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   ARIMA: %.6f</span><span class="sc">\n</span><span class="st">"</span>, rmse_arima))</span>
<span id="cb170-1075"><a href="#cb170-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   VAR:   %.6f</span><span class="sc">\n</span><span class="st">"</span>, rmse_var))</span>
<span id="cb170-1076"><a href="#cb170-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1077"><a href="#cb170-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1078"><a href="#cb170-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confronto qualitativo: differenze tra i modelli</span></span>
<span id="cb170-1079"><a href="#cb170-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1082"><a href="#cb170-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1083"><a href="#cb170-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: comparison-table</span></span>
<span id="cb170-1084"><a href="#cb170-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1085"><a href="#cb170-1085" aria-hidden="true" tabindex="-1"></a>confronto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb170-1086"><a href="#cb170-1086" aria-hidden="true" tabindex="-1"></a>  <span class="at">Criterio =</span> <span class="fu">c</span>(<span class="st">"N. variabili"</span>, <span class="st">"Relazioni dinamiche"</span>, </span>
<span id="cb170-1087"><a href="#cb170-1087" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Relazioni di lungo periodo"</span>, <span class="st">"Direzione causalità"</span>,</span>
<span id="cb170-1088"><a href="#cb170-1088" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Stagionalità"</span>, <span class="st">"Previsione"</span>,</span>
<span id="cb170-1089"><a href="#cb170-1089" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Interpretabilità"</span>, <span class="st">"N. parametri"</span>),</span>
<span id="cb170-1090"><a href="#cb170-1090" aria-hidden="true" tabindex="-1"></a>  <span class="at">ARIMA =</span> <span class="fu">c</span>(<span class="st">"1 (univariato)"</span>, <span class="st">"Solo autocorrelazione"</span>, </span>
<span id="cb170-1091"><a href="#cb170-1091" aria-hidden="true" tabindex="-1"></a>            <span class="st">"No (stazionario/differenziato)"</span>, <span class="st">"N/A"</span>,</span>
<span id="cb170-1092"><a href="#cb170-1092" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Sì (SARIMA)"</span>, <span class="st">"Solo variabile target"</span>,</span>
<span id="cb170-1093"><a href="#cb170-1093" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Alta"</span>, <span class="st">"Basso"</span>),</span>
<span id="cb170-1094"><a href="#cb170-1094" aria-hidden="true" tabindex="-1"></a>  <span class="at">TFM =</span> <span class="fu">c</span>(<span class="st">"2 (input-output)"</span>, <span class="st">"Unidirezionale"</span>,</span>
<span id="cb170-1095"><a href="#cb170-1095" aria-hidden="true" tabindex="-1"></a>          <span class="st">"No"</span>, <span class="st">"Imposta dal ricercatore"</span>,</span>
<span id="cb170-1096"><a href="#cb170-1096" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Possibile"</span>, <span class="st">"Solo variabile output"</span>,</span>
<span id="cb170-1097"><a href="#cb170-1097" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Media"</span>, <span class="st">"Medio"</span>),</span>
<span id="cb170-1098"><a href="#cb170-1098" aria-hidden="true" tabindex="-1"></a>  <span class="at">VAR =</span> <span class="fu">c</span>(<span class="st">"k (tutte endogene)"</span>, <span class="st">"Bidirezionali/multilaterali"</span>,</span>
<span id="cb170-1099"><a href="#cb170-1099" aria-hidden="true" tabindex="-1"></a>          <span class="st">"No (serie stazionarie)"</span>, <span class="st">"Testata (Granger)"</span>,</span>
<span id="cb170-1100"><a href="#cb170-1100" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Possibile"</span>, <span class="st">"Tutte le variabili"</span>,</span>
<span id="cb170-1101"><a href="#cb170-1101" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Media (IRF, FEVD)"</span>, <span class="st">"Alto (k²p)"</span>),</span>
<span id="cb170-1102"><a href="#cb170-1102" aria-hidden="true" tabindex="-1"></a>  <span class="at">VECM =</span> <span class="fu">c</span>(<span class="st">"k (tutte endogene)"</span>, <span class="st">"Bidirezionali + equilibrio"</span>,</span>
<span id="cb170-1103"><a href="#cb170-1103" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Sì (cointegrazione)"</span>, <span class="st">"Testata + ECT"</span>,</span>
<span id="cb170-1104"><a href="#cb170-1104" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Possibile"</span>, <span class="st">"Tutte + convergenza LR"</span>,</span>
<span id="cb170-1105"><a href="#cb170-1105" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Alta (relaz. economiche)"</span>, <span class="st">"Alto"</span>)</span>
<span id="cb170-1106"><a href="#cb170-1106" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-1107"><a href="#cb170-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1108"><a href="#cb170-1108" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(confronto, <span class="at">caption =</span> <span class="st">"Confronto qualitativo tra i modelli"</span>)</span>
<span id="cb170-1109"><a href="#cb170-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1110"><a href="#cb170-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1111"><a href="#cb170-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussione e selezione del modello migliore</span></span>
<span id="cb170-1112"><a href="#cb170-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1113"><a href="#cb170-1113" aria-hidden="true" tabindex="-1"></a>La scelta del modello "migliore" non è univoca e dipende dall'obiettivo dell'analisi.</span>
<span id="cb170-1114"><a href="#cb170-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1115"><a href="#cb170-1115" aria-hidden="true" tabindex="-1"></a>**Per la previsione univariata a breve termine**, il modello ARIMA (o SARIMA) è spesso la scelta più efficiente: è parsimonioso, cattura la stagionalità, e non richiede la specificazione di relazioni tra variabili. Il suo limite è che ignora completamente l'informazione contenuta in altre variabili potenzialmente rilevanti.</span>
<span id="cb170-1116"><a href="#cb170-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1117"><a href="#cb170-1117" aria-hidden="true" tabindex="-1"></a>**Per comprendere le interazioni dinamiche** tra variabili macroeconomiche (come produzione, inflazione e disoccupazione), il VAR è lo strumento naturale. La Granger-causalità, le IRF e la FEVD forniscono un quadro completo delle interdipendenze. Tuttavia, il VAR richiede serie stazionarie e non cattura relazioni di equilibrio di lungo periodo.</span>
<span id="cb170-1118"><a href="#cb170-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1119"><a href="#cb170-1119" aria-hidden="true" tabindex="-1"></a>**Il Transfer Function Model** è appropriato quando la teoria economica suggerisce una relazione unidirezionale chiara tra input e output (es. la politica monetaria influenza la disoccupazione con un ritardo). Il suo vantaggio è la parsimonia rispetto al VAR e la possibilità di modellare esplicitamente la struttura dei ritardi.</span>
<span id="cb170-1120"><a href="#cb170-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1121"><a href="#cb170-1121" aria-hidden="true" tabindex="-1"></a>**Il VECM è il modello più completo** quando le serie sono $I(1)$ e cointegrate: incorpora sia le dinamiche di breve periodo (attraverso i termini in differenze, come il VAR) sia le relazioni di equilibrio di lungo periodo (attraverso il termine di correzione dell'errore). Il VECM è quindi preferibile al VAR in differenze, poiché quest'ultimo ignorerebbe le relazioni di lungo periodo, perdendo informazione rilevante contenuta nei livelli delle serie.</span>
<span id="cb170-1122"><a href="#cb170-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1123"><a href="#cb170-1123" aria-hidden="true" tabindex="-1"></a>**In sintesi**: la scelta dipende dall'obiettivo specifico dell'analisi, dalla natura dei dati (stazionari o integrati, cointegrati o meno), e dal compromesso tra complessità del modello e interpretabilità dei risultati. Per serie macroeconomiche $I(1)$ con relazioni di equilibrio — come quelle analizzate in questo progetto — il VECM rappresenta generalmente la scelta metodologicamente più appropriata.</span>
<span id="cb170-1124"><a href="#cb170-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1125"><a href="#cb170-1125" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendice: Pacchetti R utilizzati</span></span>
<span id="cb170-1126"><a href="#cb170-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1129"><a href="#cb170-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1130"><a href="#cb170-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: session-info</span></span>
<span id="cb170-1131"><a href="#cb170-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb170-1132"><a href="#cb170-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copia negli appunti" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>